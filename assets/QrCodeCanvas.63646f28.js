var v=Object.defineProperty,m=Object.defineProperties;var f=Object.getOwnPropertyDescriptors;var n=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var o=(e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))g.call(t,r)&&o(e,r,t[r]);if(n)for(var r of n(t))w.call(t,r)&&o(e,r,t[r]);return e},c=(e,t)=>m(e,f(t));import{n as _,p as b,x as j,b as x,v as C,A as l}from"./index.86f8bf01.js";import{a as y}from"./Printer.7af3c02f.js";import k from"./NativeTextCanvas.34de4220.js";import"./vendor.b1428349.js";import"./devterm.eed8f68c.js";import"./buffer.89012e65.js";import"./View.4d885d0c.js";import"./TextButton.7b2eea6d.js";import"./TextField.534f8abb.js";import"./Dialog.94b51842.js";import"./FileSelect.b2803f04.js";import"./CheckBox.e7565528.js";var I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("preview-native-text-canvas",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):r("canvas",{ref:"canvas"})],1)},T=[];const $={components:{PreviewNativeTextCanvas:k},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return y()}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$el.height=this.img.naturalHeight,t()},this.img.src=e})},getColor(e=1){return`rgb(${this.colors.printer.preview.foreground.join(" ")} / ${e*100}%)`},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(async()=>{var t,r;try{const a=((t=this.value.options)==null?void 0:t.width)||((r=this.value.imageOptions)==null?void 0:r.width),i=b(await j(this.value.text||"empty",c(h({},this.value.options||{}),{width:a})),this.value.imageOptions);x(i,{background:this.colors.printer.preview.background,foreground:this.colors.printer.preview.foreground},.6+.4*(this.options.density/C)),e.canvas.width=this.width,e.canvas.height=i.height,e.fillStyle=`rgb(${this.colors.printer.preview.background.join(" ")})`,e.fillRect(0,0,e.canvas.width,e.canvas.height);const p=this.width,u=parseInt(this.options.margin*p);let s=0;switch(this.options.align){case l.RIGHT:s+=this.width-i.width;break;case l.CENTER:s+=(this.width-i.width)/2;break;default:s+=u;break}e.drawImage(i,s,0)}catch(a){this.error=a}this.$emit("ready")})})}}},d={};var N=_($,I,T,!1,O,"66050427",null,null);function O(e){for(let t in d)this[t]=d[t]}var z=function(){return N.exports}();export{z as default};
