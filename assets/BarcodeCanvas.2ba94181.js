var d=Object.defineProperty;var i=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;var s=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n=(e,t)=>{for(var r in t||(t={}))v.call(t,r)&&s(e,r,t[r]);if(i)for(var r of i(t))p.call(t,r)&&s(e,r,t[r]);return e};import{n as u,w as m,p as g,A as o,b as f,v as w}from"./index.156dde5c.js";import{g as _}from"./Printer.a0b9c3de.js";import b from"./NativeTextCanvas.896e0b3e.js";import"./vendor.b1428349.js";import"./devterm.eed8f68c.js";import"./buffer.89012e65.js";import"./View.87190f14.js";import"./TextButton.78f0b397.js";import"./TextField.47a8e1a7.js";import"./Dialog.b6ddbac9.js";import"./FileSelect.da30ab11.js";import"./CheckBox.a0d5102b.js";var j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("preview-native-text-canvas",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):r("canvas",{ref:"canvas"})],1)},x=[];const y={components:{PreviewNativeTextCanvas:b},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return _()}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$refs.canvas.height=this.img.naturalHeight,t()},this.img.src=e})},getColor(e=1){return`rgb(${this.colors.printer.preview.foreground.join(" ")} / ${e*100}%)`},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(async()=>{try{const t=await m(this.value.text||"empty",this.value.options||{}),r=g(t,n({},this.value.imageOptions));e.canvas.width=this.width,e.canvas.height=r.height,e.fillStyle=`rgb(${this.colors.printer.preview.background.join(" ")})`,e.fillRect(0,0,e.canvas.width,e.canvas.height);const l=this.width,h=parseInt(this.options.margin*l);let a=0;switch(this.options.align){case o.RIGHT:a+=this.width-r.width;break;case o.CENTER:a+=(this.width-r.width)/2;break;default:a+=h;break}e.drawImage(r,a,0)}catch(t){this.error=t}f(e.canvas,{background:this.colors.printer.preview.background,foreground:this.colors.printer.preview.foreground},.6+.4*(this.options.density/w))})})}}},c={};var C=u(y,j,x,!1,k,"13fb0104",null,null);function k(e){for(let t in c)this[t]=c[t]}var G=function(){return C.exports}();export{G as default};
