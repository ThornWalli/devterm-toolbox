import{n as h,y as l,p as u,A as n,b as v,v as d}from"./index.49e5c250.js";import g from"./NativeTextCanvas.da360b95.js";import"./vendor.b1428349.js";import"./devterm.eed8f68c.js";import"./buffer.89012e65.js";var m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("preview-native-text-canvas",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):r("canvas",{ref:"canvas"})],1)},p=[];const f={components:{PreviewNativeTextCanvas:g},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return{file:null}}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null,img:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{getColor(e=1){return`rgb(${this.colors.printer.preview.foreground.join(" ")} / ${e*100}%)`},changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$el.height=this.img.naturalHeight,t()},this.img.src=e})},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(()=>{try{const t=l(this.img.naturalWidth,this.img.naturalHeight);t.getContext("2d").drawImage(this.img,0,0);const a=u(t,this.value.imageOptions);e.canvas.width=this.width,e.canvas.height=a.height,e.fillStyle=`rgb(${this.colors.printer.preview.background.join(" ")})`,e.fillRect(0,0,e.canvas.width,e.canvas.height);const o=this.width,c=parseInt(this.options.margin*o);let i=0;switch(this.options.align){case n.RIGHT:i+=this.width-a.width;break;case n.CENTER:i+=(this.width-a.width)/2;break;default:i+=c;break}e.drawImage(a,i,0),v(e.canvas,{background:this.colors.printer.preview.background,foreground:this.colors.printer.preview.foreground},.6+.4*(this.options.density/d))}catch(t){this.error=t}})})}}},s={};var _=h(f,m,p,!1,w,"485ffe41",null,null);function w(e){for(let t in s)this[t]=s[t]}var I=function(){return _.exports}();export{I as default};
