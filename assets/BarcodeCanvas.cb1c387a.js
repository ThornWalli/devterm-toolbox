import{d as o,n as c,p as h,m as l,b as a}from"./index.d9e5b60e.js";import{a as d}from"./Printer.406cba78.js";import u from"./NativeText.0f6c1251.js";import"./vendor.b1428349.js";import"./devterm.9c60640a.js";import"./buffer.89012e65.js";import"./View.376899ee.js";import"./TextButton.350da12d.js";import"./DropDown.cb7d7234.js";import"./Dialog.d6ff428b.js";var v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("preview-native-text",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):r("canvas",{ref:"canvas"})],1)},m=[];const p={components:{PreviewNativeText:u},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return d()}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$refs.canvas.height=this.img.naturalHeight,t()},this.img.src=e})},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(async()=>{try{let t=await f(this.value);t=h(t,{background:this.colors.printer.preview.background,foreground:this.colors.printer.preview.foreground},.6+.4*(this.options.density/l)),e.canvas.width=this.width,e.canvas.height=t.height,e.fillStyle=`rgb(${this.colors.printer.preview.background.join(" ")})`,e.fillRect(0,0,e.canvas.width,e.canvas.height);const r=this.width,n=parseInt(this.options.margin*r);let i=0;switch(this.options.align){case a.RIGHT:i+=this.width-t.width;break;case a.CENTER:i+=(this.width-t.width)/2;break;default:i+=n;break}e.drawImage(t,i,0)}catch(t){this.error=t}this.$emit("ready")})})}}},f=async e=>(await o.barcode.beforePrinterCommand({value:e},!1)).value,s={};var g=c(p,v,m,!1,w,"5c7aec13",null,null);function w(e){for(let t in s)this[t]=s[t]}var N=function(){return g.exports}();export{N as default,f as render};
