var Re=Object.defineProperty;var Mt=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var jt=(r,n,i)=>n in r?Re(r,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[n]=i,q=(r,n)=>{for(var i in n||(n={}))Ue.call(n,i)&&jt(r,i,n[i]);if(Mt)for(var i of Mt(n))ke.call(n,i)&&jt(r,i,n[i]);return r};import{V as $}from"./vendor.b1428349.js";import{F as Y,A as _t,s as Pe,g as Oe,a as Nt,I as Vt,p as Le,b as De,M as Me,c as je,d as Ne,E as Ve}from"./devterm.94c2d908.js";const We=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const f of u)if(f.type==="childList")for(const d of f.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function i(u){const f={};return u.integrity&&(f.integrity=u.integrity),u.referrerpolicy&&(f.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?f.credentials="include":u.crossorigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function c(u){if(u.ep)return;u.ep=!0;const f=i(u);fetch(u.href,f)}};We();const He="modulepreload",Wt={},ze="/",L=function(n,i){return!i||i.length===0?n():Promise.all(i.map(c=>{if(c=`${ze}${c}`,c in Wt)return;Wt[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":He,u||(d.as="script",d.crossOrigin=""),d.href=c,document.head.appendChild(d),u)return new Promise((l,y)=>{d.addEventListener("load",l),d.addEventListener("error",y)})})).then(()=>n())};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wt=function(r,n){return wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,c){i.__proto__=c}||function(i,c){for(var u in c)c.hasOwnProperty(u)&&(i[u]=c[u])},wt(r,n)};function P(r,n){wt(r,n);function i(){this.constructor=r}r.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}function rt(r){return typeof r=="function"}var Ht=!1,T={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){if(r){var n=new Error;""+n.stack}Ht=r},get useDeprecatedSynchronousErrorHandling(){return Ht}};function K(r){setTimeout(function(){throw r},0)}var nt={closed:!0,next:function(r){},error:function(r){if(T.useDeprecatedSynchronousErrorHandling)throw r;K(r)},complete:function(){}},zt=function(){return Array.isArray||function(r){return r&&typeof r.length=="number"}}();function Ge(r){return r!==null&&typeof r=="object"}var qe=function(){function r(n){return Error.call(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(i,c){return c+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n,this}return r.prototype=Object.create(Error.prototype),r}(),it=qe,V=function(){function r(n){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,n&&(this._ctorUnsubscribe=!0,this._unsubscribe=n)}return r.prototype.unsubscribe=function(){var n;if(!this.closed){var i=this,c=i._parentOrParents,u=i._ctorUnsubscribe,f=i._unsubscribe,d=i._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,c instanceof r)c.remove(this);else if(c!==null)for(var l=0;l<c.length;++l){var y=c[l];y.remove(this)}if(rt(f)){u&&(this._unsubscribe=void 0);try{f.call(this)}catch(b){n=b instanceof it?Gt(b.errors):[b]}}if(zt(d))for(var l=-1,m=d.length;++l<m;){var g=d[l];if(Ge(g))try{g.unsubscribe()}catch(E){n=n||[],E instanceof it?n=n.concat(Gt(E.errors)):n.push(E)}}if(n)throw new it(n)}},r.prototype.add=function(n){var i=n;if(!n)return r.EMPTY;switch(typeof n){case"function":i=new r(n);case"object":if(i===this||i.closed||typeof i.unsubscribe!="function")return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof r)){var c=i;i=new r,i._subscriptions=[c]}break;default:throw new Error("unrecognized teardown "+n+" added to Subscription.")}var u=i._parentOrParents;if(u===null)i._parentOrParents=this;else if(u instanceof r){if(u===this)return i;i._parentOrParents=[u,this]}else if(u.indexOf(this)===-1)u.push(this);else return i;var f=this._subscriptions;return f===null?this._subscriptions=[i]:f.push(i),i},r.prototype.remove=function(n){var i=this._subscriptions;if(i){var c=i.indexOf(n);c!==-1&&i.splice(c,1)}},r.EMPTY=function(n){return n.closed=!0,n}(new r),r}();function Gt(r){return r.reduce(function(n,i){return n.concat(i instanceof it?i.errors:i)},[])}var ot=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),j=function(r){P(n,r);function n(i,c,u){var f=r.call(this)||this;switch(f.syncErrorValue=null,f.syncErrorThrown=!1,f.syncErrorThrowable=!1,f.isStopped=!1,arguments.length){case 0:f.destination=nt;break;case 1:if(!i){f.destination=nt;break}if(typeof i=="object"){i instanceof n?(f.syncErrorThrowable=i.syncErrorThrowable,f.destination=i,i.add(f)):(f.syncErrorThrowable=!0,f.destination=new qt(f,i));break}default:f.syncErrorThrowable=!0,f.destination=new qt(f,i,c,u);break}return f}return n.prototype[ot]=function(){return this},n.create=function(i,c,u){var f=new n(i,c,u);return f.syncErrorThrowable=!1,f},n.prototype.next=function(i){this.isStopped||this._next(i)},n.prototype.error=function(i){this.isStopped||(this.isStopped=!0,this._error(i))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},n.prototype._next=function(i){this.destination.next(i)},n.prototype._error=function(i){this.destination.error(i),this.unsubscribe()},n.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},n.prototype._unsubscribeAndRecycle=function(){var i=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=i,this},n}(V),qt=function(r){P(n,r);function n(i,c,u,f){var d=r.call(this)||this;d._parentSubscriber=i;var l,y=d;return rt(c)?l=c:c&&(l=c.next,u=c.error,f=c.complete,c!==nt&&(y=Object.create(c),rt(y.unsubscribe)&&d.add(y.unsubscribe.bind(y)),y.unsubscribe=d.unsubscribe.bind(d))),d._context=y,d._next=l,d._error=u,d._complete=f,d}return n.prototype.next=function(i){if(!this.isStopped&&this._next){var c=this._parentSubscriber;!T.useDeprecatedSynchronousErrorHandling||!c.syncErrorThrowable?this.__tryOrUnsub(this._next,i):this.__tryOrSetError(c,this._next,i)&&this.unsubscribe()}},n.prototype.error=function(i){if(!this.isStopped){var c=this._parentSubscriber,u=T.useDeprecatedSynchronousErrorHandling;if(this._error)!u||!c.syncErrorThrowable?(this.__tryOrUnsub(this._error,i),this.unsubscribe()):(this.__tryOrSetError(c,this._error,i),this.unsubscribe());else if(c.syncErrorThrowable)u?(c.syncErrorValue=i,c.syncErrorThrown=!0):K(i),this.unsubscribe();else{if(this.unsubscribe(),u)throw i;K(i)}}},n.prototype.complete=function(){var i=this;if(!this.isStopped){var c=this._parentSubscriber;if(this._complete){var u=function(){return i._complete.call(i._context)};!T.useDeprecatedSynchronousErrorHandling||!c.syncErrorThrowable?(this.__tryOrUnsub(u),this.unsubscribe()):(this.__tryOrSetError(c,u),this.unsubscribe())}else this.unsubscribe()}},n.prototype.__tryOrUnsub=function(i,c){try{i.call(this._context,c)}catch(u){if(this.unsubscribe(),T.useDeprecatedSynchronousErrorHandling)throw u;K(u)}},n.prototype.__tryOrSetError=function(i,c,u){if(!T.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{c.call(this._context,u)}catch(f){return T.useDeprecatedSynchronousErrorHandling?(i.syncErrorValue=f,i.syncErrorThrown=!0,!0):(K(f),!0)}return!1},n.prototype._unsubscribe=function(){var i=this._parentSubscriber;this._context=null,this._parentSubscriber=null,i.unsubscribe()},n}(j);function Ye(r){for(;r;){var n=r,i=n.closed,c=n.destination,u=n.isStopped;if(i||u)return!1;c&&c instanceof j?r=c:r=null}return!0}function Je(r,n,i){if(r){if(r instanceof j)return r;if(r[ot])return r[ot]()}return!r&&!n&&!i?new j(nt):new j(r,n,i)}var Xe=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ze(r){return r}function Qe(r){return r.length===0?Ze:r.length===1?r[0]:function(i){return r.reduce(function(c,u){return u(c)},i)}}var st=function(){function r(n){this._isScalar=!1,n&&(this._subscribe=n)}return r.prototype.lift=function(n){var i=new r;return i.source=this,i.operator=n,i},r.prototype.subscribe=function(n,i,c){var u=this.operator,f=Je(n,i,c);if(u?f.add(u.call(f,this.source)):f.add(this.source||T.useDeprecatedSynchronousErrorHandling&&!f.syncErrorThrowable?this._subscribe(f):this._trySubscribe(f)),T.useDeprecatedSynchronousErrorHandling&&f.syncErrorThrowable&&(f.syncErrorThrowable=!1,f.syncErrorThrown))throw f.syncErrorValue;return f},r.prototype._trySubscribe=function(n){try{return this._subscribe(n)}catch(i){T.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=i),Ye(n)?n.error(i):console.warn(i)}},r.prototype.forEach=function(n,i){var c=this;return i=Yt(i),new i(function(u,f){var d;d=c.subscribe(function(l){try{n(l)}catch(y){f(y),d&&d.unsubscribe()}},f,u)})},r.prototype._subscribe=function(n){var i=this.source;return i&&i.subscribe(n)},r.prototype[Xe]=function(){return this},r.prototype.pipe=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.length===0?this:Qe(n)(this)},r.prototype.toPromise=function(n){var i=this;return n=Yt(n),new n(function(c,u){var f;i.subscribe(function(d){return f=d},function(d){return u(d)},function(){return c(f)})})},r.create=function(n){return new r(n)},r}();function Yt(r){if(r||(r=T.Promise||Promise),!r)throw new Error("no Promise impl found");return r}var Ke=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}(),tt=Ke,tr=function(r){P(n,r);function n(i,c){var u=r.call(this)||this;return u.subject=i,u.subscriber=c,u.closed=!1,u}return n.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var i=this.subject,c=i.observers;if(this.subject=null,!(!c||c.length===0||i.isStopped||i.closed)){var u=c.indexOf(this.subscriber);u!==-1&&c.splice(u,1)}}},n}(V),Jt=function(r){P(n,r);function n(i){var c=r.call(this,i)||this;return c.destination=i,c}return n}(j),Xt=function(r){P(n,r);function n(){var i=r.call(this)||this;return i.observers=[],i.closed=!1,i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return n.prototype[ot]=function(){return new Jt(this)},n.prototype.lift=function(i){var c=new Zt(this,this);return c.operator=i,c},n.prototype.next=function(i){if(this.closed)throw new tt;if(!this.isStopped)for(var c=this.observers,u=c.length,f=c.slice(),d=0;d<u;d++)f[d].next(i)},n.prototype.error=function(i){if(this.closed)throw new tt;this.hasError=!0,this.thrownError=i,this.isStopped=!0;for(var c=this.observers,u=c.length,f=c.slice(),d=0;d<u;d++)f[d].error(i);this.observers.length=0},n.prototype.complete=function(){if(this.closed)throw new tt;this.isStopped=!0;for(var i=this.observers,c=i.length,u=i.slice(),f=0;f<c;f++)u[f].complete();this.observers.length=0},n.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},n.prototype._trySubscribe=function(i){if(this.closed)throw new tt;return r.prototype._trySubscribe.call(this,i)},n.prototype._subscribe=function(i){if(this.closed)throw new tt;return this.hasError?(i.error(this.thrownError),V.EMPTY):this.isStopped?(i.complete(),V.EMPTY):(this.observers.push(i),new tr(this,i))},n.prototype.asObservable=function(){var i=new st;return i.source=this,i},n.create=function(i,c){return new Zt(i,c)},n}(st),Zt=function(r){P(n,r);function n(i,c){var u=r.call(this)||this;return u.destination=i,u.source=c,u}return n.prototype.next=function(i){var c=this.destination;c&&c.next&&c.next(i)},n.prototype.error=function(i){var c=this.destination;c&&c.error&&this.destination.error(i)},n.prototype.complete=function(){var i=this.destination;i&&i.complete&&this.destination.complete()},n.prototype._subscribe=function(i){var c=this.source;return c?this.source.subscribe(i):V.EMPTY},n}(Xt);function Qt(){return function(n){return n.lift(new er(n))}}var er=function(){function r(n){this.connectable=n}return r.prototype.call=function(n,i){var c=this.connectable;c._refCount++;var u=new rr(n,c),f=i.subscribe(u);return u.closed||(u.connection=c.connect()),f},r}(),rr=function(r){P(n,r);function n(i,c){var u=r.call(this,i)||this;return u.connectable=c,u}return n.prototype._unsubscribe=function(){var i=this.connectable;if(!i){this.connection=null;return}this.connectable=null;var c=i._refCount;if(c<=0){this.connection=null;return}if(i._refCount=c-1,c>1){this.connection=null;return}var u=this.connection,f=i._connection;this.connection=null,f&&(!u||f===u)&&f.unsubscribe()},n}(j),nr=function(r){P(n,r);function n(i,c){var u=r.call(this)||this;return u.source=i,u.subjectFactory=c,u._refCount=0,u._isComplete=!1,u}return n.prototype._subscribe=function(i){return this.getSubject().subscribe(i)},n.prototype.getSubject=function(){var i=this._subject;return(!i||i.isStopped)&&(this._subject=this.subjectFactory()),this._subject},n.prototype.connect=function(){var i=this._connection;return i||(this._isComplete=!1,i=this._connection=new V,i.add(this.source.subscribe(new or(this.getSubject(),this))),i.closed&&(this._connection=null,i=V.EMPTY)),i},n.prototype.refCount=function(){return Qt()(this)},n}(st),ir=function(){var r=nr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:r._subscribe},_isComplete:{value:r._isComplete,writable:!0},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}}}(),or=function(r){P(n,r);function n(i,c){var u=r.call(this,i)||this;return u.connectable=c,u}return n.prototype._error=function(i){this._unsubscribe(),r.prototype._error.call(this,i)},n.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),r.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var i=this.connectable;if(i){this.connectable=null;var c=i._connection;i._refCount=0,i._subject=null,i._connection=null,c&&c.unsubscribe()}},n}(Jt);function sr(r,n){return function(c){if(typeof r!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return c.lift(new cr(r,n))}}var cr=function(){function r(n,i){this.project=n,this.thisArg=i}return r.prototype.call=function(n,i){return i.subscribe(new ur(n,this.project,this.thisArg))},r}(),ur=function(r){P(n,r);function n(i,c,u){var f=r.call(this,i)||this;return f.project=c,f.count=0,f.thisArg=u||f,f}return n.prototype._next=function(i){var c;try{c=this.project.call(this.thisArg,i,this.count++)}catch(u){this.destination.error(u);return}this.destination.next(c)},n}(j);function ct(r,n,i,c){return rt(i)&&(c=i,i=void 0),c?ct(r,n,i).pipe(sr(function(u){return zt(u)?c.apply(void 0,u):c(u)})):new st(function(u){function f(d){arguments.length>1?u.next(Array.prototype.slice.call(arguments)):u.next(d)}Kt(r,n,f,u,i)})}function Kt(r,n,i,c,u){var f;if(fr(r)){var d=r;r.addEventListener(n,i,u),f=function(){return d.removeEventListener(n,i,u)}}else if(lr(r)){var l=r;r.on(n,i),f=function(){return l.off(n,i)}}else if(ar(r)){var y=r;r.addListener(n,i),f=function(){return y.removeListener(n,i)}}else if(r&&r.length)for(var m=0,g=r.length;m<g;m++)Kt(r[m],n,i,c,u);else throw new TypeError("Invalid event target");c.add(f)}function ar(r){return r&&typeof r.addListener=="function"&&typeof r.removeListener=="function"}function lr(r){return r&&typeof r.on=="function"&&typeof r.off=="function"}function fr(r){return r&&typeof r.addEventListener=="function"&&typeof r.removeEventListener=="function"}function pr(r,n){return function(c){var u;if(typeof r=="function"?u=r:u=function(){return r},typeof n=="function")return c.lift(new hr(u,n));var f=Object.create(c,ir);return f.source=c,f.subjectFactory=u,f}}var hr=function(){function r(n,i){this.subjectFactory=n,this.selector=i}return r.prototype.call=function(n,i){var c=this.selector,u=this.subjectFactory(),f=c(u).subscribe(n);return f.add(i.subscribe(u)),f},r}();function dr(){return new Xt}function mt(){return function(r){return Qt()(pr(dr)(r))}}ct(window,"resize").pipe(mt());ct(window,"keypress").pipe(mt());const Qn=ct(window,"keyup").pipe(mt()),yr=r=>new Promise(n=>{const i=document.createElement("input");i.type="file",i.accept=(r||[]).join(","),i.click(),i.addEventListener("change",c=>{const u=(c.dataTransfer||c.target).files;i.remove(),n(u)})}),_r=r=>{R()&&(r.on("connect",()=>{window.electron.ipcRenderer.invoke("client","connect",!0)}),r.on("disconnect",()=>{window.electron.ipcRenderer.invoke("client","connect",!1)}))},wr=()=>{window.electron.ipcRenderer.invoke("window","minimize")},mr=()=>{window.electron.ipcRenderer.invoke("window","maximize")},gr=r=>{if(R())window.electron.ipcRenderer.invoke("window","fullscreen",r);else return r?document.body.requestFullscreen():document.exitFullscreen()},br=()=>{window.electron.ipcRenderer.invoke("close")},R=()=>"electron"in window,vr=r=>{if(R())return window.electron.ipcRenderer.invoke("save",r);{const n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(r)),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","scene.json"),i.click()}},Er=async()=>{if(R())return window.electron.ipcRenderer.invoke("load");{const r=await yr("text");return new Promise((n,i)=>{if(r.length){const c=new FileReader;c.addEventListener("load",()=>{try{n(JSON.parse(c.result))}catch(u){i(u)}}),c.readAsText(r[0])}else n()})}},xr=r=>{R()&&window.electron.ipcRendererReceive("dialog",r)},Ir=r=>{R()?window.electron.ipcRendererReceive("window",(n,i)=>{switch(n){case"fullscreen":r(i);break}}):window.addEventListener("fullscreenchange",()=>{r(document.fullscreenEnabled)})},Sr=()=>R()?window.electron.ipcRenderer.invoke("loadConfig"):JSON.parse(window.localStorage.getItem("config")),Br=r=>R()?window.electron.ipcRenderer.invoke("saveConfig",r):window.localStorage.setItem("config",JSON.stringify(r)),Fr=()=>R()?window.electron.ipcRenderer.invoke("getCurrentVersion"):"1.0.0-beta.12";var Cr="/assets/5x7-ISO8859-1.1e468e9f.ttf",Ar="/assets/6x12-ISO8859-1.4c4c24d1.ttf",$r="/assets/7x14-ISO8859-1.b8471bdd.ttf",Tr="/assets/Px437_CompaqThin_8x16.ccffc04f.ttf";const Rr=()=>{const r=[["5x7-ISO8859-1",`url(${Cr})`],["6x12-ISO8859-1",`url(${Ar})`],["7x14-ISO8859-1",`url(${$r})`],["Px437_CompaqThin_8x16",`url(${Tr})`]];return Promise.all(r.map(async n=>{console.log("load font",n[0],n[1]);const i=new FontFace(...n);return await i.load(),document.fonts.add(i),i}))},Kn={[Y.SIZE_5_7]:{fontFamily:"5x7-ISO8859-1",fontSize:7},[Y.SIZE_6_12]:{fontFamily:"6x12-ISO8859-1",fontSize:12},[Y.SIZE_7_14]:{fontFamily:"7x14-ISO8859-1",fontSize:14},[Y.SIZE_8_16_THIN_1]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16},[Y.SIZE_8_16_THIN_2]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16}};var ut,Ur=new Uint8Array(16);function kr(){if(!ut&&(ut=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ut))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ut(Ur)}var Pr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Or(r){return typeof r=="string"&&Pr.test(r)}var B=[];for(var gt=0;gt<256;++gt)B.push((gt+256).toString(16).substr(1));function Lr(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=(B[r[n+0]]+B[r[n+1]]+B[r[n+2]]+B[r[n+3]]+"-"+B[r[n+4]]+B[r[n+5]]+"-"+B[r[n+6]]+B[r[n+7]]+"-"+B[r[n+8]]+B[r[n+9]]+"-"+B[r[n+10]]+B[r[n+11]]+B[r[n+12]]+B[r[n+13]]+B[r[n+14]]+B[r[n+15]]).toLowerCase();if(!Or(i))throw TypeError("Stringified UUID is invalid");return i}function Dr(r,n,i){r=r||{};var c=r.random||(r.rng||kr)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,n){i=i||0;for(var u=0;u<16;++u)n[i+u]=c[u];return n}return Lr(c)}class Mr{constructor(n){const{type:i,value:c}=n||{};this.id=Dr(),this.type=i,this.value=c}toJSON(){return{id:this.id,type:this.type,value:this.value}}}var jr=[{type:"reset"},{type:"setAlign",value:_t.CENTER},{type:"qrCode",value:{text:"Devterm",options:{errorCorrectionLevel:"M",margin:0,scale:4,small:!1},imageOptions:{rotate:!1,flipX:!1,flipY:!1,width:null}}},{type:"setAlign",value:_t.LEFT},{type:"text",value:"Left"}],Nr=function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("div",{staticClass:"app-menu"},[i("ul",[r._t("default")],2)])},Vr=[];function W(r,n,i,c,u,f,d,l){var y=typeof r=="function"?r.options:r;n&&(y.render=n,y.staticRenderFns=i,y._compiled=!0),c&&(y.functional=!0),f&&(y._scopeId="data-v-"+f);var m;if(d?(m=function(E){E=E||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!E&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(E=__VUE_SSR_CONTEXT__),u&&u.call(this,E),E&&E._registeredComponents&&E._registeredComponents.add(d)},y._ssrRegister=m):u&&(m=l?function(){u.call(this,(y.functional?this.parent:this).$root.$options.shadowRoot)}:u),m)if(y.functional){y._injectStyles=m;var g=y.render;y.render=function(F,D){return m.call(D),g(F,D)}}else{var b=y.beforeCreate;y.beforeCreate=b?[].concat(b,m):[m]}return{exports:r,options:y}}const Wr={},te={};var Hr=W(Wr,Nr,Vr,!1,zr,"447d30c4",null,null);function zr(r){for(let n in te)this[n]=te[n]}var Gr=function(){return Hr.exports}(),qr=function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("button",r._g({staticClass:"base-generic-button"},r.$listeners),[r._t("default",function(){return[r._v(r._s(r.text))]})],2)},Yr=[];const Jr={props:{text:{type:String,default:"Button Text"}}},ee={};var Xr=W(Jr,qr,Yr,!1,Zr,"eeccf710",null,null);function Zr(r){for(let n in ee)this[n]=ee[n]}var Qr=function(){return Xr.exports}(),Kr=function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("li",{staticClass:"app-menu-item",class:{selected:r.selected}},[i("base-generic-button",r._g(r._b({},"base-generic-button",r.$attrs,!1),r.$listeners),[r._t("default",function(){return[r._v(r._s(r.text))]})],2)],1)},tn=[];const en={components:{BaseGenericButton:Qr},inheritAttrs:!1,props:{selected:{type:Boolean,default:!1},text:{type:String,default:null}}},re={};var rn=W(en,Kr,tn,!1,nn,"3f1b0188",null,null);function nn(r){for(let n in re)this[n]=re[n]}var U=function(){return rn.exports}(),on=function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("li",r._g(r._b({staticClass:"app-menu-text"},"li",r.$attrs,!1),r.$listeners),[r._t("default",function(){return[i("span",{domProps:{innerHTML:r._s(r.text)}})]})],2)},sn=[];const cn={inheritAttrs:!1,props:{text:{type:String,default:null}}},ne={};var un=W(cn,on,sn,!1,an,"11d97818",null,null);function an(r){for(let n in ne)this[n]=ne[n]}var at=function(){return un.exports}(),ln=function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("li",{staticClass:"app-menu-spacer"},[r._t("default")],2)},fn=[];const pn={},ie={};var hn=W(pn,ln,fn,!1,dn,"d155e842",null,null);function dn(r){for(let n in ie)this[n]=ie[n]}var bt=function(){return hn.exports}(),yn=function(){var r=this,n=r.$createElement;return r._self._c,r._m(0)},_n=[function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("li",{staticClass:"app-menu-divider"},[i("i")])}];const wn={},oe={};var mn=W(wn,yn,_n,!1,gn,"12222a62",null,null);function gn(r){for(let n in oe)this[n]=oe[n]}var J=function(){return mn.exports}(),bn=function(){var r=this,n=r.$createElement,i=r._self._c||n;return i("div",{staticClass:"app",class:{ready:r.ready},style:r.style},[i("app-menu",{staticClass:"header"},r._l(r.headerItems,function(c,u){return i(c.component,r._g(r._b({key:u,tag:"component"},"component",c.props,!1),c.on))}),1),i("div",{staticClass:"app-content"},[!r.$client.connected&&r.ready?i("view-start",{on:{apply:r.onApplyViewStart}}):r.currentView===r.VIEWS.PRINTER?i("view-printer",{attrs:{colors:r.colors},model:{value:r.printerTemplate,callback:function(c){r.printerTemplate=c},expression:"printerTemplate"}}):r.currentView===r.VIEWS.INFO?i("view-info"):r._e()],1),i("app-menu",{staticClass:"footer"},r._l(r.footerItems,function(c,u){return i(c.component,r._g(r._b({key:u,tag:"component"},"component",c.props,!1),c.on))}),1),r._l(r.$errorList.errors,function(c,u){return i("dialog-error",r._b({key:u,attrs:{"init-open":""}},"dialog-error",c,!1))}),r._l(r.$dialog.prompts,function(c,u){return i("dialog-prompt",r._b({key:u,attrs:{"init-open":""}},"dialog-prompt",c,!1))}),r.ready?i("dialog-remote",{ref:"dialogRemote"}):r._e(),r.ready?i("dialog-server",{ref:"dialogServer"}):r._e(),r.ready?i("dialog-options",{ref:"dialogOptions"}):r._e()],2)},vn=[];const H={NONE:null,INFO:"info",START:"start",PRINTER:"priner"},En={amber:{primary:[255,204,0],secondary:[0,0,0],printer:{preview:{background:[255,204,0],foreground:[0,0,0]}}},green:{primary:[51,255,0],secondary:[0,0,0],printer:{preview:{background:[51,255,0],foreground:[0,0,0]}}},whiteBlack:{primary:[255,255,255],secondary:[0,0,0],printer:{preview:{background:[255,255,255],foreground:[0,0,0]}}},blackWhite:{primary:[0,0,0],secondary:[255,255,255],printer:{preview:{background:[0,0,0],foreground:[255,255,255]}}}};function xn(){return jr.map(r=>new Mr(r))}const In={components:{ViewPrinter:()=>L(()=>import("./Printer.175fdc17.js").then(function(r){return r.P}),["assets/Printer.175fdc17.js","assets/Printer.711b20ad.css","assets/View.1909b678.js","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/TextField.b34cf03f.js","assets/TextField.a9ee00f3.css","assets/devterm.94c2d908.js","assets/Dialog.d7f42392.js","assets/Dialog.68b2fee9.css","assets/CheckBox.a7041ca4.js","assets/CheckBox.82b15c7e.css","assets/FileSelect.6ed22238.js","assets/FileSelect.a3ea1f4f.css"]),ViewStart:()=>L(()=>import("./Start.fd7ecba8.js"),["assets/Start.fd7ecba8.js","assets/Start.7de09691.css","assets/View.1909b678.js","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"]),ViewInfo:()=>L(()=>import("./Info.e99efd5d.js"),["assets/Info.e99efd5d.js","assets/Info.323bbd9f.css","assets/View.1909b678.js","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"]),AppMenu:Gr,AppMenuItem:U,AppMenuText:at,AppMenuSpacer:bt,AppMenuDivider:J,DialogError:()=>L(()=>import("./Error.f0bb84bd.js"),["assets/Error.f0bb84bd.js","assets/Error.d6470d93.css","assets/Dialog.d7f42392.js","assets/Dialog.68b2fee9.css","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"]),DialogRemote:()=>L(()=>import("./Remote.108ad5b8.js"),["assets/Remote.108ad5b8.js","assets/Remote.cb7e31b7.css","assets/TextField.b34cf03f.js","assets/TextField.a9ee00f3.css","assets/Dialog.d7f42392.js","assets/Dialog.68b2fee9.css","assets/CheckBox.a7041ca4.js","assets/CheckBox.82b15c7e.css","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"]),DialogServer:()=>L(()=>import("./Server.85bd8982.js"),["assets/Server.85bd8982.js","assets/Server.096116d4.css","assets/TextField.b34cf03f.js","assets/TextField.a9ee00f3.css","assets/Dialog.d7f42392.js","assets/Dialog.68b2fee9.css","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/FileSelect.6ed22238.js","assets/FileSelect.a3ea1f4f.css","assets/CheckBox.a7041ca4.js","assets/CheckBox.82b15c7e.css","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"]),DialogOptions:()=>L(()=>import("./Options.dadb67fa.js"),["assets/Options.dadb67fa.js","assets/Options.cdc76cd0.css","assets/TextField.b34cf03f.js","assets/TextField.a9ee00f3.css","assets/Dialog.d7f42392.js","assets/Dialog.68b2fee9.css","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"]),DialogPrompt:()=>L(()=>import("./Prompt.9ea114b1.js"),["assets/Prompt.9ea114b1.js","assets/Prompt.dea47229.css","assets/Dialog.d7f42392.js","assets/Dialog.68b2fee9.css","assets/TextButton.90078f5f.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.94c2d908.js"])},data(){return{VIEWS:H,currentView:H.PRINTER,ready:!1,fullscreen:!1,printerTemplate:xn()}},computed:{headerItems(){const r=[{component:U,on:{click:this.onClickNew},props:{text:"New"}},{component:J},{component:U,on:{click:this.onClickSave},props:{text:"Save"}},{component:U,title:"Load",on:{click:this.onClickLoad},props:{text:"Load"}},{component:J}];return[...this.$client.connected&&[{component:U,on:{click:()=>this.currentView=H.INFO},props:{selected:this.currentView===H.INFO,text:"Info"}},{component:U,on:{click:()=>this.currentView=H.PRINTER},props:{selected:this.currentView===H.PRINTER,text:"Printer"}}]||[],{component:bt},...this.$client.connected&&this.currentView===H.PRINTER&&r||[],{component:U,on:{click:this.onClickOptions},props:{text:"Options"}},R()&&[{component:J},{component:U,on:{click:this.onClickClose},props:{text:"Close"}}]].flat().filter(Boolean)},footerItems(){return[R()&&[{component:U,on:{click:this.onClickMinimizeWindow},props:{text:"Minimize"}},{component:U,on:{click:this.onClickMaximizeWindow},props:{text:"Maximize"}}].flat(),{component:U,on:{click:this.onClickFullscreen},props:{selected:this.fullscreen,text:"Fullscreen"}},{component:bt},this.hasServer&&[{component:at,on:{click:this.showServerDialog},props:{class:{connection:!0,connected:this.$server.options.active},text:`${this.$server.options.active?`Server (*:${this.$server.options.port}${this.$server.options.secure?"/SSL":""})`:"Server Offline"}`}},{component:J}],{component:at,on:{click:this.showRemoteDialog},props:{class:{connection:!0,connected:this.clientConnected},text:`${this.clientConnected?`Online (${this.$client.host}:${this.$client.port}${this.$client.secure?"/SSL":""})`:"Offline"}`}},{component:J},{component:at,props:{class:"info-version",text:this.version}}].flat().filter(Boolean)},hasServer(){return!this.$server.disabled},version(){return this.$config.version},colors(){return En[this.$config.data.theme]},clientConnected(){return this.$client.connected},style(){return q({"--color-primary":`rgb(${this.colors.primary.join(",")})`,"--color-secondary":`rgb(${this.colors.secondary.join(",")})`},Object.fromEntries(Array(10).fill("").map((r,n)=>[`--color-primary-${(n+1)*10}`,`rgb(${this.colors.primary.join(" ")} / ${(n+1)*10}%)`])))}},async mounted(){await Rr(),await this.$config.init(),await this.$server.init(),this.hasServer&&await this.$server.refresh(),await this.$config.load();const r=this.$config.get("profiles").find(({name:n})=>n===this.$config.get("profile"));if(r){const{port:n,host:i,ssl:c,secure:u}=r;if(this.$config.get("startType")&&n)try{this.$server&&this.$config.get("startType")==="local"&&!this.$server.options.active&&await this.$server.start(n,c),i&&await this.$client.connect(n,i,u)}catch{}}this.ready=!0,this.registerListeners()},methods:{registerListeners(){Ir(r=>{this.fullscreen=r}),xr((r,n)=>{switch(r){case"open":switch(n){case"options":this.showOptionsDialog();break;case"remote":this.showRemoteDialog();break;case"server":this.showServerDialog();break}break}})},onClickMinimizeWindow(){return wr()},onClickMaximizeWindow(){return mr()},onClickFullscreen(){return gr(!this.fullscreen)},onClickClose(){return br()},onClickNew(){this.printerTemplate=[]},onClickSave(){return vr(this.printerTemplate)},async onClickLoad(){try{const r=await Er();r&&(this.printerTemplate=r)}catch(r){this.$errorList.add(r)}},onClickOptions(){this.showOptionsDialog()},async onApplyViewStart({type:r}){this.$config.set("startType",r);let n={};switch(r){case"local":n=await this.showServerDialog();break;case"remote":n=await this.showRemoteDialog();break}const{profile:i}=n||{};i&&(this.$config.set("profile",i),await this.$config.save())},showServerDialog(){return this.$refs.dialogServer.show()},showRemoteDialog(){return this.$refs.dialogRemote.show()},showOptionsDialog(){return this.$refs.dialogOptions.show()}}},se={};var Sn=W(In,bn,vn,!1,Bn,"c36f0386",null,null);function Bn(r){for(let n in se)this[n]=se[n]}var ce=function(){return Sn.exports}();class Fn{constructor(){this.errors=[]}add(n,i){typeof n=="object"&&(console.error(n),n.type&&(i=n.type),n=n.message);const c={title:i,message:n},u=()=>{this.errors.slice(this.errors.indexOf(c),1)};c.callback=u,this.errors.push(c)}}const ue=$.observable(new Fn);Object.defineProperty($.prototype,"$errorList",{get(){return ue}});const ti=512,lt=()=>({theme:"amber",startType:null,ssl:{key:null,cert:null,pfx:null,passphrase:null},profiles:[]}),Cn=()=>({name:null,port:3e3,host:null,secure:!1,ssl:{key:null,cert:null,pfx:null,passphrase:null}}),ei="localhost",An="Profile Default";class $n{constructor(){this.data=lt(),this.version=null}async init(){this.version=await Fr()}toJSON(){return Object.assign({},this.data,{version:this.version})}get(n){return this.data[n]}set(n,i){typeof n=="string"?this.data[n]=i:typeof n=="object"&&Object.entries(n).forEach(([c,u])=>this.set(c,u))}save(){return Br(this.toJSON())}reset(){return this.data=lt(),this.save()}async load(){let n;try{n=await Sr()}catch{n=lt()}return console.log(n),this.data=Object.assign(lt(),n)}saveProfile(n){n.name=n.name||An;const i=this.get("profiles");let c=this.get("profiles").find(({name:u})=>u===n.name);return c?(console.log("update profile",c.name,c),i[i.indexOf(c)]=q(q({},c),n)):(console.log("create profile",n.name,n),c=q(q({},Cn()),n),i.push(c)),this.set("profiles",i),this.save()}deleteProfile(n){const i=this.get("profiles"),c=this.get("profiles").find(({name:u})=>u===n);return i.slice(i.indexOf(c),1),this.set("profiles",i),this.save()}}const Tn=$.observable(new $n);Object.defineProperty($.prototype,"$config",{get(){return Tn}});Object.defineProperty($.prototype,"$server",{get(){return{init(){return Promise.resolve()},disabled:!0}}});var vt={},ft={};ft.byteLength=kn;ft.toByteArray=On;ft.fromByteArray=Mn;var O=[],A=[],Rn=typeof Uint8Array!="undefined"?Uint8Array:Array,Et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var X=0,Un=Et.length;X<Un;++X)O[X]=Et[X],A[Et.charCodeAt(X)]=X;A["-".charCodeAt(0)]=62;A["_".charCodeAt(0)]=63;function ae(r){var n=r.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=r.indexOf("=");i===-1&&(i=n);var c=i===n?0:4-i%4;return[i,c]}function kn(r){var n=ae(r),i=n[0],c=n[1];return(i+c)*3/4-c}function Pn(r,n,i){return(n+i)*3/4-i}function On(r){var n,i=ae(r),c=i[0],u=i[1],f=new Rn(Pn(r,c,u)),d=0,l=u>0?c-4:c,y;for(y=0;y<l;y+=4)n=A[r.charCodeAt(y)]<<18|A[r.charCodeAt(y+1)]<<12|A[r.charCodeAt(y+2)]<<6|A[r.charCodeAt(y+3)],f[d++]=n>>16&255,f[d++]=n>>8&255,f[d++]=n&255;return u===2&&(n=A[r.charCodeAt(y)]<<2|A[r.charCodeAt(y+1)]>>4,f[d++]=n&255),u===1&&(n=A[r.charCodeAt(y)]<<10|A[r.charCodeAt(y+1)]<<4|A[r.charCodeAt(y+2)]>>2,f[d++]=n>>8&255,f[d++]=n&255),f}function Ln(r){return O[r>>18&63]+O[r>>12&63]+O[r>>6&63]+O[r&63]}function Dn(r,n,i){for(var c,u=[],f=n;f<i;f+=3)c=(r[f]<<16&16711680)+(r[f+1]<<8&65280)+(r[f+2]&255),u.push(Ln(c));return u.join("")}function Mn(r){for(var n,i=r.length,c=i%3,u=[],f=16383,d=0,l=i-c;d<l;d+=f)u.push(Dn(r,d,d+f>l?l:d+f));return c===1?(n=r[i-1],u.push(O[n>>2]+O[n<<4&63]+"==")):c===2&&(n=(r[i-2]<<8)+r[i-1],u.push(O[n>>10]+O[n>>4&63]+O[n<<2&63]+"=")),u.join("")}var xt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */xt.read=function(r,n,i,c,u){var f,d,l=u*8-c-1,y=(1<<l)-1,m=y>>1,g=-7,b=i?u-1:0,E=i?-1:1,F=r[n+b];for(b+=E,f=F&(1<<-g)-1,F>>=-g,g+=l;g>0;f=f*256+r[n+b],b+=E,g-=8);for(d=f&(1<<-g)-1,f>>=-g,g+=c;g>0;d=d*256+r[n+b],b+=E,g-=8);if(f===0)f=1-m;else{if(f===y)return d?NaN:(F?-1:1)*(1/0);d=d+Math.pow(2,c),f=f-m}return(F?-1:1)*d*Math.pow(2,f-c)};xt.write=function(r,n,i,c,u,f){var d,l,y,m=f*8-u-1,g=(1<<m)-1,b=g>>1,E=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=c?0:f-1,D=c?1:-1,Z=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(l=isNaN(n)?1:0,d=g):(d=Math.floor(Math.log(n)/Math.LN2),n*(y=Math.pow(2,-d))<1&&(d--,y*=2),d+b>=1?n+=E/y:n+=E*Math.pow(2,1-b),n*y>=2&&(d++,y/=2),d+b>=g?(l=0,d=g):d+b>=1?(l=(n*y-1)*Math.pow(2,u),d=d+b):(l=n*Math.pow(2,b-1)*Math.pow(2,u),d=0));u>=8;r[i+F]=l&255,F+=D,l/=256,u-=8);for(d=d<<u|l,m+=u;m>0;r[i+F]=d&255,F+=D,d/=256,m-=8);r[i+F-D]|=Z*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const n=ft,i=xt,c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=l,r.SlowBuffer=pe,r.INSPECT_MAX_BYTES=50;const u=2147483647;r.kMaxLength=u,l.TYPED_ARRAY_SUPPORT=f(),!l.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const o=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(o,t),o.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(!!l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(!!l.isBuffer(this))return this.byteOffset}});function d(o){if(o>u)throw new RangeError('The value "'+o+'" is invalid for option "size"');const t=new Uint8Array(o);return Object.setPrototypeOf(t,l.prototype),t}function l(o,t,e){if(typeof o=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(o)}return y(o,t,e)}l.poolSize=8192;function y(o,t,e){if(typeof o=="string")return E(o,t);if(ArrayBuffer.isView(o))return D(o);if(o==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(k(o,ArrayBuffer)||o&&k(o.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(k(o,SharedArrayBuffer)||o&&k(o.buffer,SharedArrayBuffer)))return Z(o,t,e);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const s=o.valueOf&&o.valueOf();if(s!=null&&s!==o)return l.from(s,t,e);const a=fe(o);if(a)return a;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return l.from(o[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}l.from=function(o,t,e){return y(o,t,e)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function m(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function g(o,t,e){return m(o),o<=0?d(o):t!==void 0?typeof e=="string"?d(o).fill(t,e):d(o).fill(t):d(o)}l.alloc=function(o,t,e){return g(o,t,e)};function b(o){return m(o),d(o<0?0:pt(o)|0)}l.allocUnsafe=function(o){return b(o)},l.allocUnsafeSlow=function(o){return b(o)};function E(o,t){if((typeof t!="string"||t==="")&&(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const e=Bt(o,t)|0;let s=d(e);const a=s.write(o,t);return a!==e&&(s=s.slice(0,a)),s}function F(o){const t=o.length<0?0:pt(o.length)|0,e=d(t);for(let s=0;s<t;s+=1)e[s]=o[s]&255;return e}function D(o){if(k(o,Uint8Array)){const t=new Uint8Array(o);return Z(t.buffer,t.byteOffset,t.byteLength)}return F(o)}function Z(o,t,e){if(t<0||o.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let s;return t===void 0&&e===void 0?s=new Uint8Array(o):e===void 0?s=new Uint8Array(o,t):s=new Uint8Array(o,t,e),Object.setPrototypeOf(s,l.prototype),s}function fe(o){if(l.isBuffer(o)){const t=pt(o.length)|0,e=d(t);return e.length===0||o.copy(e,0,0,t),e}if(o.length!==void 0)return typeof o.length!="number"||yt(o.length)?d(0):F(o);if(o.type==="Buffer"&&Array.isArray(o.data))return F(o.data)}function pt(o){if(o>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return o|0}function pe(o){return+o!=o&&(o=0),l.alloc(+o)}l.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==l.prototype},l.compare=function(t,e){if(k(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),k(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let s=t.length,a=e.length;for(let p=0,h=Math.min(s,a);p<h;++p)if(t[p]!==e[p]){s=t[p],a=e[p];break}return s<a?-1:a<s?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return l.alloc(0);let s;if(e===void 0)for(e=0,s=0;s<t.length;++s)e+=t[s].length;const a=l.allocUnsafe(e);let p=0;for(s=0;s<t.length;++s){let h=t[s];if(k(h,Uint8Array))p+h.length>a.length?(l.isBuffer(h)||(h=l.from(h)),h.copy(a,p)):Uint8Array.prototype.set.call(a,h,p);else if(l.isBuffer(h))h.copy(a,p);else throw new TypeError('"list" argument must be an Array of Buffers');p+=h.length}return a};function Bt(o,t){if(l.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||k(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);const e=o.length,s=arguments.length>2&&arguments[2]===!0;if(!s&&e===0)return 0;let a=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return dt(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return Dt(o).length;default:if(a)return s?-1:dt(o).length;t=(""+t).toLowerCase(),a=!0}}l.byteLength=Bt;function he(o,t,e){let s=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(o||(o="utf8");;)switch(o){case"hex":return xe(this,t,e);case"utf8":case"utf-8":return At(this,t,e);case"ascii":return ve(this,t,e);case"latin1":case"binary":return Ee(this,t,e);case"base64":return ge(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ie(this,t,e);default:if(s)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),s=!0}}l.prototype._isBuffer=!0;function N(o,t,e){const s=o[t];o[t]=o[e],o[e]=s}l.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)N(this,e,e+1);return this},l.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)N(this,e,e+3),N(this,e+1,e+2);return this},l.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)N(this,e,e+7),N(this,e+1,e+6),N(this,e+2,e+5),N(this,e+3,e+4);return this},l.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?At(this,0,t):he.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:l.compare(this,t)===0},l.prototype.inspect=function(){let t="";const e=r.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},c&&(l.prototype[c]=l.prototype.inspect),l.prototype.compare=function(t,e,s,a,p){if(k(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),s===void 0&&(s=t?t.length:0),a===void 0&&(a=0),p===void 0&&(p=this.length),e<0||s>t.length||a<0||p>this.length)throw new RangeError("out of range index");if(a>=p&&e>=s)return 0;if(a>=p)return-1;if(e>=s)return 1;if(e>>>=0,s>>>=0,a>>>=0,p>>>=0,this===t)return 0;let h=p-a,_=s-e;const x=Math.min(h,_),v=this.slice(a,p),I=t.slice(e,s);for(let w=0;w<x;++w)if(v[w]!==I[w]){h=v[w],_=I[w];break}return h<_?-1:_<h?1:0};function Ft(o,t,e,s,a){if(o.length===0)return-1;if(typeof e=="string"?(s=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,yt(e)&&(e=a?0:o.length-1),e<0&&(e=o.length+e),e>=o.length){if(a)return-1;e=o.length-1}else if(e<0)if(a)e=0;else return-1;if(typeof t=="string"&&(t=l.from(t,s)),l.isBuffer(t))return t.length===0?-1:Ct(o,t,e,s,a);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?a?Uint8Array.prototype.indexOf.call(o,t,e):Uint8Array.prototype.lastIndexOf.call(o,t,e):Ct(o,[t],e,s,a);throw new TypeError("val must be string, number or Buffer")}function Ct(o,t,e,s,a){let p=1,h=o.length,_=t.length;if(s!==void 0&&(s=String(s).toLowerCase(),s==="ucs2"||s==="ucs-2"||s==="utf16le"||s==="utf-16le")){if(o.length<2||t.length<2)return-1;p=2,h/=2,_/=2,e/=2}function x(I,w){return p===1?I[w]:I.readUInt16BE(w*p)}let v;if(a){let I=-1;for(v=e;v<h;v++)if(x(o,v)===x(t,I===-1?0:v-I)){if(I===-1&&(I=v),v-I+1===_)return I*p}else I!==-1&&(v-=v-I),I=-1}else for(e+_>h&&(e=h-_),v=e;v>=0;v--){let I=!0;for(let w=0;w<_;w++)if(x(o,v+w)!==x(t,w)){I=!1;break}if(I)return v}return-1}l.prototype.includes=function(t,e,s){return this.indexOf(t,e,s)!==-1},l.prototype.indexOf=function(t,e,s){return Ft(this,t,e,s,!0)},l.prototype.lastIndexOf=function(t,e,s){return Ft(this,t,e,s,!1)};function de(o,t,e,s){e=Number(e)||0;const a=o.length-e;s?(s=Number(s),s>a&&(s=a)):s=a;const p=t.length;s>p/2&&(s=p/2);let h;for(h=0;h<s;++h){const _=parseInt(t.substr(h*2,2),16);if(yt(_))return h;o[e+h]=_}return h}function ye(o,t,e,s){return et(dt(t,o.length-e),o,e,s)}function _e(o,t,e,s){return et(Ce(t),o,e,s)}function we(o,t,e,s){return et(Dt(t),o,e,s)}function me(o,t,e,s){return et(Ae(t,o.length-e),o,e,s)}l.prototype.write=function(t,e,s,a){if(e===void 0)a="utf8",s=this.length,e=0;else if(s===void 0&&typeof e=="string")a=e,s=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(s)?(s=s>>>0,a===void 0&&(a="utf8")):(a=s,s=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const p=this.length-e;if((s===void 0||s>p)&&(s=p),t.length>0&&(s<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let h=!1;for(;;)switch(a){case"hex":return de(this,t,e,s);case"utf8":case"utf-8":return ye(this,t,e,s);case"ascii":case"latin1":case"binary":return _e(this,t,e,s);case"base64":return we(this,t,e,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,t,e,s);default:if(h)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),h=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ge(o,t,e){return t===0&&e===o.length?n.fromByteArray(o):n.fromByteArray(o.slice(t,e))}function At(o,t,e){e=Math.min(o.length,e);const s=[];let a=t;for(;a<e;){const p=o[a];let h=null,_=p>239?4:p>223?3:p>191?2:1;if(a+_<=e){let x,v,I,w;switch(_){case 1:p<128&&(h=p);break;case 2:x=o[a+1],(x&192)==128&&(w=(p&31)<<6|x&63,w>127&&(h=w));break;case 3:x=o[a+1],v=o[a+2],(x&192)==128&&(v&192)==128&&(w=(p&15)<<12|(x&63)<<6|v&63,w>2047&&(w<55296||w>57343)&&(h=w));break;case 4:x=o[a+1],v=o[a+2],I=o[a+3],(x&192)==128&&(v&192)==128&&(I&192)==128&&(w=(p&15)<<18|(x&63)<<12|(v&63)<<6|I&63,w>65535&&w<1114112&&(h=w))}}h===null?(h=65533,_=1):h>65535&&(h-=65536,s.push(h>>>10&1023|55296),h=56320|h&1023),s.push(h),a+=_}return be(s)}const $t=4096;function be(o){const t=o.length;if(t<=$t)return String.fromCharCode.apply(String,o);let e="",s=0;for(;s<t;)e+=String.fromCharCode.apply(String,o.slice(s,s+=$t));return e}function ve(o,t,e){let s="";e=Math.min(o.length,e);for(let a=t;a<e;++a)s+=String.fromCharCode(o[a]&127);return s}function Ee(o,t,e){let s="";e=Math.min(o.length,e);for(let a=t;a<e;++a)s+=String.fromCharCode(o[a]);return s}function xe(o,t,e){const s=o.length;(!t||t<0)&&(t=0),(!e||e<0||e>s)&&(e=s);let a="";for(let p=t;p<e;++p)a+=$e[o[p]];return a}function Ie(o,t,e){const s=o.slice(t,e);let a="";for(let p=0;p<s.length-1;p+=2)a+=String.fromCharCode(s[p]+s[p+1]*256);return a}l.prototype.slice=function(t,e){const s=this.length;t=~~t,e=e===void 0?s:~~e,t<0?(t+=s,t<0&&(t=0)):t>s&&(t=s),e<0?(e+=s,e<0&&(e=0)):e>s&&(e=s),e<t&&(e=t);const a=this.subarray(t,e);return Object.setPrototypeOf(a,l.prototype),a};function S(o,t,e){if(o%1!=0||o<0)throw new RangeError("offset is not uint");if(o+t>e)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,s){t=t>>>0,e=e>>>0,s||S(t,e,this.length);let a=this[t],p=1,h=0;for(;++h<e&&(p*=256);)a+=this[t+h]*p;return a},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,s){t=t>>>0,e=e>>>0,s||S(t,e,this.length);let a=this[t+--e],p=1;for(;e>0&&(p*=256);)a+=this[t+--e]*p;return a},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t=t>>>0,e||S(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||S(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||S(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||S(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=M(function(t){t=t>>>0,G(t,"offset");const e=this[t],s=this[t+7];(e===void 0||s===void 0)&&Q(t,this.length-8);const a=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,p=this[++t]+this[++t]*2**8+this[++t]*2**16+s*2**24;return BigInt(a)+(BigInt(p)<<BigInt(32))}),l.prototype.readBigUInt64BE=M(function(t){t=t>>>0,G(t,"offset");const e=this[t],s=this[t+7];(e===void 0||s===void 0)&&Q(t,this.length-8);const a=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],p=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+s;return(BigInt(a)<<BigInt(32))+BigInt(p)}),l.prototype.readIntLE=function(t,e,s){t=t>>>0,e=e>>>0,s||S(t,e,this.length);let a=this[t],p=1,h=0;for(;++h<e&&(p*=256);)a+=this[t+h]*p;return p*=128,a>=p&&(a-=Math.pow(2,8*e)),a},l.prototype.readIntBE=function(t,e,s){t=t>>>0,e=e>>>0,s||S(t,e,this.length);let a=e,p=1,h=this[t+--a];for(;a>0&&(p*=256);)h+=this[t+--a]*p;return p*=128,h>=p&&(h-=Math.pow(2,8*e)),h},l.prototype.readInt8=function(t,e){return t=t>>>0,e||S(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},l.prototype.readInt16LE=function(t,e){t=t>>>0,e||S(t,2,this.length);const s=this[t]|this[t+1]<<8;return s&32768?s|4294901760:s},l.prototype.readInt16BE=function(t,e){t=t>>>0,e||S(t,2,this.length);const s=this[t+1]|this[t]<<8;return s&32768?s|4294901760:s},l.prototype.readInt32LE=function(t,e){return t=t>>>0,e||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t=t>>>0,e||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=M(function(t){t=t>>>0,G(t,"offset");const e=this[t],s=this[t+7];(e===void 0||s===void 0)&&Q(t,this.length-8);const a=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(s<<24);return(BigInt(a)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),l.prototype.readBigInt64BE=M(function(t){t=t>>>0,G(t,"offset");const e=this[t],s=this[t+7];(e===void 0||s===void 0)&&Q(t,this.length-8);const a=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(a)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+s)}),l.prototype.readFloatLE=function(t,e){return t=t>>>0,e||S(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t=t>>>0,e||S(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||S(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||S(t,8,this.length),i.read(this,t,!1,52,8)};function C(o,t,e,s,a,p){if(!l.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<p)throw new RangeError('"value" argument is out of bounds');if(e+s>o.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,s,a){if(t=+t,e=e>>>0,s=s>>>0,!a){const _=Math.pow(2,8*s)-1;C(this,t,e,s,_,0)}let p=1,h=0;for(this[e]=t&255;++h<s&&(p*=256);)this[e+h]=t/p&255;return e+s},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,s,a){if(t=+t,e=e>>>0,s=s>>>0,!a){const _=Math.pow(2,8*s)-1;C(this,t,e,s,_,0)}let p=s-1,h=1;for(this[e+p]=t&255;--p>=0&&(h*=256);)this[e+p]=t/h&255;return e+s},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,1,255,0),this[e]=t&255,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Tt(o,t,e,s,a){Lt(t,s,a,o,e,7);let p=Number(t&BigInt(4294967295));o[e++]=p,p=p>>8,o[e++]=p,p=p>>8,o[e++]=p,p=p>>8,o[e++]=p;let h=Number(t>>BigInt(32)&BigInt(4294967295));return o[e++]=h,h=h>>8,o[e++]=h,h=h>>8,o[e++]=h,h=h>>8,o[e++]=h,e}function Rt(o,t,e,s,a){Lt(t,s,a,o,e,7);let p=Number(t&BigInt(4294967295));o[e+7]=p,p=p>>8,o[e+6]=p,p=p>>8,o[e+5]=p,p=p>>8,o[e+4]=p;let h=Number(t>>BigInt(32)&BigInt(4294967295));return o[e+3]=h,h=h>>8,o[e+2]=h,h=h>>8,o[e+1]=h,h=h>>8,o[e]=h,e+8}l.prototype.writeBigUInt64LE=M(function(t,e=0){return Tt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=M(function(t,e=0){return Rt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(t,e,s,a){if(t=+t,e=e>>>0,!a){const x=Math.pow(2,8*s-1);C(this,t,e,s,x-1,-x)}let p=0,h=1,_=0;for(this[e]=t&255;++p<s&&(h*=256);)t<0&&_===0&&this[e+p-1]!==0&&(_=1),this[e+p]=(t/h>>0)-_&255;return e+s},l.prototype.writeIntBE=function(t,e,s,a){if(t=+t,e=e>>>0,!a){const x=Math.pow(2,8*s-1);C(this,t,e,s,x-1,-x)}let p=s-1,h=1,_=0;for(this[e+p]=t&255;--p>=0&&(h*=256);)t<0&&_===0&&this[e+p+1]!==0&&(_=1),this[e+p]=(t/h>>0)-_&255;return e+s},l.prototype.writeInt8=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1},l.prototype.writeInt16LE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2},l.prototype.writeInt32LE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,s){return t=+t,e=e>>>0,s||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4},l.prototype.writeBigInt64LE=M(function(t,e=0){return Tt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=M(function(t,e=0){return Rt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ut(o,t,e,s,a,p){if(e+s>o.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function kt(o,t,e,s,a){return t=+t,e=e>>>0,a||Ut(o,t,e,4),i.write(o,t,e,s,23,4),e+4}l.prototype.writeFloatLE=function(t,e,s){return kt(this,t,e,!0,s)},l.prototype.writeFloatBE=function(t,e,s){return kt(this,t,e,!1,s)};function Pt(o,t,e,s,a){return t=+t,e=e>>>0,a||Ut(o,t,e,8),i.write(o,t,e,s,52,8),e+8}l.prototype.writeDoubleLE=function(t,e,s){return Pt(this,t,e,!0,s)},l.prototype.writeDoubleBE=function(t,e,s){return Pt(this,t,e,!1,s)},l.prototype.copy=function(t,e,s,a){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(s||(s=0),!a&&a!==0&&(a=this.length),e>=t.length&&(e=t.length),e||(e=0),a>0&&a<s&&(a=s),a===s||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),t.length-e<a-s&&(a=t.length-e+s);const p=a-s;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,s,a):Uint8Array.prototype.set.call(t,this.subarray(s,a),e),p},l.prototype.fill=function(t,e,s,a){if(typeof t=="string"){if(typeof e=="string"?(a=e,e=0,s=this.length):typeof s=="string"&&(a=s,s=this.length),a!==void 0&&typeof a!="string")throw new TypeError("encoding must be a string");if(typeof a=="string"&&!l.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(t.length===1){const h=t.charCodeAt(0);(a==="utf8"&&h<128||a==="latin1")&&(t=h)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<s)throw new RangeError("Out of range index");if(s<=e)return this;e=e>>>0,s=s===void 0?this.length:s>>>0,t||(t=0);let p;if(typeof t=="number")for(p=e;p<s;++p)this[p]=t;else{const h=l.isBuffer(t)?t:l.from(t,a),_=h.length;if(_===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(p=0;p<s-e;++p)this[p+e]=h[p%_]}return this};const z={};function ht(o,t,e){z[o]=class extends e{constructor(){super();Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${o}]`,this.stack,delete this.name}get code(){return o}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${o}]: ${this.message}`}}}ht("ERR_BUFFER_OUT_OF_BOUNDS",function(o){return o?`${o} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ht("ERR_INVALID_ARG_TYPE",function(o,t){return`The "${o}" argument must be of type number. Received type ${typeof t}`},TypeError),ht("ERR_OUT_OF_RANGE",function(o,t,e){let s=`The value of "${o}" is out of range.`,a=e;return Number.isInteger(e)&&Math.abs(e)>2**32?a=Ot(String(e)):typeof e=="bigint"&&(a=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(a=Ot(a)),a+="n"),s+=` It must be ${t}. Received ${a}`,s},RangeError);function Ot(o){let t="",e=o.length;const s=o[0]==="-"?1:0;for(;e>=s+4;e-=3)t=`_${o.slice(e-3,e)}${t}`;return`${o.slice(0,e)}${t}`}function Se(o,t,e){G(t,"offset"),(o[t]===void 0||o[t+e]===void 0)&&Q(t,o.length-(e+1))}function Lt(o,t,e,s,a,p){if(o>e||o<t){const h=typeof t=="bigint"?"n":"";let _;throw p>3?t===0||t===BigInt(0)?_=`>= 0${h} and < 2${h} ** ${(p+1)*8}${h}`:_=`>= -(2${h} ** ${(p+1)*8-1}${h}) and < 2 ** ${(p+1)*8-1}${h}`:_=`>= ${t}${h} and <= ${e}${h}`,new z.ERR_OUT_OF_RANGE("value",_,o)}Se(s,a,p)}function G(o,t){if(typeof o!="number")throw new z.ERR_INVALID_ARG_TYPE(t,"number",o)}function Q(o,t,e){throw Math.floor(o)!==o?(G(o,e),new z.ERR_OUT_OF_RANGE(e||"offset","an integer",o)):t<0?new z.ERR_BUFFER_OUT_OF_BOUNDS:new z.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${t}`,o)}const Be=/[^+/0-9A-Za-z-_]/g;function Fe(o){if(o=o.split("=")[0],o=o.trim().replace(Be,""),o.length<2)return"";for(;o.length%4!=0;)o=o+"=";return o}function dt(o,t){t=t||1/0;let e;const s=o.length;let a=null;const p=[];for(let h=0;h<s;++h){if(e=o.charCodeAt(h),e>55295&&e<57344){if(!a){if(e>56319){(t-=3)>-1&&p.push(239,191,189);continue}else if(h+1===s){(t-=3)>-1&&p.push(239,191,189);continue}a=e;continue}if(e<56320){(t-=3)>-1&&p.push(239,191,189),a=e;continue}e=(a-55296<<10|e-56320)+65536}else a&&(t-=3)>-1&&p.push(239,191,189);if(a=null,e<128){if((t-=1)<0)break;p.push(e)}else if(e<2048){if((t-=2)<0)break;p.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;p.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;p.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return p}function Ce(o){const t=[];for(let e=0;e<o.length;++e)t.push(o.charCodeAt(e)&255);return t}function Ae(o,t){let e,s,a;const p=[];for(let h=0;h<o.length&&!((t-=2)<0);++h)e=o.charCodeAt(h),s=e>>8,a=e%256,p.push(a),p.push(s);return p}function Dt(o){return n.toByteArray(Fe(o))}function et(o,t,e,s){let a;for(a=0;a<s&&!(a+e>=t.length||a>=o.length);++a)t[a+e]=o[a];return a}function k(o,t){return o instanceof t||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===t.name}function yt(o){return o!==o}const $e=function(){const o="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){const s=e*16;for(let a=0;a<16;++a)t[s+a]=o[e]+o[a]}return t}();function M(o){return typeof BigInt=="undefined"?Te:o}function Te(){throw new Error("BigInt not supported")}})(vt);const ni=r=>{const n=document.createElement("canvas");return n.width=r.width,n.height=r.height,n.getContext("2d").drawImage(r,0,0),console.log("update Canvas",n),n.toDataURL("image/png",100)},jn=(r,n,i)=>{if(n){if(r.width<=n)return r;i=n*(r.height/r.width)}else{if(r.height<=i)return r;n=i*(r.width/r.height)}const c=new OffscreenCanvas(n,i);return c.getContext("2d").drawImage(r,0,0,n,i),c},Nn=async r=>{const n=new window.Image;await new Promise(u=>{n.onload=()=>u(n),n.src=r,n.crossOrigin="anonymous"});const i=new OffscreenCanvas(n.naturalWidth,n.naturalHeight);return i.getContext("2d").drawImage(n,0,0),i},ii=(r,n)=>{r=jn(r,Me);const i=r.getContext("2d"),c=i.getImageData(0,0,i.canvas.width,i.canvas.height);return Vn(c.data,[n.printer.preview.foreground,n.printer.preview.background]),i.putImageData(c,0,0),r},Vn=(r,n)=>{for(let i=0;i<r.length;i+=4)(r[i]+r[i+1]+r[i+2])/3/255<.6?(r[i]=n[0][0],r[i+1]=n[0][1],r[i+2]=n[0][2]):(r[i]=n[1][0],r[i+1]=n[1][1],r[i+2]=n[1][2])},Wn=async r=>(await Pe(r)).map(c=>[vt.Buffer.from(Hn(c.width,c.height))].concat(Oe(c).map(u=>zn(u)))).flat(),Hn=(r,n)=>{const{xL:i,xH:c,yL:u,yH:f,k:d}=De(r,n),l=[Nt,118,48,0,i,c,u,f];if(l[0]===Nt&&l[1]===118&&l[2]===48&&!(d<=Vt))throw new Error(`Image too large; ${d} > ${Vt}`);return l},zn=function(r){const n=vt.Buffer.alloc(r.byteLength),i=new Uint8Array(r);for(let c=0;c<n.length;++c)n[c]=i[c];return n},It=(r,n)=>(r=Le(r,n),Wn(r));var le={cutLine:{display:()=>({title:"Cut Line"})},barcode:{display:r=>({title:"Barcode",value:r.text}),beforePrinterCommand:async r=>{const{text:n,options:i,imageOptions:c}=r.value,u=await je(n||"empty",i||{});return r.value=await It(u,c),r}},qrCode:{display:r=>({title:"QR Code",value:r.text}),beforePrinterCommand:async r=>{const{text:n,options:i,imageOptions:c}=r.value,u=await Ne(n||"empty",i||{});return r.value=await It(u,c),r}},image:{display:()=>({title:"Image"}),beforePrinterCommand:async r=>{const{file:n,imageOptions:i}=r.value;return r.value=await It(await Nn(n),i),r}},text:{display:r=>({title:"Text",value:`${r.slice(0,16)}\u2026`})},feedPitch:{display:({type:r,value:n})=>({title:"Feed-Pitch",value:`${r} | ${n}`})},reset:{display:r=>({property:!0,title:"Reset"})},setAlign:{display:r=>({property:!0,title:"Align",value:`${Object.entries(_t).find(n=>n[1]===r)[0]}`})},setFont:{display:r=>({property:!0,title:"Font",value:Object.entries(Y).find(n=>Number(r)===n[1])[0]})},setLineSpace:{display:r=>({property:!0,title:"Line-Space",value:r})},setWordGap:{display:r=>({property:!0,title:"Word-Gap",value:r})},setMargin:{display:r=>({property:!0,title:"Margin",value:r})},setDensity:{display:r=>({property:!0,title:"Density",value:r})}};class Gn extends Ve{constructor(){super();this.socket=null,this.connected=!1}async connect(n=3e3,i="localhost",c=!1){const u=c?"wss":"ws";this.io=await this.ready();const f=this.io(`${u}://${i}:${n}`,{autoConnect:!1,reconnection:!1,secure:c,transports:["websocket"]});this.socket=await new Promise((d,l)=>{f.on("error",y=>{this.emit("error",y)}),f.on("connect_error",y=>{this.emit("error",y),l(y)}),f.on("connect",()=>{this.connected=f.connected,this.emit("connect"),d(f)}),f.on("disconnect",()=>{this.disconnect(),this.emit("disconnect")}),f.connect()})}async ready(){if(this.io)return this.io;const{io:n}=await L(()=>import("./index.c6f0c553.js"),[]);return this.io=n,n}get host(){var n,i,c;return(c=(i=(n=this.socket)==null?void 0:n.io)==null?void 0:i.opts)==null?void 0:c.hostname}get port(){var n,i,c,u,f,d;return((c=(i=(n=this.socket)==null?void 0:n.io)==null?void 0:i.opts)==null?void 0:c.port)&&Number((d=(f=(u=this.socket)==null?void 0:u.io)==null?void 0:f.opts)==null?void 0:d.port)||void 0}get secure(){var n,i,c;return(c=(i=(n=this.socket)==null?void 0:n.io)==null?void 0:i.opts)==null?void 0:c.secure}promiseEmit(n,i){return new Promise(c=>{this.socket.emit(n,i,c)})}disconnect(){var n;(n=this.socket)==null||n.destroy(),this.socket=null,this.connected=!1}async getInfo(){const n=await this.promiseEmit("getInfo");return console.log("getInfo",n),n}async executeActions(n){n=await Promise.all(n.map(async c=>"beforePrinterCommand"in le[c.type]?await le[c.type].beforePrinterCommand(Object.assign({},c)):c));const i=await this.promiseEmit("executeActions",n);console.log("executeActions",i)}}const St=$.observable(new Gn);_r(St);St.on("error",r=>{ue.add(r)});Object.defineProperty($.prototype,"$client",{get(){return St}});class qn{constructor(){this.prompts=[]}prompt(n,i){return new Promise(c=>{const u={title:i,message:n},f=d=>{this.prompts.slice(this.prompts.indexOf(u),1),c(d)};u.callback=f,this.prompts.push(u)})}}const Yn=$.observable(new qn);Object.defineProperty($.prototype,"$dialog",{get(){return Yn}});$.component("App",ce);new $({render:r=>r(ce)}).$mount("#app");export{Mr as A,Qr as B,An as D,Kn as F,ti as M,j as S,L as _,le as a,P as b,Cn as c,ei as d,lt as e,ct as f,Nn as g,Qn as k,W as n,ii as p,jn as r,yr as s,ni as t};
