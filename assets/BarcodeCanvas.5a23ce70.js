import{n as c,v as h,p as l,A as s,a as d}from"./index.67fd3a58.js";import{a as u}from"./Printer.765364f3.js";import m from"./TextCanvas.65ce93eb.js";import"./vendor.b1428349.js";import"./devterm.eed8f68c.js";import"./buffer.89012e65.js";import"./View.c40cc634.js";import"./TextButton.8a136169.js";import"./TextField.bcd10360.js";import"./Dialog.ca0be6c5.js";import"./FileSelect.0a4fdd11.js";import"./CheckBox.9c65fd89.js";var p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.error?a("preview-text-canvas",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):a("canvas",{ref:"canvas"})],1)},v=[];const f={components:{PreviewTextCanvas:m},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return u()}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$refs.canvas.height=this.img.naturalHeight,t()},this.img.src=e})},getColor(e){return`rgb(${this.colors.primary.join(" ")} / ${e*100}%)`},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(async()=>{try{const t=await h(this.value.text||"empty",this.value.options||{}),a=l(t,this.value.imageOptions);e.canvas.width=this.width,e.canvas.height=a.height;const n=this.width,o=parseInt(this.options.margin*n);let r=0;switch(this.options.align){case s.RIGHT:r+=this.width-a.width;break;case s.CENTER:r+=(this.width-a.width)/2;break;default:r+=o;break}e.drawImage(a,r,0)}catch(t){this.error=t}d(e.canvas,this.colors)})})}}},i={};var g=c(f,p,v,!1,_,"e91622d8",null,null);function _(e){for(let t in i)this[t]=i[t]}var O=function(){return g.exports}();export{O as default};
