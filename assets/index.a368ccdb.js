var ke=Object.defineProperty;var jt=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var Nt=(e,n,i)=>n in e?ke(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,D=(e,n)=>{for(var i in n||(n={}))Pe.call(n,i)&&Nt(e,i,n[i]);if(jt)for(var i of jt(n))Oe.call(n,i)&&Nt(e,i,n[i]);return e};import{V as $}from"./vendor.b1428349.js";import{J as Le,b as De,a as Me,f as je,E as Ne}from"./devterm.a10f71a8.js";const Ve=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))s(u);new MutationObserver(u=>{for(const f of u)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(u){const f={};return u.integrity&&(f.integrity=u.integrity),u.referrerpolicy&&(f.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?f.credentials="include":u.crossorigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function s(u){if(u.ep)return;u.ep=!0;const f=i(u);fetch(u.href,f)}};Ve();const He="modulepreload",Vt={},We="/",M=function(n,i){return!i||i.length===0?n():Promise.all(i.map(s=>{if(s=`${We}${s}`,s in Vt)return;Vt[s]=!0;const u=s.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":He,u||(h.as="script",h.crossOrigin=""),h.href=s,document.head.appendChild(h),u)return new Promise((l,y)=>{h.addEventListener("load",l),h.addEventListener("error",y)})})).then(()=>n())};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var mt=function(e,n){return mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var u in s)s.hasOwnProperty(u)&&(i[u]=s[u])},mt(e,n)};function O(e,n){mt(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}function nt(e){return typeof e=="function"}var Ht=!1,R={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var n=new Error;""+n.stack}Ht=e},get useDeprecatedSynchronousErrorHandling(){return Ht}};function K(e){setTimeout(function(){throw e},0)}var it={closed:!0,next:function(e){},error:function(e){if(R.useDeprecatedSynchronousErrorHandling)throw e;K(e)},complete:function(){}},Wt=function(){return Array.isArray||function(e){return e&&typeof e.length=="number"}}();function ze(e){return e!==null&&typeof e=="object"}var Ze=function(){function e(n){return Error.call(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(i,s){return s+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n,this}return e.prototype=Object.create(Error.prototype),e}(),ot=Ze,W=function(){function e(n){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,n&&(this._ctorUnsubscribe=!0,this._unsubscribe=n)}return e.prototype.unsubscribe=function(){var n;if(!this.closed){var i=this,s=i._parentOrParents,u=i._ctorUnsubscribe,f=i._unsubscribe,h=i._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof e)s.remove(this);else if(s!==null)for(var l=0;l<s.length;++l){var y=s[l];y.remove(this)}if(nt(f)){u&&(this._unsubscribe=void 0);try{f.call(this)}catch(b){n=b instanceof ot?zt(b.errors):[b]}}if(Wt(h))for(var l=-1,w=h.length;++l<w;){var g=h[l];if(ze(g))try{g.unsubscribe()}catch(x){n=n||[],x instanceof ot?n=n.concat(zt(x.errors)):n.push(x)}}if(n)throw new ot(n)}},e.prototype.add=function(n){var i=n;if(!n)return e.EMPTY;switch(typeof n){case"function":i=new e(n);case"object":if(i===this||i.closed||typeof i.unsubscribe!="function")return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){var s=i;i=new e,i._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+n+" added to Subscription.")}var u=i._parentOrParents;if(u===null)i._parentOrParents=this;else if(u instanceof e){if(u===this)return i;i._parentOrParents=[u,this]}else if(u.indexOf(this)===-1)u.push(this);else return i;var f=this._subscriptions;return f===null?this._subscriptions=[i]:f.push(i),i},e.prototype.remove=function(n){var i=this._subscriptions;if(i){var s=i.indexOf(n);s!==-1&&i.splice(s,1)}},e.EMPTY=function(n){return n.closed=!0,n}(new e),e}();function zt(e){return e.reduce(function(n,i){return n.concat(i instanceof ot?i.errors:i)},[])}var st=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),V=function(e){O(n,e);function n(i,s,u){var f=e.call(this)||this;switch(f.syncErrorValue=null,f.syncErrorThrown=!1,f.syncErrorThrowable=!1,f.isStopped=!1,arguments.length){case 0:f.destination=it;break;case 1:if(!i){f.destination=it;break}if(typeof i=="object"){i instanceof n?(f.syncErrorThrowable=i.syncErrorThrowable,f.destination=i,i.add(f)):(f.syncErrorThrowable=!0,f.destination=new Zt(f,i));break}default:f.syncErrorThrowable=!0,f.destination=new Zt(f,i,s,u);break}return f}return n.prototype[st]=function(){return this},n.create=function(i,s,u){var f=new n(i,s,u);return f.syncErrorThrowable=!1,f},n.prototype.next=function(i){this.isStopped||this._next(i)},n.prototype.error=function(i){this.isStopped||(this.isStopped=!0,this._error(i))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},n.prototype._next=function(i){this.destination.next(i)},n.prototype._error=function(i){this.destination.error(i),this.unsubscribe()},n.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},n.prototype._unsubscribeAndRecycle=function(){var i=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=i,this},n}(W),Zt=function(e){O(n,e);function n(i,s,u,f){var h=e.call(this)||this;h._parentSubscriber=i;var l,y=h;return nt(s)?l=s:s&&(l=s.next,u=s.error,f=s.complete,s!==it&&(y=Object.create(s),nt(y.unsubscribe)&&h.add(y.unsubscribe.bind(y)),y.unsubscribe=h.unsubscribe.bind(h))),h._context=y,h._next=l,h._error=u,h._complete=f,h}return n.prototype.next=function(i){if(!this.isStopped&&this._next){var s=this._parentSubscriber;!R.useDeprecatedSynchronousErrorHandling||!s.syncErrorThrowable?this.__tryOrUnsub(this._next,i):this.__tryOrSetError(s,this._next,i)&&this.unsubscribe()}},n.prototype.error=function(i){if(!this.isStopped){var s=this._parentSubscriber,u=R.useDeprecatedSynchronousErrorHandling;if(this._error)!u||!s.syncErrorThrowable?(this.__tryOrUnsub(this._error,i),this.unsubscribe()):(this.__tryOrSetError(s,this._error,i),this.unsubscribe());else if(s.syncErrorThrowable)u?(s.syncErrorValue=i,s.syncErrorThrown=!0):K(i),this.unsubscribe();else{if(this.unsubscribe(),u)throw i;K(i)}}},n.prototype.complete=function(){var i=this;if(!this.isStopped){var s=this._parentSubscriber;if(this._complete){var u=function(){return i._complete.call(i._context)};!R.useDeprecatedSynchronousErrorHandling||!s.syncErrorThrowable?(this.__tryOrUnsub(u),this.unsubscribe()):(this.__tryOrSetError(s,u),this.unsubscribe())}else this.unsubscribe()}},n.prototype.__tryOrUnsub=function(i,s){try{i.call(this._context,s)}catch(u){if(this.unsubscribe(),R.useDeprecatedSynchronousErrorHandling)throw u;K(u)}},n.prototype.__tryOrSetError=function(i,s,u){if(!R.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{s.call(this._context,u)}catch(f){return R.useDeprecatedSynchronousErrorHandling?(i.syncErrorValue=f,i.syncErrorThrown=!0,!0):(K(f),!0)}return!1},n.prototype._unsubscribe=function(){var i=this._parentSubscriber;this._context=null,this._parentSubscriber=null,i.unsubscribe()},n}(V);function Ge(e){for(;e;){var n=e,i=n.closed,s=n.destination,u=n.isStopped;if(i||u)return!1;s&&s instanceof V?e=s:e=null}return!0}function Ye(e,n,i){if(e){if(e instanceof V)return e;if(e[st])return e[st]()}return!e&&!n&&!i?new V(it):new V(e,n,i)}var Xe=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function qe(e){return e}function Je(e){return e.length===0?qe:e.length===1?e[0]:function(i){return e.reduce(function(s,u){return u(s)},i)}}var ct=function(){function e(n){this._isScalar=!1,n&&(this._subscribe=n)}return e.prototype.lift=function(n){var i=new e;return i.source=this,i.operator=n,i},e.prototype.subscribe=function(n,i,s){var u=this.operator,f=Ye(n,i,s);if(u?f.add(u.call(f,this.source)):f.add(this.source||R.useDeprecatedSynchronousErrorHandling&&!f.syncErrorThrowable?this._subscribe(f):this._trySubscribe(f)),R.useDeprecatedSynchronousErrorHandling&&f.syncErrorThrowable&&(f.syncErrorThrowable=!1,f.syncErrorThrown))throw f.syncErrorValue;return f},e.prototype._trySubscribe=function(n){try{return this._subscribe(n)}catch(i){R.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=i),Ge(n)?n.error(i):console.warn(i)}},e.prototype.forEach=function(n,i){var s=this;return i=Gt(i),new i(function(u,f){var h;h=s.subscribe(function(l){try{n(l)}catch(y){f(y),h&&h.unsubscribe()}},f,u)})},e.prototype._subscribe=function(n){var i=this.source;return i&&i.subscribe(n)},e.prototype[Xe]=function(){return this},e.prototype.pipe=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.length===0?this:Je(n)(this)},e.prototype.toPromise=function(n){var i=this;return n=Gt(n),new n(function(s,u){var f;i.subscribe(function(h){return f=h},function(h){return u(h)},function(){return s(f)})})},e.create=function(n){return new e(n)},e}();function Gt(e){if(e||(e=R.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var Qe=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),tt=Qe,Ke=function(e){O(n,e);function n(i,s){var u=e.call(this)||this;return u.subject=i,u.subscriber=s,u.closed=!1,u}return n.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var i=this.subject,s=i.observers;if(this.subject=null,!(!s||s.length===0||i.isStopped||i.closed)){var u=s.indexOf(this.subscriber);u!==-1&&s.splice(u,1)}}},n}(W),Yt=function(e){O(n,e);function n(i){var s=e.call(this,i)||this;return s.destination=i,s}return n}(V),Xt=function(e){O(n,e);function n(){var i=e.call(this)||this;return i.observers=[],i.closed=!1,i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return n.prototype[st]=function(){return new Yt(this)},n.prototype.lift=function(i){var s=new qt(this,this);return s.operator=i,s},n.prototype.next=function(i){if(this.closed)throw new tt;if(!this.isStopped)for(var s=this.observers,u=s.length,f=s.slice(),h=0;h<u;h++)f[h].next(i)},n.prototype.error=function(i){if(this.closed)throw new tt;this.hasError=!0,this.thrownError=i,this.isStopped=!0;for(var s=this.observers,u=s.length,f=s.slice(),h=0;h<u;h++)f[h].error(i);this.observers.length=0},n.prototype.complete=function(){if(this.closed)throw new tt;this.isStopped=!0;for(var i=this.observers,s=i.length,u=i.slice(),f=0;f<s;f++)u[f].complete();this.observers.length=0},n.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},n.prototype._trySubscribe=function(i){if(this.closed)throw new tt;return e.prototype._trySubscribe.call(this,i)},n.prototype._subscribe=function(i){if(this.closed)throw new tt;return this.hasError?(i.error(this.thrownError),W.EMPTY):this.isStopped?(i.complete(),W.EMPTY):(this.observers.push(i),new Ke(this,i))},n.prototype.asObservable=function(){var i=new ct;return i.source=this,i},n.create=function(i,s){return new qt(i,s)},n}(ct),qt=function(e){O(n,e);function n(i,s){var u=e.call(this)||this;return u.destination=i,u.source=s,u}return n.prototype.next=function(i){var s=this.destination;s&&s.next&&s.next(i)},n.prototype.error=function(i){var s=this.destination;s&&s.error&&this.destination.error(i)},n.prototype.complete=function(){var i=this.destination;i&&i.complete&&this.destination.complete()},n.prototype._subscribe=function(i){var s=this.source;return s?this.source.subscribe(i):W.EMPTY},n}(Xt);function Jt(){return function(n){return n.lift(new tr(n))}}var tr=function(){function e(n){this.connectable=n}return e.prototype.call=function(n,i){var s=this.connectable;s._refCount++;var u=new er(n,s),f=i.subscribe(u);return u.closed||(u.connection=s.connect()),f},e}(),er=function(e){O(n,e);function n(i,s){var u=e.call(this,i)||this;return u.connectable=s,u}return n.prototype._unsubscribe=function(){var i=this.connectable;if(!i){this.connection=null;return}this.connectable=null;var s=i._refCount;if(s<=0){this.connection=null;return}if(i._refCount=s-1,s>1){this.connection=null;return}var u=this.connection,f=i._connection;this.connection=null,f&&(!u||f===u)&&f.unsubscribe()},n}(V),rr=function(e){O(n,e);function n(i,s){var u=e.call(this)||this;return u.source=i,u.subjectFactory=s,u._refCount=0,u._isComplete=!1,u}return n.prototype._subscribe=function(i){return this.getSubject().subscribe(i)},n.prototype.getSubject=function(){var i=this._subject;return(!i||i.isStopped)&&(this._subject=this.subjectFactory()),this._subject},n.prototype.connect=function(){var i=this._connection;return i||(this._isComplete=!1,i=this._connection=new W,i.add(this.source.subscribe(new ir(this.getSubject(),this))),i.closed&&(this._connection=null,i=W.EMPTY)),i},n.prototype.refCount=function(){return Jt()(this)},n}(ct),nr=function(){var e=rr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),ir=function(e){O(n,e);function n(i,s){var u=e.call(this,i)||this;return u.connectable=s,u}return n.prototype._error=function(i){this._unsubscribe(),e.prototype._error.call(this,i)},n.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var i=this.connectable;if(i){this.connectable=null;var s=i._connection;i._refCount=0,i._subject=null,i._connection=null,s&&s.unsubscribe()}},n}(Yt);function or(e,n){return function(s){if(typeof e!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return s.lift(new sr(e,n))}}var sr=function(){function e(n,i){this.project=n,this.thisArg=i}return e.prototype.call=function(n,i){return i.subscribe(new cr(n,this.project,this.thisArg))},e}(),cr=function(e){O(n,e);function n(i,s,u){var f=e.call(this,i)||this;return f.project=s,f.count=0,f.thisArg=u||f,f}return n.prototype._next=function(i){var s;try{s=this.project.call(this.thisArg,i,this.count++)}catch(u){this.destination.error(u);return}this.destination.next(s)},n}(V);function ut(e,n,i,s){return nt(i)&&(s=i,i=void 0),s?ut(e,n,i).pipe(or(function(u){return Wt(u)?s.apply(void 0,u):s(u)})):new ct(function(u){function f(h){arguments.length>1?u.next(Array.prototype.slice.call(arguments)):u.next(h)}Qt(e,n,f,u,i)})}function Qt(e,n,i,s,u){var f;if(lr(e)){var h=e;e.addEventListener(n,i,u),f=function(){return h.removeEventListener(n,i,u)}}else if(ar(e)){var l=e;e.on(n,i),f=function(){return l.off(n,i)}}else if(ur(e)){var y=e;e.addListener(n,i),f=function(){return y.removeListener(n,i)}}else if(e&&e.length)for(var w=0,g=e.length;w<g;w++)Qt(e[w],n,i,s,u);else throw new TypeError("Invalid event target");s.add(f)}function ur(e){return e&&typeof e.addListener=="function"&&typeof e.removeListener=="function"}function ar(e){return e&&typeof e.on=="function"&&typeof e.off=="function"}function lr(e){return e&&typeof e.addEventListener=="function"&&typeof e.removeEventListener=="function"}function fr(e,n){return function(s){var u;if(typeof e=="function"?u=e:u=function(){return e},typeof n=="function")return s.lift(new pr(u,n));var f=Object.create(s,nr);return f.source=s,f.subjectFactory=u,f}}var pr=function(){function e(n,i){this.subjectFactory=n,this.selector=i}return e.prototype.call=function(n,i){var s=this.selector,u=this.subjectFactory(),f=s(u).subscribe(n);return f.add(i.subscribe(u)),f},e}();function hr(){return new Xt}function gt(){return function(e){return Jt()(fr(hr)(e))}}ut(window,"resize").pipe(gt());ut(window,"keypress").pipe(gt());const pi=ut(window,"keyup").pipe(gt()),dr=e=>new Promise(n=>{const i=document.createElement("input");i.type="file",i.accept=(e||[]).join(","),i.click(),i.addEventListener("change",s=>{const u=(s.dataTransfer||s.target).files;i.remove(),n(u)})}),yr=e=>{U()&&(e.on("connect",()=>{window.electron.ipcRenderer.invoke("client","connect",!0)}),e.on("disconnect",()=>{window.electron.ipcRenderer.invoke("client","connect",!1)}))},_r=()=>{window.electron.ipcRenderer.invoke("window","minimize")},wr=()=>{window.electron.ipcRenderer.invoke("window","maximize")},mr=e=>{if(U())window.electron.ipcRenderer.invoke("window","fullscreen",e);else return e?document.body.requestFullscreen():document.exitFullscreen()},gr=()=>{window.electron.ipcRenderer.invoke("close")},U=()=>"electron"in window,br=e=>{if(U())return window.electron.ipcRenderer.invoke("save",e);{const n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","scene.json"),i.click()}},Er=async()=>{if(U())return window.electron.ipcRenderer.invoke("load");{const e=await dr("text");return new Promise((n,i)=>{if(e.length){const s=new FileReader;s.addEventListener("load",()=>{try{n(JSON.parse(s.result))}catch(u){i(u)}}),s.readAsText(e[0])}else n()})}},xr=e=>{U()&&window.electron.ipcRendererReceive("dialog",e)},vr=e=>{U()?window.electron.ipcRendererReceive("window",(n,i)=>{switch(n){case"fullscreen":e(i);break}}):window.addEventListener("fullscreenchange",()=>{e(document.fullscreenEnabled)})},Ir=()=>U()?window.electron.ipcRenderer.invoke("loadConfig"):JSON.parse(window.localStorage.getItem("config")),Sr=e=>U()?window.electron.ipcRenderer.invoke("saveConfig",e):window.localStorage.setItem("config",JSON.stringify(e)),Br=()=>U()?window.electron.ipcRenderer.invoke("getCurrentVersion"):"1.0.0-beta.14";var Cr=6,hi=16,Kt=9224,Fr=384,te=29,B={SIZE_8_16_THIN_1:0,SIZE_8_16_THIN_2:4,SIZE_5_7:1,SIZE_6_12:2,SIZE_7_14:3},di={[B.SIZE_5_7]:76,[B.SIZE_6_12]:63,[B.SIZE_7_14]:54,[B.SIZE_8_16_THIN_1]:47,[B.SIZE_8_16_THIN_2]:47},yi={[B.SIZE_8_16_THIN_1]:[8,16],[B.SIZE_8_16_THIN_2]:[8,16],[B.SIZE_7_14]:[7,14],[B.SIZE_6_12]:[6,12],[B.SIZE_5_7]:[5,7]},at={LEFT:0,CENTER:1,RIGHT:2},_i=()=>({align:at.LEFT,font:B.SIZE_8_16_THIN_1,margin:0,underline:0,lineSpace:0,density:Cr,underLine:0,wordGap:0}),Ar="/assets/5x7-ISO8859-1.1e468e9f.ttf",Tr="/assets/6x12-ISO8859-1.4c4c24d1.ttf",$r="/assets/7x14-ISO8859-1.b8471bdd.ttf",Rr="/assets/Px437_CompaqThin_8x16.ccffc04f.ttf";const Ur=()=>{const e=[["5x7-ISO8859-1",`url(${Ar})`],["6x12-ISO8859-1",`url(${Tr})`],["7x14-ISO8859-1",`url(${$r})`],["Px437_CompaqThin_8x16",`url(${Rr})`]];return Promise.all(e.map(async n=>{console.log("load font",n[0],n[1]);const i=new FontFace(...n);return await i.load(),document.fonts.add(i),i}))},wi={[B.SIZE_5_7]:{fontFamily:"5x7-ISO8859-1",fontSize:7},[B.SIZE_6_12]:{fontFamily:"6x12-ISO8859-1",fontSize:12},[B.SIZE_7_14]:{fontFamily:"7x14-ISO8859-1",fontSize:14},[B.SIZE_8_16_THIN_1]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16},[B.SIZE_8_16_THIN_2]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16}};var lt,kr=new Uint8Array(16);function Pr(){if(!lt&&(lt=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!lt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return lt(kr)}var Or=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Lr(e){return typeof e=="string"&&Or.test(e)}var C=[];for(var bt=0;bt<256;++bt)C.push((bt+256).toString(16).substr(1));function Dr(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=(C[e[n+0]]+C[e[n+1]]+C[e[n+2]]+C[e[n+3]]+"-"+C[e[n+4]]+C[e[n+5]]+"-"+C[e[n+6]]+C[e[n+7]]+"-"+C[e[n+8]]+C[e[n+9]]+"-"+C[e[n+10]]+C[e[n+11]]+C[e[n+12]]+C[e[n+13]]+C[e[n+14]]+C[e[n+15]]).toLowerCase();if(!Lr(i))throw TypeError("Stringified UUID is invalid");return i}function Mr(e,n,i){e=e||{};var s=e.random||(e.rng||Pr)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,n){i=i||0;for(var u=0;u<16;++u)n[i+u]=s[u];return n}return Dr(s)}class jr{constructor(n){const{type:i,value:s}=n||{};this.id=Mr(),this.type=i,this.value=s}toJSON(){return{id:this.id,type:this.type,value:this.value}}}var Nr=[{type:"reset"},{type:"setAlign",value:at.CENTER},{type:"qrCode",value:{text:"Devterm",options:{errorCorrectionLevel:"M",margin:0,scale:4,small:!1},imageOptions:{rotate:!1,flipX:!1,flipY:!1,width:null}}},{type:"setAlign",value:at.LEFT},{type:"text",value:"Left"}],Vr=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"app-menu"},[i("ul",[e._t("default")],2)])},Hr=[];function z(e,n,i,s,u,f,h,l){var y=typeof e=="function"?e.options:e;n&&(y.render=n,y.staticRenderFns=i,y._compiled=!0),s&&(y.functional=!0),f&&(y._scopeId="data-v-"+f);var w;if(h?(w=function(x){x=x||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!x&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(x=__VUE_SSR_CONTEXT__),u&&u.call(this,x),x&&x._registeredComponents&&x._registeredComponents.add(h)},y._ssrRegister=w):u&&(w=l?function(){u.call(this,(y.functional?this.parent:this).$root.$options.shadowRoot)}:u),w)if(y.functional){y._injectStyles=w;var g=y.render;y.render=function(F,j){return w.call(j),g(F,j)}}else{var b=y.beforeCreate;y.beforeCreate=b?[].concat(b,w):[w]}return{exports:e,options:y}}const Wr={},ee={};var zr=z(Wr,Vr,Hr,!1,Zr,"447d30c4",null,null);function Zr(e){for(let n in ee)this[n]=ee[n]}var Gr=function(){return zr.exports}(),Yr=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("button",e._g({staticClass:"base-generic-button"},e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)},Xr=[];const qr={props:{text:{type:String,default:"Button Text"}}},re={};var Jr=z(qr,Yr,Xr,!1,Qr,"eeccf710",null,null);function Qr(e){for(let n in re)this[n]=re[n]}var Kr=function(){return Jr.exports}(),tn=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("li",{staticClass:"app-menu-item",class:{selected:e.selected}},[i("base-generic-button",e._g(e._b({},"base-generic-button",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)],1)},en=[];const rn={components:{BaseGenericButton:Kr},inheritAttrs:!1,props:{selected:{type:Boolean,default:!1},text:{type:String,default:null}}},ne={};var nn=z(rn,tn,en,!1,on,"3f1b0188",null,null);function on(e){for(let n in ne)this[n]=ne[n]}var k=function(){return nn.exports}(),sn=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("li",e._g(e._b({staticClass:"app-menu-text"},"li",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[i("span",{domProps:{innerHTML:e._s(e.text)}})]})],2)},cn=[];const un={inheritAttrs:!1,props:{text:{type:String,default:null}}},ie={};var an=z(un,sn,cn,!1,ln,"11d97818",null,null);function ln(e){for(let n in ie)this[n]=ie[n]}var ft=function(){return an.exports}(),fn=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("li",{staticClass:"app-menu-spacer"},[e._t("default")],2)},pn=[];const hn={},oe={};var dn=z(hn,fn,pn,!1,yn,"d155e842",null,null);function yn(e){for(let n in oe)this[n]=oe[n]}var Et=function(){return dn.exports}(),_n=function(){var e=this,n=e.$createElement;return e._self._c,e._m(0)},wn=[function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("li",{staticClass:"app-menu-divider"},[i("i")])}];const mn={},se={};var gn=z(mn,_n,wn,!1,bn,"12222a62",null,null);function bn(e){for(let n in se)this[n]=se[n]}var X=function(){return gn.exports}(),En=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"app",class:{ready:e.ready},style:e.style},[i("app-menu",{staticClass:"header"},e._l(e.headerItems,function(s,u){return i(s.component,e._g(e._b({key:u,tag:"component"},"component",s.props,!1),s.on))}),1),i("div",{staticClass:"app-content"},[!e.$client.connected&&e.ready?i("view-start",{on:{apply:e.onApplyViewStart}}):e.currentView===e.VIEWS.PRINTER?i("view-printer",{attrs:{colors:e.colors},model:{value:e.printerTemplate,callback:function(s){e.printerTemplate=s},expression:"printerTemplate"}}):e.currentView===e.VIEWS.INFO?i("view-info"):e._e()],1),i("app-menu",{staticClass:"footer"},e._l(e.footerItems,function(s,u){return i(s.component,e._g(e._b({key:u,tag:"component"},"component",s.props,!1),s.on))}),1),e._l(e.$errorList.errors,function(s,u){return i("dialog-error",e._b({key:u,attrs:{"init-open":""}},"dialog-error",s,!1))}),e._l(e.$dialog.prompts,function(s,u){return i("dialog-prompt",e._b({key:u,attrs:{"init-open":""}},"dialog-prompt",s,!1))}),e.ready?i("dialog-remote",{ref:"dialogRemote"}):e._e(),e.ready?i("dialog-server",{ref:"dialogServer"}):e._e(),e.ready?i("dialog-options",{ref:"dialogOptions"}):e._e()],2)},xn=[];const Z={NONE:null,INFO:"info",START:"start",PRINTER:"priner"},vn={amber:{primary:[255,204,0],secondary:[0,0,0],printer:{preview:{background:[255,204,0],foreground:[0,0,0]}}},green:{primary:[51,255,0],secondary:[0,0,0],printer:{preview:{background:[51,255,0],foreground:[0,0,0]}}},whiteBlack:{primary:[255,255,255],secondary:[0,0,0],printer:{preview:{background:[255,255,255],foreground:[0,0,0]}}},blackWhite:{primary:[0,0,0],secondary:[255,255,255],printer:{preview:{background:[0,0,0],foreground:[255,255,255]}}}};function In(){return Nr.map(e=>new jr(e))}const Sn={components:{ViewPrinter:()=>M(()=>import("./Printer.65619e84.js").then(function(e){return e.P}),["assets/Printer.65619e84.js","assets/Printer.711b20ad.css","assets/View.ffaeb85b.js","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/TextField.8dd3b75b.js","assets/TextField.a9ee00f3.css","assets/Dialog.3e6e57b7.js","assets/Dialog.68b2fee9.css","assets/CheckBox.48ef8714.js","assets/CheckBox.82b15c7e.css","assets/FileSelect.2e073e96.js","assets/FileSelect.a3ea1f4f.css"]),ViewStart:()=>M(()=>import("./Start.b2f0d719.js"),["assets/Start.b2f0d719.js","assets/Start.7de09691.css","assets/View.ffaeb85b.js","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"]),ViewInfo:()=>M(()=>import("./Info.de5861ad.js"),["assets/Info.de5861ad.js","assets/Info.323bbd9f.css","assets/View.ffaeb85b.js","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"]),AppMenu:Gr,AppMenuItem:k,AppMenuText:ft,AppMenuSpacer:Et,AppMenuDivider:X,DialogError:()=>M(()=>import("./Error.5e4a00d6.js"),["assets/Error.5e4a00d6.js","assets/Error.d6470d93.css","assets/Dialog.3e6e57b7.js","assets/Dialog.68b2fee9.css","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"]),DialogRemote:()=>M(()=>import("./Remote.e2043463.js"),["assets/Remote.e2043463.js","assets/Remote.cb7e31b7.css","assets/TextField.8dd3b75b.js","assets/TextField.a9ee00f3.css","assets/Dialog.3e6e57b7.js","assets/Dialog.68b2fee9.css","assets/CheckBox.48ef8714.js","assets/CheckBox.82b15c7e.css","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"]),DialogServer:()=>M(()=>import("./Server.6912a29d.js"),["assets/Server.6912a29d.js","assets/Server.096116d4.css","assets/TextField.8dd3b75b.js","assets/TextField.a9ee00f3.css","assets/Dialog.3e6e57b7.js","assets/Dialog.68b2fee9.css","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/FileSelect.2e073e96.js","assets/FileSelect.a3ea1f4f.css","assets/CheckBox.48ef8714.js","assets/CheckBox.82b15c7e.css","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"]),DialogOptions:()=>M(()=>import("./Options.09d2110f.js"),["assets/Options.09d2110f.js","assets/Options.cdc76cd0.css","assets/TextField.8dd3b75b.js","assets/TextField.a9ee00f3.css","assets/Dialog.3e6e57b7.js","assets/Dialog.68b2fee9.css","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"]),DialogPrompt:()=>M(()=>import("./Prompt.b73e580a.js"),["assets/Prompt.b73e580a.js","assets/Prompt.dea47229.css","assets/Dialog.3e6e57b7.js","assets/Dialog.68b2fee9.css","assets/TextButton.3d91a0e8.js","assets/TextButton.62fd88c4.css","assets/vendor.b1428349.js","assets/devterm.a10f71a8.js"])},data(){return{VIEWS:Z,currentView:Z.PRINTER,ready:!1,fullscreen:!1,printerTemplate:In()}},computed:{headerItems(){const e=[{component:k,on:{click:this.onClickNew},props:{text:"New"}},{component:X},{component:k,on:{click:this.onClickSave},props:{text:"Save"}},{component:k,title:"Load",on:{click:this.onClickLoad},props:{text:"Load"}},{component:X}];return[...this.$client.connected&&[{component:k,on:{click:()=>this.currentView=Z.INFO},props:{selected:this.currentView===Z.INFO,text:"Info"}},{component:k,on:{click:()=>this.currentView=Z.PRINTER},props:{selected:this.currentView===Z.PRINTER,text:"Printer"}}]||[],{component:Et},...this.$client.connected&&this.currentView===Z.PRINTER&&e||[],{component:k,on:{click:this.onClickOptions},props:{text:"Options"}},U()&&[{component:X},{component:k,on:{click:this.onClickClose},props:{text:"Close"}}]].flat().filter(Boolean)},footerItems(){return[U()&&[{component:k,on:{click:this.onClickMinimizeWindow},props:{text:"Minimize"}},{component:k,on:{click:this.onClickMaximizeWindow},props:{text:"Maximize"}}].flat(),{component:k,on:{click:this.onClickFullscreen},props:{selected:this.fullscreen,text:"Fullscreen"}},{component:Et},this.hasServer&&[{component:ft,on:{click:this.showServerDialog},props:{class:{connection:!0,connected:this.$server.options.active},text:`${this.$server.options.active?`Server (*:${this.$server.options.port}${this.$server.options.secure?"/SSL":""})`:"Server Offline"}`}},{component:X}],{component:ft,on:{click:this.showRemoteDialog},props:{class:{connection:!0,connected:this.clientConnected},text:`${this.clientConnected?`Online (${this.$client.host}:${this.$client.port}${this.$client.secure?"/SSL":""})`:"Offline"}`}},{component:X},{component:ft,props:{class:"info-version",text:this.version}}].flat().filter(Boolean)},hasServer(){return!this.$server.disabled},version(){return this.$config.version},colors(){return vn[this.$config.data.theme]},clientConnected(){return this.$client.connected},style(){return D({"--color-primary":`rgb(${this.colors.primary.join(",")})`,"--color-secondary":`rgb(${this.colors.secondary.join(",")})`},Object.fromEntries(Array(10).fill("").map((e,n)=>[`--color-primary-${(n+1)*10}`,`rgb(${this.colors.primary.join(" ")} / ${(n+1)*10}%)`])))}},async mounted(){await Ur(),await this.$config.init(),await this.$server.init(),this.hasServer&&await this.$server.refresh(),await this.$config.load();const e=this.$config.get("profiles").find(({name:n})=>n===this.$config.get("profile"));if(e){const{port:n,host:i,ssl:s,secure:u}=e;if(this.$config.get("startType")&&n)try{this.$server&&this.$config.get("startType")==="local"&&!this.$server.options.active&&await this.$server.start(n,s),i&&await this.$client.connect(n,i,u)}catch{}}this.ready=!0,this.registerListeners()},methods:{registerListeners(){vr(e=>{this.fullscreen=e}),xr((e,n)=>{switch(e){case"open":switch(n){case"options":this.showOptionsDialog();break;case"remote":this.showRemoteDialog();break;case"server":this.showServerDialog();break}break}})},onClickMinimizeWindow(){return _r()},onClickMaximizeWindow(){return wr()},onClickFullscreen(){return mr(!this.fullscreen)},onClickClose(){return gr()},onClickNew(){this.printerTemplate=[]},onClickSave(){return br(this.printerTemplate)},async onClickLoad(){try{const e=await Er();e&&(this.printerTemplate=e)}catch(e){this.$errorList.add(e)}},onClickOptions(){this.showOptionsDialog()},async onApplyViewStart({type:e}){this.$config.set("startType",e);let n={};switch(e){case"local":n=await this.showServerDialog();break;case"remote":n=await this.showRemoteDialog();break}const{profile:i}=n||{};i&&(this.$config.set("profile",i),await this.$config.save())},showServerDialog(){return this.$refs.dialogServer.show()},showRemoteDialog(){return this.$refs.dialogRemote.show()},showOptionsDialog(){return this.$refs.dialogOptions.show()}}},ce={};var Bn=z(Sn,En,xn,!1,Cn,"c36f0386",null,null);function Cn(e){for(let n in ce)this[n]=ce[n]}var ue=function(){return Bn.exports}();class Fn{constructor(){this.errors=[]}add(n,i){typeof n=="object"&&(console.error(n),n.type&&(i=n.type),n=n.message);const s={title:i,message:n},u=()=>{this.errors.slice(this.errors.indexOf(s),1)};s.callback=u,this.errors.push(s)}}const ae=$.observable(new Fn);Object.defineProperty($.prototype,"$errorList",{get(){return ae}});const mi=512,pt=()=>({theme:"amber",startType:null,ssl:{key:null,cert:null,pfx:null,passphrase:null},profiles:[]}),An=()=>({name:null,port:3e3,host:null,secure:!1,ssl:{key:null,cert:null,pfx:null,passphrase:null}}),gi="localhost",Tn="Profile Default";class $n{constructor(){this.data=pt(),this.version=null}async init(){this.version=await Br()}toJSON(){return Object.assign({},this.data,{version:this.version})}get(n){return this.data[n]}set(n,i){typeof n=="string"?this.data[n]=i:typeof n=="object"&&Object.entries(n).forEach(([s,u])=>this.set(s,u))}save(){return Sr(this.toJSON())}reset(){return this.data=pt(),this.save()}async load(){let n;try{n=await Ir()}catch{n=pt()}return console.log(n),this.data=Object.assign(pt(),n)}saveProfile(n){n.name=n.name||Tn;const i=this.get("profiles");let s=this.get("profiles").find(({name:u})=>u===n.name);return s?(console.log("update profile",s.name,s),i[i.indexOf(s)]=D(D({},s),n)):(console.log("create profile",n.name,n),s=D(D({},An()),n),i.push(s)),this.set("profiles",i),this.save()}deleteProfile(n){const i=this.get("profiles"),s=this.get("profiles").find(({name:u})=>u===n);return i.slice(i.indexOf(s),1),this.set("profiles",i),this.save()}}const Rn=$.observable(new $n);Object.defineProperty($.prototype,"$config",{get(){return Rn}});Object.defineProperty($.prototype,"$server",{get(){return{init(){return Promise.resolve()},disabled:!0}}});var Un=384,{createCanvas:et,loadImage:bi,Canvas:Ei}=Me,kn=(e,n)=>(n=D({width:null,rotate:!1,flipX:!1,flipY:!1,grayscale:!1},n),n.rotate&&(e=Ln(e)),(n.flipX||n.flipY)&&(e=On(e,n.flipX,n.flipY)),e=Pn(e,n.width),n.grayscale&&(e=Dn(e)),e),Pn=(e,n)=>{n=Math.min(e.width,Math.min(n||e.width,Un));const i=n*(e.height/e.width),s=et(n,i);return s.getContext("2d").drawImage(e,0,0,n,i),s},On=(e,n,i)=>{const s=et(e.width,e.height),u=s.getContext("2d");console.log(1-n*2,1-i*2);const f=1-n*2,h=1-i*2;return u.translate(n*e.width,i*e.height),u.scale(f,h),u.drawImage(e,0,0,e.width,e.height),s},Ln=e=>{let n=e.getContext("2d");const i=et(e.height,e.width);return n=i.getContext("2d"),n.fillStyle="white",n.fillRect(0,0,e.height,e.width),n.translate(e.height,0),n.rotate(Math.PI/2),n.drawImage(e,0,0),i},Dn=e=>{const n=e.getContext("2d");return n.putImageData(je(n.getImageData(0,0,e.width,e.height)),0,0),e},Mn=(e,n)=>{const i=et();try{return Le(i,e,n),i}catch(s){throw new Error(s)}};async function jn(e,n={}){n=D({margin:0},n);const i=et(n.width||1,n.width||1);return new Promise(s=>{De.toCanvas(i,e,n,u=>{if(u)throw u;s(i)})})}var xt={},ht={};ht.byteLength=Hn;ht.toByteArray=zn;ht.fromByteArray=Yn;var L=[],T=[],Nn=typeof Uint8Array!="undefined"?Uint8Array:Array,vt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var q=0,Vn=vt.length;q<Vn;++q)L[q]=vt[q],T[vt.charCodeAt(q)]=q;T["-".charCodeAt(0)]=62;T["_".charCodeAt(0)]=63;function le(e){var n=e.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");i===-1&&(i=n);var s=i===n?0:4-i%4;return[i,s]}function Hn(e){var n=le(e),i=n[0],s=n[1];return(i+s)*3/4-s}function Wn(e,n,i){return(n+i)*3/4-i}function zn(e){var n,i=le(e),s=i[0],u=i[1],f=new Nn(Wn(e,s,u)),h=0,l=u>0?s-4:s,y;for(y=0;y<l;y+=4)n=T[e.charCodeAt(y)]<<18|T[e.charCodeAt(y+1)]<<12|T[e.charCodeAt(y+2)]<<6|T[e.charCodeAt(y+3)],f[h++]=n>>16&255,f[h++]=n>>8&255,f[h++]=n&255;return u===2&&(n=T[e.charCodeAt(y)]<<2|T[e.charCodeAt(y+1)]>>4,f[h++]=n&255),u===1&&(n=T[e.charCodeAt(y)]<<10|T[e.charCodeAt(y+1)]<<4|T[e.charCodeAt(y+2)]>>2,f[h++]=n>>8&255,f[h++]=n&255),f}function Zn(e){return L[e>>18&63]+L[e>>12&63]+L[e>>6&63]+L[e&63]}function Gn(e,n,i){for(var s,u=[],f=n;f<i;f+=3)s=(e[f]<<16&16711680)+(e[f+1]<<8&65280)+(e[f+2]&255),u.push(Zn(s));return u.join("")}function Yn(e){for(var n,i=e.length,s=i%3,u=[],f=16383,h=0,l=i-s;h<l;h+=f)u.push(Gn(e,h,h+f>l?l:h+f));return s===1?(n=e[i-1],u.push(L[n>>2]+L[n<<4&63]+"==")):s===2&&(n=(e[i-2]<<8)+e[i-1],u.push(L[n>>10]+L[n>>4&63]+L[n<<2&63]+"=")),u.join("")}var It={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */It.read=function(e,n,i,s,u){var f,h,l=u*8-s-1,y=(1<<l)-1,w=y>>1,g=-7,b=i?u-1:0,x=i?-1:1,F=e[n+b];for(b+=x,f=F&(1<<-g)-1,F>>=-g,g+=l;g>0;f=f*256+e[n+b],b+=x,g-=8);for(h=f&(1<<-g)-1,f>>=-g,g+=s;g>0;h=h*256+e[n+b],b+=x,g-=8);if(f===0)f=1-w;else{if(f===y)return h?NaN:(F?-1:1)*(1/0);h=h+Math.pow(2,s),f=f-w}return(F?-1:1)*h*Math.pow(2,f-s)};It.write=function(e,n,i,s,u,f){var h,l,y,w=f*8-u-1,g=(1<<w)-1,b=g>>1,x=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=s?0:f-1,j=s?1:-1,J=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(l=isNaN(n)?1:0,h=g):(h=Math.floor(Math.log(n)/Math.LN2),n*(y=Math.pow(2,-h))<1&&(h--,y*=2),h+b>=1?n+=x/y:n+=x*Math.pow(2,1-b),n*y>=2&&(h++,y/=2),h+b>=g?(l=0,h=g):h+b>=1?(l=(n*y-1)*Math.pow(2,u),h=h+b):(l=n*Math.pow(2,b-1)*Math.pow(2,u),h=0));u>=8;e[i+F]=l&255,F+=j,l/=256,u-=8);for(h=h<<u|l,w+=u;w>0;e[i+F]=h&255,F+=j,h/=256,w-=8);e[i+F-j]|=J*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const n=ht,i=It,s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=l,e.SlowBuffer=de,e.INSPECT_MAX_BYTES=50;const u=2147483647;e.kMaxLength=u,l.TYPED_ARRAY_SUPPORT=f(),!l.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const o=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(o,t),o.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(!!l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(!!l.isBuffer(this))return this.byteOffset}});function h(o){if(o>u)throw new RangeError('The value "'+o+'" is invalid for option "size"');const t=new Uint8Array(o);return Object.setPrototypeOf(t,l.prototype),t}function l(o,t,r){if(typeof o=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(o)}return y(o,t,r)}l.poolSize=8192;function y(o,t,r){if(typeof o=="string")return x(o,t);if(ArrayBuffer.isView(o))return j(o);if(o==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(P(o,ArrayBuffer)||o&&P(o.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(P(o,SharedArrayBuffer)||o&&P(o.buffer,SharedArrayBuffer)))return J(o,t,r);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const c=o.valueOf&&o.valueOf();if(c!=null&&c!==o)return l.from(c,t,r);const a=he(o);if(a)return a;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return l.from(o[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}l.from=function(o,t,r){return y(o,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function w(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function g(o,t,r){return w(o),o<=0?h(o):t!==void 0?typeof r=="string"?h(o).fill(t,r):h(o).fill(t):h(o)}l.alloc=function(o,t,r){return g(o,t,r)};function b(o){return w(o),h(o<0?0:dt(o)|0)}l.allocUnsafe=function(o){return b(o)},l.allocUnsafeSlow=function(o){return b(o)};function x(o,t){if((typeof t!="string"||t==="")&&(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=Ct(o,t)|0;let c=h(r);const a=c.write(o,t);return a!==r&&(c=c.slice(0,a)),c}function F(o){const t=o.length<0?0:dt(o.length)|0,r=h(t);for(let c=0;c<t;c+=1)r[c]=o[c]&255;return r}function j(o){if(P(o,Uint8Array)){const t=new Uint8Array(o);return J(t.buffer,t.byteOffset,t.byteLength)}return F(o)}function J(o,t,r){if(t<0||o.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let c;return t===void 0&&r===void 0?c=new Uint8Array(o):r===void 0?c=new Uint8Array(o,t):c=new Uint8Array(o,t,r),Object.setPrototypeOf(c,l.prototype),c}function he(o){if(l.isBuffer(o)){const t=dt(o.length)|0,r=h(t);return r.length===0||o.copy(r,0,0,t),r}if(o.length!==void 0)return typeof o.length!="number"||wt(o.length)?h(0):F(o);if(o.type==="Buffer"&&Array.isArray(o.data))return F(o.data)}function dt(o){if(o>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return o|0}function de(o){return+o!=o&&(o=0),l.alloc(+o)}l.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==l.prototype},l.compare=function(t,r){if(P(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),P(r,Uint8Array)&&(r=l.from(r,r.offset,r.byteLength)),!l.isBuffer(t)||!l.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;let c=t.length,a=r.length;for(let p=0,d=Math.min(c,a);p<d;++p)if(t[p]!==r[p]){c=t[p],a=r[p];break}return c<a?-1:a<c?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return l.alloc(0);let c;if(r===void 0)for(r=0,c=0;c<t.length;++c)r+=t[c].length;const a=l.allocUnsafe(r);let p=0;for(c=0;c<t.length;++c){let d=t[c];if(P(d,Uint8Array))p+d.length>a.length?(l.isBuffer(d)||(d=l.from(d)),d.copy(a,p)):Uint8Array.prototype.set.call(a,d,p);else if(l.isBuffer(d))d.copy(a,p);else throw new TypeError('"list" argument must be an Array of Buffers');p+=d.length}return a};function Ct(o,t){if(l.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||P(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);const r=o.length,c=arguments.length>2&&arguments[2]===!0;if(!c&&r===0)return 0;let a=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return _t(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Mt(o).length;default:if(a)return c?-1:_t(o).length;t=(""+t).toLowerCase(),a=!0}}l.byteLength=Ct;function ye(o,t,r){let c=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,t>>>=0,r<=t))return"";for(o||(o="utf8");;)switch(o){case"hex":return Se(this,t,r);case"utf8":case"utf-8":return Tt(this,t,r);case"ascii":return ve(this,t,r);case"latin1":case"binary":return Ie(this,t,r);case"base64":return Ee(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,t,r);default:if(c)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),c=!0}}l.prototype._isBuffer=!0;function H(o,t,r){const c=o[t];o[t]=o[r],o[r]=c}l.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<t;r+=2)H(this,r,r+1);return this},l.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<t;r+=4)H(this,r,r+3),H(this,r+1,r+2);return this},l.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<t;r+=8)H(this,r,r+7),H(this,r+1,r+6),H(this,r+2,r+5),H(this,r+3,r+4);return this},l.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?Tt(this,0,t):ye.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:l.compare(this,t)===0},l.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(t,r,c,a,p){if(P(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(r===void 0&&(r=0),c===void 0&&(c=t?t.length:0),a===void 0&&(a=0),p===void 0&&(p=this.length),r<0||c>t.length||a<0||p>this.length)throw new RangeError("out of range index");if(a>=p&&r>=c)return 0;if(a>=p)return-1;if(r>=c)return 1;if(r>>>=0,c>>>=0,a>>>=0,p>>>=0,this===t)return 0;let d=p-a,_=c-r;const v=Math.min(d,_),E=this.slice(a,p),I=t.slice(r,c);for(let m=0;m<v;++m)if(E[m]!==I[m]){d=E[m],_=I[m];break}return d<_?-1:_<d?1:0};function Ft(o,t,r,c,a){if(o.length===0)return-1;if(typeof r=="string"?(c=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,wt(r)&&(r=a?0:o.length-1),r<0&&(r=o.length+r),r>=o.length){if(a)return-1;r=o.length-1}else if(r<0)if(a)r=0;else return-1;if(typeof t=="string"&&(t=l.from(t,c)),l.isBuffer(t))return t.length===0?-1:At(o,t,r,c,a);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?a?Uint8Array.prototype.indexOf.call(o,t,r):Uint8Array.prototype.lastIndexOf.call(o,t,r):At(o,[t],r,c,a);throw new TypeError("val must be string, number or Buffer")}function At(o,t,r,c,a){let p=1,d=o.length,_=t.length;if(c!==void 0&&(c=String(c).toLowerCase(),c==="ucs2"||c==="ucs-2"||c==="utf16le"||c==="utf-16le")){if(o.length<2||t.length<2)return-1;p=2,d/=2,_/=2,r/=2}function v(I,m){return p===1?I[m]:I.readUInt16BE(m*p)}let E;if(a){let I=-1;for(E=r;E<d;E++)if(v(o,E)===v(t,I===-1?0:E-I)){if(I===-1&&(I=E),E-I+1===_)return I*p}else I!==-1&&(E-=E-I),I=-1}else for(r+_>d&&(r=d-_),E=r;E>=0;E--){let I=!0;for(let m=0;m<_;m++)if(v(o,E+m)!==v(t,m)){I=!1;break}if(I)return E}return-1}l.prototype.includes=function(t,r,c){return this.indexOf(t,r,c)!==-1},l.prototype.indexOf=function(t,r,c){return Ft(this,t,r,c,!0)},l.prototype.lastIndexOf=function(t,r,c){return Ft(this,t,r,c,!1)};function _e(o,t,r,c){r=Number(r)||0;const a=o.length-r;c?(c=Number(c),c>a&&(c=a)):c=a;const p=t.length;c>p/2&&(c=p/2);let d;for(d=0;d<c;++d){const _=parseInt(t.substr(d*2,2),16);if(wt(_))return d;o[r+d]=_}return d}function we(o,t,r,c){return rt(_t(t,o.length-r),o,r,c)}function me(o,t,r,c){return rt(Te(t),o,r,c)}function ge(o,t,r,c){return rt(Mt(t),o,r,c)}function be(o,t,r,c){return rt($e(t,o.length-r),o,r,c)}l.prototype.write=function(t,r,c,a){if(r===void 0)a="utf8",c=this.length,r=0;else if(c===void 0&&typeof r=="string")a=r,c=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(c)?(c=c>>>0,a===void 0&&(a="utf8")):(a=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const p=this.length-r;if((c===void 0||c>p)&&(c=p),t.length>0&&(c<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let d=!1;for(;;)switch(a){case"hex":return _e(this,t,r,c);case"utf8":case"utf-8":return we(this,t,r,c);case"ascii":case"latin1":case"binary":return me(this,t,r,c);case"base64":return ge(this,t,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return be(this,t,r,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),d=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ee(o,t,r){return t===0&&r===o.length?n.fromByteArray(o):n.fromByteArray(o.slice(t,r))}function Tt(o,t,r){r=Math.min(o.length,r);const c=[];let a=t;for(;a<r;){const p=o[a];let d=null,_=p>239?4:p>223?3:p>191?2:1;if(a+_<=r){let v,E,I,m;switch(_){case 1:p<128&&(d=p);break;case 2:v=o[a+1],(v&192)==128&&(m=(p&31)<<6|v&63,m>127&&(d=m));break;case 3:v=o[a+1],E=o[a+2],(v&192)==128&&(E&192)==128&&(m=(p&15)<<12|(v&63)<<6|E&63,m>2047&&(m<55296||m>57343)&&(d=m));break;case 4:v=o[a+1],E=o[a+2],I=o[a+3],(v&192)==128&&(E&192)==128&&(I&192)==128&&(m=(p&15)<<18|(v&63)<<12|(E&63)<<6|I&63,m>65535&&m<1114112&&(d=m))}}d===null?(d=65533,_=1):d>65535&&(d-=65536,c.push(d>>>10&1023|55296),d=56320|d&1023),c.push(d),a+=_}return xe(c)}const $t=4096;function xe(o){const t=o.length;if(t<=$t)return String.fromCharCode.apply(String,o);let r="",c=0;for(;c<t;)r+=String.fromCharCode.apply(String,o.slice(c,c+=$t));return r}function ve(o,t,r){let c="";r=Math.min(o.length,r);for(let a=t;a<r;++a)c+=String.fromCharCode(o[a]&127);return c}function Ie(o,t,r){let c="";r=Math.min(o.length,r);for(let a=t;a<r;++a)c+=String.fromCharCode(o[a]);return c}function Se(o,t,r){const c=o.length;(!t||t<0)&&(t=0),(!r||r<0||r>c)&&(r=c);let a="";for(let p=t;p<r;++p)a+=Re[o[p]];return a}function Be(o,t,r){const c=o.slice(t,r);let a="";for(let p=0;p<c.length-1;p+=2)a+=String.fromCharCode(c[p]+c[p+1]*256);return a}l.prototype.slice=function(t,r){const c=this.length;t=~~t,r=r===void 0?c:~~r,t<0?(t+=c,t<0&&(t=0)):t>c&&(t=c),r<0?(r+=c,r<0&&(r=0)):r>c&&(r=c),r<t&&(r=t);const a=this.subarray(t,r);return Object.setPrototypeOf(a,l.prototype),a};function S(o,t,r){if(o%1!=0||o<0)throw new RangeError("offset is not uint");if(o+t>r)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(t,r,c){t=t>>>0,r=r>>>0,c||S(t,r,this.length);let a=this[t],p=1,d=0;for(;++d<r&&(p*=256);)a+=this[t+d]*p;return a},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,r,c){t=t>>>0,r=r>>>0,c||S(t,r,this.length);let a=this[t+--r],p=1;for(;r>0&&(p*=256);)a+=this[t+--r]*p;return a},l.prototype.readUint8=l.prototype.readUInt8=function(t,r){return t=t>>>0,r||S(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,r){return t=t>>>0,r||S(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,r){return t=t>>>0,r||S(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,r){return t=t>>>0,r||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,r){return t=t>>>0,r||S(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=N(function(t){t=t>>>0,Y(t,"offset");const r=this[t],c=this[t+7];(r===void 0||c===void 0)&&Q(t,this.length-8);const a=r+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,p=this[++t]+this[++t]*2**8+this[++t]*2**16+c*2**24;return BigInt(a)+(BigInt(p)<<BigInt(32))}),l.prototype.readBigUInt64BE=N(function(t){t=t>>>0,Y(t,"offset");const r=this[t],c=this[t+7];(r===void 0||c===void 0)&&Q(t,this.length-8);const a=r*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],p=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+c;return(BigInt(a)<<BigInt(32))+BigInt(p)}),l.prototype.readIntLE=function(t,r,c){t=t>>>0,r=r>>>0,c||S(t,r,this.length);let a=this[t],p=1,d=0;for(;++d<r&&(p*=256);)a+=this[t+d]*p;return p*=128,a>=p&&(a-=Math.pow(2,8*r)),a},l.prototype.readIntBE=function(t,r,c){t=t>>>0,r=r>>>0,c||S(t,r,this.length);let a=r,p=1,d=this[t+--a];for(;a>0&&(p*=256);)d+=this[t+--a]*p;return p*=128,d>=p&&(d-=Math.pow(2,8*r)),d},l.prototype.readInt8=function(t,r){return t=t>>>0,r||S(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},l.prototype.readInt16LE=function(t,r){t=t>>>0,r||S(t,2,this.length);const c=this[t]|this[t+1]<<8;return c&32768?c|4294901760:c},l.prototype.readInt16BE=function(t,r){t=t>>>0,r||S(t,2,this.length);const c=this[t+1]|this[t]<<8;return c&32768?c|4294901760:c},l.prototype.readInt32LE=function(t,r){return t=t>>>0,r||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,r){return t=t>>>0,r||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=N(function(t){t=t>>>0,Y(t,"offset");const r=this[t],c=this[t+7];(r===void 0||c===void 0)&&Q(t,this.length-8);const a=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(c<<24);return(BigInt(a)<<BigInt(32))+BigInt(r+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),l.prototype.readBigInt64BE=N(function(t){t=t>>>0,Y(t,"offset");const r=this[t],c=this[t+7];(r===void 0||c===void 0)&&Q(t,this.length-8);const a=(r<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(a)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+c)}),l.prototype.readFloatLE=function(t,r){return t=t>>>0,r||S(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,r){return t=t>>>0,r||S(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,r){return t=t>>>0,r||S(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,r){return t=t>>>0,r||S(t,8,this.length),i.read(this,t,!1,52,8)};function A(o,t,r,c,a,p){if(!l.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<p)throw new RangeError('"value" argument is out of bounds');if(r+c>o.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,r,c,a){if(t=+t,r=r>>>0,c=c>>>0,!a){const _=Math.pow(2,8*c)-1;A(this,t,r,c,_,0)}let p=1,d=0;for(this[r]=t&255;++d<c&&(p*=256);)this[r+d]=t/p&255;return r+c},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,r,c,a){if(t=+t,r=r>>>0,c=c>>>0,!a){const _=Math.pow(2,8*c)-1;A(this,t,r,c,_,0)}let p=c-1,d=1;for(this[r+p]=t&255;--p>=0&&(d*=256);)this[r+p]=t/d&255;return r+c},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,1,255,0),this[r]=t&255,r+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,2,65535,0),this[r]=t&255,this[r+1]=t>>>8,r+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,2,65535,0),this[r]=t>>>8,this[r+1]=t&255,r+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,4,4294967295,0),this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=t&255,r+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,4,4294967295,0),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255,r+4};function Rt(o,t,r,c,a){Dt(t,c,a,o,r,7);let p=Number(t&BigInt(4294967295));o[r++]=p,p=p>>8,o[r++]=p,p=p>>8,o[r++]=p,p=p>>8,o[r++]=p;let d=Number(t>>BigInt(32)&BigInt(4294967295));return o[r++]=d,d=d>>8,o[r++]=d,d=d>>8,o[r++]=d,d=d>>8,o[r++]=d,r}function Ut(o,t,r,c,a){Dt(t,c,a,o,r,7);let p=Number(t&BigInt(4294967295));o[r+7]=p,p=p>>8,o[r+6]=p,p=p>>8,o[r+5]=p,p=p>>8,o[r+4]=p;let d=Number(t>>BigInt(32)&BigInt(4294967295));return o[r+3]=d,d=d>>8,o[r+2]=d,d=d>>8,o[r+1]=d,d=d>>8,o[r]=d,r+8}l.prototype.writeBigUInt64LE=N(function(t,r=0){return Rt(this,t,r,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=N(function(t,r=0){return Ut(this,t,r,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(t,r,c,a){if(t=+t,r=r>>>0,!a){const v=Math.pow(2,8*c-1);A(this,t,r,c,v-1,-v)}let p=0,d=1,_=0;for(this[r]=t&255;++p<c&&(d*=256);)t<0&&_===0&&this[r+p-1]!==0&&(_=1),this[r+p]=(t/d>>0)-_&255;return r+c},l.prototype.writeIntBE=function(t,r,c,a){if(t=+t,r=r>>>0,!a){const v=Math.pow(2,8*c-1);A(this,t,r,c,v-1,-v)}let p=c-1,d=1,_=0;for(this[r+p]=t&255;--p>=0&&(d*=256);)t<0&&_===0&&this[r+p+1]!==0&&(_=1),this[r+p]=(t/d>>0)-_&255;return r+c},l.prototype.writeInt8=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,1,127,-128),t<0&&(t=255+t+1),this[r]=t&255,r+1},l.prototype.writeInt16LE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,2,32767,-32768),this[r]=t&255,this[r+1]=t>>>8,r+2},l.prototype.writeInt16BE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,2,32767,-32768),this[r]=t>>>8,this[r+1]=t&255,r+2},l.prototype.writeInt32LE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,4,2147483647,-2147483648),this[r]=t&255,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24,r+4},l.prototype.writeInt32BE=function(t,r,c){return t=+t,r=r>>>0,c||A(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255,r+4},l.prototype.writeBigInt64LE=N(function(t,r=0){return Rt(this,t,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=N(function(t,r=0){return Ut(this,t,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function kt(o,t,r,c,a,p){if(r+c>o.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Pt(o,t,r,c,a){return t=+t,r=r>>>0,a||kt(o,t,r,4),i.write(o,t,r,c,23,4),r+4}l.prototype.writeFloatLE=function(t,r,c){return Pt(this,t,r,!0,c)},l.prototype.writeFloatBE=function(t,r,c){return Pt(this,t,r,!1,c)};function Ot(o,t,r,c,a){return t=+t,r=r>>>0,a||kt(o,t,r,8),i.write(o,t,r,c,52,8),r+8}l.prototype.writeDoubleLE=function(t,r,c){return Ot(this,t,r,!0,c)},l.prototype.writeDoubleBE=function(t,r,c){return Ot(this,t,r,!1,c)},l.prototype.copy=function(t,r,c,a){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(c||(c=0),!a&&a!==0&&(a=this.length),r>=t.length&&(r=t.length),r||(r=0),a>0&&a<c&&(a=c),a===c||t.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),t.length-r<a-c&&(a=t.length-r+c);const p=a-c;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,c,a):Uint8Array.prototype.set.call(t,this.subarray(c,a),r),p},l.prototype.fill=function(t,r,c,a){if(typeof t=="string"){if(typeof r=="string"?(a=r,r=0,c=this.length):typeof c=="string"&&(a=c,c=this.length),a!==void 0&&typeof a!="string")throw new TypeError("encoding must be a string");if(typeof a=="string"&&!l.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(t.length===1){const d=t.charCodeAt(0);(a==="utf8"&&d<128||a==="latin1")&&(t=d)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(r<0||this.length<r||this.length<c)throw new RangeError("Out of range index");if(c<=r)return this;r=r>>>0,c=c===void 0?this.length:c>>>0,t||(t=0);let p;if(typeof t=="number")for(p=r;p<c;++p)this[p]=t;else{const d=l.isBuffer(t)?t:l.from(t,a),_=d.length;if(_===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(p=0;p<c-r;++p)this[p+r]=d[p%_]}return this};const G={};function yt(o,t,r){G[o]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${o}]`,this.stack,delete this.name}get code(){return o}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${o}]: ${this.message}`}}}yt("ERR_BUFFER_OUT_OF_BOUNDS",function(o){return o?`${o} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),yt("ERR_INVALID_ARG_TYPE",function(o,t){return`The "${o}" argument must be of type number. Received type ${typeof t}`},TypeError),yt("ERR_OUT_OF_RANGE",function(o,t,r){let c=`The value of "${o}" is out of range.`,a=r;return Number.isInteger(r)&&Math.abs(r)>2**32?a=Lt(String(r)):typeof r=="bigint"&&(a=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(a=Lt(a)),a+="n"),c+=` It must be ${t}. Received ${a}`,c},RangeError);function Lt(o){let t="",r=o.length;const c=o[0]==="-"?1:0;for(;r>=c+4;r-=3)t=`_${o.slice(r-3,r)}${t}`;return`${o.slice(0,r)}${t}`}function Ce(o,t,r){Y(t,"offset"),(o[t]===void 0||o[t+r]===void 0)&&Q(t,o.length-(r+1))}function Dt(o,t,r,c,a,p){if(o>r||o<t){const d=typeof t=="bigint"?"n":"";let _;throw p>3?t===0||t===BigInt(0)?_=`>= 0${d} and < 2${d} ** ${(p+1)*8}${d}`:_=`>= -(2${d} ** ${(p+1)*8-1}${d}) and < 2 ** ${(p+1)*8-1}${d}`:_=`>= ${t}${d} and <= ${r}${d}`,new G.ERR_OUT_OF_RANGE("value",_,o)}Ce(c,a,p)}function Y(o,t){if(typeof o!="number")throw new G.ERR_INVALID_ARG_TYPE(t,"number",o)}function Q(o,t,r){throw Math.floor(o)!==o?(Y(o,r),new G.ERR_OUT_OF_RANGE(r||"offset","an integer",o)):t<0?new G.ERR_BUFFER_OUT_OF_BOUNDS:new G.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,o)}const Fe=/[^+/0-9A-Za-z-_]/g;function Ae(o){if(o=o.split("=")[0],o=o.trim().replace(Fe,""),o.length<2)return"";for(;o.length%4!=0;)o=o+"=";return o}function _t(o,t){t=t||1/0;let r;const c=o.length;let a=null;const p=[];for(let d=0;d<c;++d){if(r=o.charCodeAt(d),r>55295&&r<57344){if(!a){if(r>56319){(t-=3)>-1&&p.push(239,191,189);continue}else if(d+1===c){(t-=3)>-1&&p.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&p.push(239,191,189),a=r;continue}r=(a-55296<<10|r-56320)+65536}else a&&(t-=3)>-1&&p.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;p.push(r)}else if(r<2048){if((t-=2)<0)break;p.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;p.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;p.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return p}function Te(o){const t=[];for(let r=0;r<o.length;++r)t.push(o.charCodeAt(r)&255);return t}function $e(o,t){let r,c,a;const p=[];for(let d=0;d<o.length&&!((t-=2)<0);++d)r=o.charCodeAt(d),c=r>>8,a=r%256,p.push(a),p.push(c);return p}function Mt(o){return n.toByteArray(Ae(o))}function rt(o,t,r,c){let a;for(a=0;a<c&&!(a+r>=t.length||a>=o.length);++a)t[a+r]=o[a];return a}function P(o,t){return o instanceof t||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===t.name}function wt(o){return o!==o}const Re=function(){const o="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const c=r*16;for(let a=0;a<16;++a)t[c+a]=o[r]+o[a]}return t}();function N(o){return typeof BigInt=="undefined"?Ue:o}function Ue(){throw new Error("BigInt not supported")}})(xt);var Xn=9224,fe=(e,n)=>{const i=e/8%256,s=e/8/256,u=n%256,f=n/256,h=(i+256*s)*(u+256*f);return{xL:i,xH:s,yL:u,yH:f,k:h}},qn=(e,n)=>{const{k:i}=fe(e,1),s=Xn/i;return Math.ceil(n/s)},Jn=e=>{const n=e.getContext("2d"),i=qn(e.width,e.height),s=[];for(let u=0;u<i;u++)s.push(n.getImageData(0,e.height/i*u,e.width,e.height/i));return s};function Qn(e){const n=(s,u)=>{const f=(u*e.width+s)*4,h=e.data;return{r:h[f],g:h[f+1],b:h[f+2],a:h[f+3]}},i=[];for(let s=0;s<e.height;s++){i[s]=i[s]||[];for(let u=0;u<e.width;u++)i[s][u]=n(u,s)}return i}var Kn=e=>{const n=[],{width:i,height:s}=e,u=Qn(e);for(let f=0;f<s;f++){n[f]=new Uint8Array(Math.round(i/8));for(let h=0;h<n[f].length;h++){n[f][h]=0;for(let l=0;l<8;l++){const{r:y,g:w,b:g,a:b}=u[f][h*8+l]||{r:255,g:255,b:255,a:255};((y+w+g)/3/255<.6||b<.6)&&(n[f][h]|=1<<7-l)}}}return n};const vi=e=>{const n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0),console.log("update Canvas",n),n.toDataURL("image/png",100)},ti=(e,n,i)=>{if(n){if(e.width<=n)return e;i=n*(e.height/e.width)}else{if(e.height<=i)return e;n=i*(e.width/e.height)}const s=new OffscreenCanvas(n,i);return s.getContext("2d").drawImage(e,0,0,n,i),s},ei=async e=>{const n=new window.Image;await new Promise(u=>{n.onload=()=>u(n),n.src=e,n.crossOrigin="anonymous"});const i=new OffscreenCanvas(n.naturalWidth,n.naturalHeight);return i.getContext("2d").drawImage(n,0,0),i},Ii=(e,n)=>{e=ti(e,Fr);const i=e.getContext("2d"),s=i.getImageData(0,0,i.canvas.width,i.canvas.height);return ri(s.data,[n.printer.preview.foreground,n.printer.preview.background]),i.putImageData(s,0,0),e},ri=(e,n)=>{for(let i=0;i<e.length;i+=4)(e[i]+e[i+1]+e[i+2])/3/255<.6?(e[i]=n[0][0],e[i+1]=n[0][1],e[i+2]=n[0][2]):(e[i]=n[1][0],e[i+1]=n[1][1],e[i+2]=n[1][2])},ni=async e=>(await Jn(e)).map(s=>[xt.Buffer.from(ii(s.width,s.height))].concat(Kn(s).map(u=>oi(u)))).flat(),ii=(e,n)=>{const{xL:i,xH:s,yL:u,yH:f,k:h}=fe(e,n),l=[te,118,48,0,i,s,u,f];if(l[0]===te&&l[1]===118&&l[2]===48&&!(h<=Kt))throw new Error(`Image too large; ${h} > ${Kt}`);return l},oi=function(e){const n=xt.Buffer.alloc(e.byteLength),i=new Uint8Array(e);for(let s=0;s<n.length;++s)n[s]=i[s];return n},St=(e,n)=>(e=kn(e,n),ni(e));var pe={cutLine:{display:()=>({title:"Cut Line"})},barcode:{display:e=>({title:"Barcode",value:e.text}),beforePrinterCommand:async e=>{const{text:n,options:i,imageOptions:s}=e.value,u=await Mn(n||"empty",i||{});return e.value=await St(u,s),e}},qrCode:{display:e=>({title:"QR Code",value:e.text}),beforePrinterCommand:async e=>{const{text:n,options:i,imageOptions:s}=e.value,u=D({},i);u.width=i.width||s.width;const f=await jn(n||"empty",u);return e.value=await St(f,s),e}},image:{display:()=>({title:"Image"}),beforePrinterCommand:async e=>{const{file:n,imageOptions:i}=e.value;return e.value=await St(await ei(n),i),e}},text:{display:e=>({title:"Text",value:`${e.slice(0,16)}\u2026`})},feedPitch:{display:({type:e,value:n})=>({title:"Feed-Pitch",value:`${e} | ${n}`})},reset:{display:e=>({property:!0,title:"Reset"})},setAlign:{display:e=>({property:!0,title:"Align",value:`${Object.entries(at).find(n=>n[1]===e)[0]}`})},setFont:{display:e=>({property:!0,title:"Font",value:Object.entries(B).find(n=>Number(e)===n[1])[0]})},setLineSpace:{display:e=>({property:!0,title:"Line-Space",value:e})},setWordGap:{display:e=>({property:!0,title:"Word-Gap",value:e})},setMargin:{display:e=>({property:!0,title:"Margin",value:e})},setDensity:{display:e=>({property:!0,title:"Density",value:e})}};class si extends Ne{constructor(){super();this.socket=null,this.connected=!1}async connect(n=3e3,i="localhost",s=!1){const u=s?"wss":"ws";this.io=await this.ready();const f=this.io(`${u}://${i}:${n}`,{autoConnect:!1,reconnection:!1,secure:s,transports:["websocket"]});this.socket=await new Promise((h,l)=>{f.on("error",y=>{this.emit("error",y)}),f.on("connect_error",y=>{this.emit("error",y),l(y)}),f.on("connect",()=>{this.connected=f.connected,this.emit("connect"),h(f)}),f.on("disconnect",()=>{this.disconnect(),this.emit("disconnect")}),f.connect()})}async ready(){if(this.io)return this.io;const{io:n}=await M(()=>import("./index.c6f0c553.js"),[]);return this.io=n,n}get host(){var n,i,s;return(s=(i=(n=this.socket)==null?void 0:n.io)==null?void 0:i.opts)==null?void 0:s.hostname}get port(){var n,i,s,u,f,h;return((s=(i=(n=this.socket)==null?void 0:n.io)==null?void 0:i.opts)==null?void 0:s.port)&&Number((h=(f=(u=this.socket)==null?void 0:u.io)==null?void 0:f.opts)==null?void 0:h.port)||void 0}get secure(){var n,i,s;return(s=(i=(n=this.socket)==null?void 0:n.io)==null?void 0:i.opts)==null?void 0:s.secure}promiseEmit(n,i){return new Promise(s=>{this.socket.emit(n,i,s)})}disconnect(){var n;(n=this.socket)==null||n.destroy(),this.socket=null,this.connected=!1}async getInfo(){const n=await this.promiseEmit("getInfo");return console.log("getInfo",n),n}async executeActions(n){n=await Promise.all(n.map(async s=>"beforePrinterCommand"in pe[s.type]?await pe[s.type].beforePrinterCommand(Object.assign({},s)):s));const i=await this.promiseEmit("executeActions",n);console.log("executeActions",i)}}const Bt=$.observable(new si);yr(Bt);Bt.on("error",e=>{ae.add(e)});Object.defineProperty($.prototype,"$client",{get(){return Bt}});class ci{constructor(){this.prompts=[]}prompt(n,i){return new Promise(s=>{const u={title:i,message:n},f=h=>{this.prompts.slice(this.prompts.indexOf(u),1),s(h)};u.callback=f,this.prompts.push(u)})}}const ui=$.observable(new ci);Object.defineProperty($.prototype,"$dialog",{get(){return ui}});$.component("App",ue);new $({render:e=>e(ue)}).$mount("#app");export{at as A,Kr as B,Cr as D,B as F,mi as M,V as S,M as _,Ii as a,_i as b,di as c,jr as d,pe as e,ut as f,ei as g,O as h,Tn as i,An as j,pi as k,gi as l,pt as m,z as n,wi as o,kn as p,hi as q,ti as r,dr as s,vi as t,Mn as u,jn as v,et as w,yi as x};
