var Rt=Object.defineProperty,Lt=Object.defineProperties;var Dt=Object.getOwnPropertyDescriptors;var Ge=Object.getOwnPropertySymbols;var Ft=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var Ve=(e,t,r)=>t in e?Rt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))Ft.call(t,r)&&Ve(e,r,t[r]);if(Ge)for(var r of Ge(t))jt.call(t,r)&&Ve(e,r,t[r]);return e},B=(e,t)=>Lt(e,Dt(t));var ze=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var D=(e,t,r)=>(ze(e,t,"read from private field"),r?r.call(e):t.get(e)),ae=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},le=(e,t,r,n)=>(ze(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{V as A}from"./vendor.b1428349.js";import{f as Nt,J as Mt,b as Gt,a as Vt,E as zt}from"./devterm.9e5b33a4.js";import{c as He}from"./canvas-text-wrapper.5613b40d.js";import{b as We}from"./buffer.4460b8ba.js";const Ht=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};Ht();const Wt="modulepreload",Be={},Bt="/",E=function(t,r){return!r||r.length===0?t():Promise.all(r.map(n=>{if(n=`${Bt}${n}`,n in Be)return;Be[n]=!0;const o=n.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const s=document.createElement("link");if(s.rel=o?"stylesheet":Wt,o||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),o)return new Promise((a,l)=>{s.addEventListener("load",a),s.addEventListener("error",l)})})).then(()=>t())};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Se=function(e,t){return Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},Se(e,t)};function te(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Se(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Zt(e,t,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(f){try{c(n.next(f))}catch(g){s(g)}}function l(f){try{c(n.throw(f))}catch(g){s(g)}}function c(f){f.done?i(f.value):o(f.value).then(a,l)}c((n=n.apply(e,t||[])).next())})}function Ze(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(f){return l([c,f])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(f){c=[6,f],o=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Z(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function U(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function q(e){return this instanceof q?(this.v=e,this):new q(e)}function Ut(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(u){n[u]&&(o[u]=function(m){return new Promise(function(h,p){i.push([u,m,h,p])>1||a(u,m)})})}function a(u,m){try{l(n[u](m))}catch(h){g(i[0][3],h)}}function l(u){u.value instanceof q?Promise.resolve(u.value.v).then(c,f):g(i[0][2],u)}function c(u){a("next",u)}function f(u){a("throw",u)}function g(u,m){u(m),i.shift(),i.length&&a(i[0][0],i[0][1])}}function qt(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Z=="function"?Z(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(s){return new Promise(function(a,l){s=e[i](s),o(a,l,s.done,s.value)})}}function o(i,s,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},s)}}function S(e){return typeof e=="function"}function Ue(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var xe=Ue(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function Ee(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var ce=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return e.prototype.unsubscribe=function(){var t,r,n,o,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Z(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(p){t={error:p}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}else s.remove(this);var f=this.initialTeardown;if(S(f))try{f()}catch(p){i=p instanceof xe?p.errors:[p]}var g=this._teardowns;if(g){this._teardowns=null;try{for(var u=Z(g),m=u.next();!m.done;m=u.next()){var h=m.value;try{Ye(h)}catch(p){i=i!=null?i:[],p instanceof xe?i=U(U([],M(i)),M(p.errors)):i.push(p)}}}catch(p){n={error:p}}finally{try{m&&!m.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}if(i)throw new xe(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Ye(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=(r=this._teardowns)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&Ee(r,t)},e.prototype.remove=function(t){var r=this._teardowns;r&&Ee(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),qe=ce.EMPTY;function Xe(e){return e instanceof ce||e&&"closed"in e&&S(e.remove)&&S(e.add)&&S(e.unsubscribe)}function Ye(e){S(e)?e():e.unsubscribe()}var ue={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},fe={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=fe.delegate;return((r==null?void 0:r.setTimeout)||setTimeout).apply(void 0,U([],M(e)))},clearTimeout:function(e){var t=fe.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Je(e){fe.setTimeout(function(){throw e})}function pe(){}var Xt=function(){return Ie("C",void 0,void 0)}();function Yt(e){return Ie("E",void 0,e)}function Jt(e){return Ie("N",e,void 0)}function Ie(e,t,r){return{kind:e,value:t,error:r}}var de=null;function ve(e){if(ue.useDeprecatedSynchronousErrorHandling){var t=!de;if(t&&(de={errorThrown:!1,error:null}),e(),t){var r=de,n=r.errorThrown,o=r.error;if(de=null,n)throw o}}else e()}var Oe=function(e){te(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,Xe(r)&&r.add(n)):n.destination=Qt,n}return t.create=function(r,n,o){return new he(r,n,o)},t.prototype.next=function(r){this.isStopped?Te(Jt(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?Te(Yt(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?Te(Xt,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ce),he=function(e){te(t,e);function t(r,n,o){var i=e.call(this)||this,s;if(S(r))s=r;else if(r){s=r.next,n=r.error,o=r.complete;var a;i&&ue.useDeprecatedNextContext?(a=Object.create(r),a.unsubscribe=function(){return i.unsubscribe()}):a=r,s=s==null?void 0:s.bind(a),n=n==null?void 0:n.bind(a),o=o==null?void 0:o.bind(a)}return i.destination={next:s?Ce(s):pe,error:Ce(n!=null?n:Qe),complete:o?Ce(o):pe},i}return t}(Oe);function Ce(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{e.apply(void 0,U([],M(r)))}catch(o){Je(o)}}}function Qe(e){throw e}function Te(e,t){var r=ue.onStoppedNotification;r&&fe.setTimeout(function(){return r(e,t)})}var Qt={closed:!0,next:pe,error:Qe,complete:pe},$e=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Kt(e){return e}function er(e){return e.length===0?Kt:e.length===1?e[0]:function(r){return e.reduce(function(n,o){return o(n)},r)}}var T=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var o=this,i=rr(t)?t:new he(t,r,n);return ve(function(){var s=o,a=s.operator,l=s.source;i.add(a?a.call(i,l):l?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=Ke(r),new r(function(o,i){var s=new he({next:function(a){try{t(a)}catch(l){i(l),s.unsubscribe()}},error:i,complete:o});n.subscribe(s)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[$e]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return er(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=Ke(t),new t(function(n,o){var i;r.subscribe(function(s){return i=s},function(s){return o(s)},function(){return n(i)})})},e.create=function(t){return new e(t)},e}();function Ke(e){var t;return(t=e!=null?e:ue.Promise)!==null&&t!==void 0?t:Promise}function tr(e){return e&&S(e.next)&&S(e.error)&&S(e.complete)}function rr(e){return e&&e instanceof Oe||tr(e)&&Xe(e)}function nr(e){return S(e==null?void 0:e.lift)}function X(e){return function(t){if(nr(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var re=function(e){te(t,e);function t(r,n,o,i,s){var a=e.call(this,r)||this;return a.onFinalize=s,a._next=n?function(l){try{n(l)}catch(c){r.error(c)}}:e.prototype._next,a._error=i?function(l){try{i(l)}catch(c){r.error(c)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=o?function(){try{o()}catch(l){r.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,a}return t.prototype.unsubscribe=function(){var r,n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))},t}(Oe),or=Ue(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),et=function(e){te(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new tt(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new or},t.prototype.next=function(r){var n=this;ve(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){var s=n.observers.slice();try{for(var a=Z(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.next(r)}}catch(f){o={error:f}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}})},t.prototype.error=function(r){var n=this;ve(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var o=n.observers;o.length;)o.shift().error(r)}})},t.prototype.complete=function(){var r=this;ve(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,o=n.hasError,i=n.isStopped,s=n.observers;return o||i?qe:(s.push(r),new ce(function(){return Ee(s,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,o=n.hasError,i=n.thrownError,s=n.isStopped;o?r.error(i):s&&r.complete()},t.prototype.asObservable=function(){var r=new T;return r.source=this,r},t.create=function(r,n){return new tt(r,n)},t}(T),tt=function(e){te(t,e);function t(r,n){var o=e.call(this)||this;return o.destination=r,o.source=n,o}return t.prototype.next=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,r)},t.prototype.error=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&o!==void 0?o:qe},t}(et),ir=new T(function(e){return e.complete()}),ke=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function rt(e){return S(e==null?void 0:e.then)}function nt(e){return S(e[$e])}function ot(e){return Symbol.asyncIterator&&S(e==null?void 0:e[Symbol.asyncIterator])}function it(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function sr(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var st=sr();function at(e){return S(e==null?void 0:e[st])}function lt(e){return Ut(this,arguments,function(){var r,n,o,i;return Ze(this,function(s){switch(s.label){case 0:r=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,q(r.read())];case 3:return n=s.sent(),o=n.value,i=n.done,i?[4,q(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,q(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function ct(e){return S(e==null?void 0:e.getReader)}function Y(e){if(e instanceof T)return e;if(e!=null){if(nt(e))return ar(e);if(ke(e))return lr(e);if(rt(e))return cr(e);if(ot(e))return ut(e);if(at(e))return ur(e);if(ct(e))return fr(e)}throw it(e)}function ar(e){return new T(function(t){var r=e[$e]();if(S(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lr(e){return new T(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function cr(e){return new T(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,Je)})}function ur(e){return new T(function(t){var r,n;try{for(var o=Z(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(t.next(s),t.closed)return}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}t.complete()})}function ut(e){return new T(function(t){pr(e,t).catch(function(r){return t.error(r)})})}function fr(e){return ut(lt(e))}function pr(e,t){var r,n,o,i;return Zt(this,void 0,void 0,function(){var s,a;return Ze(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=qt(e),l.label=1;case 1:return[4,r.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),o={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(i=r.return)?[4,i.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function F(e,t,r,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=t.schedule(function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(i),!o)return i}function ft(e,t){return t===void 0&&(t=0),X(function(r,n){r.subscribe(new re(n,function(o){return F(n,e,function(){return n.next(o)},t)},function(){return F(n,e,function(){return n.complete()},t)},function(o){return F(n,e,function(){return n.error(o)},t)}))})}function pt(e,t){return t===void 0&&(t=0),X(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function dr(e,t){return Y(e).pipe(pt(t),ft(t))}function vr(e,t){return Y(e).pipe(pt(t),ft(t))}function hr(e,t){return new T(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function mr(e,t){return new T(function(r){var n;return F(r,t,function(){n=e[st](),F(r,t,function(){var o,i,s;try{o=n.next(),i=o.value,s=o.done}catch(a){r.error(a);return}s?r.complete():r.next(i)},0,!0)}),function(){return S(n==null?void 0:n.return)&&n.return()}})}function dt(e,t){if(!e)throw new Error("Iterable cannot be null");return new T(function(r){F(r,t,function(){var n=e[Symbol.asyncIterator]();F(r,t,function(){n.next().then(function(o){o.done?r.complete():r.next(o.value)})},0,!0)})})}function gr(e,t){return dt(lt(e),t)}function _r(e,t){if(e!=null){if(nt(e))return dr(e,t);if(ke(e))return hr(e,t);if(rt(e))return vr(e,t);if(ot(e))return dt(e,t);if(at(e))return mr(e,t);if(ct(e))return gr(e,t)}throw it(e)}function yr(e,t){return t?_r(e,t):Y(e)}function vt(e,t){return X(function(r,n){var o=0;r.subscribe(new re(n,function(i){n.next(e.call(t,i,o++))}))})}var wr=Array.isArray;function br(e,t){return wr(t)?e.apply(void 0,U([],M(t))):e(t)}function Sr(e){return vt(function(t){return br(e,t)})}function xr(e,t,r,n,o,i,s,a){var l=[],c=0,f=0,g=!1,u=function(){g&&!l.length&&!c&&t.complete()},m=function(p){return c<n?h(p):l.push(p)},h=function(p){i&&t.next(p),c++;var _=!1;Y(r(p,f++)).subscribe(new re(t,function(v){o==null||o(v),i?m(v):t.next(v)},function(){_=!0},void 0,function(){if(_)try{c--;for(var v=function(){var b=l.shift();s?F(t,s,function(){return h(b)}):h(b)};l.length&&c<n;)v();u()}catch(b){t.error(b)}}))};return e.subscribe(new re(t,m,function(){g=!0,u()})),function(){a==null||a()}}function ht(e,t,r){return r===void 0&&(r=1/0),S(t)?ht(function(n,o){return vt(function(i,s){return t(n,i,o,s)})(Y(e(n,o)))},r):(typeof t=="number"&&(r=t),X(function(n,o){return xr(n,o,e,r)}))}var Er=["addListener","removeListener"],Ir=["addEventListener","removeEventListener"],Or=["on","off"];function ne(e,t,r,n){if(S(r)&&(n=r,r=void 0),n)return ne(e,t,r).pipe(Sr(n));var o=M($r(e)?Ir.map(function(a){return function(l){return e[a](t,l,r)}}):Cr(e)?Er.map(mt(e,t)):Tr(e)?Or.map(mt(e,t)):[],2),i=o[0],s=o[1];if(!i&&ke(e))return ht(function(a){return ne(a,t,r)})(Y(e));if(!i)throw new TypeError("Invalid event target");return new T(function(a){var l=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];return a.next(1<c.length?c:c[0])};return i(l),function(){return s(l)}})}function mt(e,t){return function(r){return function(n){return e[r](t,n)}}}function Cr(e){return S(e.addListener)&&S(e.removeListener)}function Tr(e){return S(e.on)&&S(e.off)}function $r(e){return S(e.addEventListener)&&S(e.removeEventListener)}function kr(e){return e<=0?function(){return ir}:X(function(t,r){var n=0;t.subscribe(new re(r,function(o){++n<=e&&(r.next(o),e<=n&&r.complete())}))})}function Ae(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new et}:t,n=e.resetOnError,o=n===void 0?!0:n,i=e.resetOnComplete,s=i===void 0?!0:i,a=e.resetOnRefCountZero,l=a===void 0?!0:a;return function(c){var f=null,g=null,u=null,m=0,h=!1,p=!1,_=function(){g==null||g.unsubscribe(),g=null},v=function(){_(),f=u=null,h=p=!1},b=function(){var y=f;v(),y==null||y.unsubscribe()};return X(function(y,w){m++,!p&&!h&&_();var x=u=u!=null?u:r();w.add(function(){m--,m===0&&!p&&!h&&(g=Pe(b,l))}),x.subscribe(w),f||(f=new he({next:function(C){return x.next(C)},error:function(C){p=!0,_(),g=Pe(v,o,C),x.error(C)},complete:function(){h=!0,_(),g=Pe(v,s),x.complete()}}),yr(y).subscribe(f))})(c)}}function Pe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return t===!0?(e(),null):t===!1?null:t.apply(void 0,U([],M(r))).pipe(kr(1)).subscribe(function(){return e()})}ne(window,"resize").pipe(Ae({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1}));ne(window,"keypress").pipe(Ae({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1}));const jo=ne(window,"keyup").pipe(Ae({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1})),Ar=e=>new Promise(t=>{const r=document.createElement("input");r.type="file",r.accept=(e||[]).join(","),r.click(),r.addEventListener("change",n=>{const o=(n.dataTransfer||n.target).files;r.remove(),t(o)})}),Pr=e=>{$()&&(e.on("connect",()=>{window.electron.ipcRenderer.invoke("client","connect",!0)}),e.on("disconnect",()=>{window.electron.ipcRenderer.invoke("client","connect",!1)}))},Rr=()=>{window.electron.ipcRenderer.invoke("window","minimize")},Lr=()=>{window.electron.ipcRenderer.invoke("window","maximize")},Dr=e=>{if($())window.electron.ipcRenderer.invoke("window","fullscreen",e);else return e?document.body.requestFullscreen():document.exitFullscreen()},Fr=()=>{window.electron.ipcRenderer.invoke("close")},$=()=>"electron"in window,jr=e=>{if($())return window.electron.ipcRenderer.invoke("save",e);{const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","scene.json"),r.click()}},Nr=async()=>{if($())return window.electron.ipcRenderer.invoke("load");{const e=await Ar(["application/json"]);return new Promise((t,r)=>{if(e.length){const n=new FileReader;n.addEventListener("load",()=>{try{t(JSON.parse(n.result))}catch(o){r(o)}}),n.readAsText(e[0])}else t()})}},Mr=e=>{$()&&window.electron.ipcRendererReceive("dialog",e)},Gr=e=>{$()?window.electron.ipcRendererReceive("window",(t,r)=>{switch(t){case"fullscreen":e(r);break}}):window.addEventListener("fullscreenchange",()=>{e(document.fullscreenEnabled)})},Vr=()=>$()?window.electron.ipcRenderer.invoke("loadConfig"):JSON.parse(window.localStorage.getItem("config")),zr=e=>$()?window.electron.ipcRenderer.invoke("saveConfig",e):window.localStorage.setItem("config",JSON.stringify(e)),Hr=()=>$()?window.electron.ipcRenderer.invoke("getCurrentVersion"):"1.0.0-beta.40",Wr=async()=>{const t=(()=>{const n=[],o=[!1,!0],i=[400,500,600,700,800,900];for(let s=0;s<o.length;s++)for(let a=0;a<i.length;a++)n.push({weight:i[a],italic:o[s]});return n})(),r=[{group:"DevTerm",value:'"5x7-ISO8859-1"',name:"5x7-ISO8859-1",variants:[]},{group:"DevTerm",value:'"6x12-ISO8859-1"',name:"6x12-ISO8859-1",variants:[]},{group:"DevTerm",value:'"7x14-ISO8859-1"',name:"7x14-ISO8859-1",variants:[]},{group:"DevTerm",value:'"Px437_CompaqThin_8x16"',name:"Px437_CompaqThin_8x16",variants:[]},{group:"Web",value:"sans-serif",name:"Sans-serif",monospace:!1,variants:t},{group:"Web",value:"serif",name:"Serif",monospace:!1,variants:t},{group:"Web",value:"monospace",name:"Monospace",monospace:!0,variants:t},{group:"Web",value:"fantasy",name:"Fantasy",monospace:!1,variants:t},{group:"Web",value:"cursive",name:"Cursive",monospace:!1,variants:t}];return $()?r.concat(await window.electron.ipcRenderer.invoke("getFonts")):[...r,{group:"System",value:'"Arial"',name:"Arial",monospace:!1,variants:t},{group:"System",value:'"Verdana"',name:"Verdana",monospace:!1,variants:t},{group:"System",value:'"Helvetica"',name:"Helvetica",monospace:!1,variants:t},{group:"System",value:'"Tahoma"',name:"Tahoma",monospace:!1,variants:t},{group:"System",value:'"Trebuchet MS"',name:"Trebuchet MS",monospace:!1,variants:t},{group:"System",value:'"Times New Roman"',name:"Times New Roman",monospace:!1,variants:t},{group:"System",value:'"Georgia"',name:"Georgia",monospace:!1,variants:t},{group:"System",value:'"Garamond"',name:"Garamond",monospace:!1,variants:t},{group:"System",value:'"Courier New"',name:"Courier New",monospace:!0,variants:t},{group:"System",value:'"Brush Script MT"',name:"Brush Script MT",monospace:!1,variants:t}]};var gt=6,No=16,G=384,I={SIZE_8_16_THIN_1:0,SIZE_8_16_THIN_2:4,SIZE_5_7:1,SIZE_6_12:2,SIZE_7_14:3},Br={[I.SIZE_5_7]:76,[I.SIZE_6_12]:63,[I.SIZE_7_14]:54,[I.SIZE_8_16_THIN_1]:47,[I.SIZE_8_16_THIN_2]:47},Mo={[I.SIZE_8_16_THIN_1]:[8,16],[I.SIZE_8_16_THIN_2]:[8,16],[I.SIZE_7_14]:[7,14],[I.SIZE_6_12]:[6,12],[I.SIZE_5_7]:[5,7]},L={LEFT:0,CENTER:1,RIGHT:2},_t=()=>({align:L.LEFT,font:I.SIZE_8_16_THIN_1,margin:0,underline:0,lineSpace:0,density:gt,underLine:0,wordGap:0}),Zr="/assets/5x7-ISO8859-1.1e468e9f.ttf",Ur="/assets/6x12-ISO8859-1.4c4c24d1.ttf",qr="/assets/7x14-ISO8859-1.b8471bdd.ttf",Xr="/assets/Px437_CompaqThin_8x16.ccffc04f.ttf";const Yr=()=>{const e=[["5x7-ISO8859-1",`url(${Zr})`],["6x12-ISO8859-1",`url(${Ur})`],["7x14-ISO8859-1",`url(${qr})`],["Px437_CompaqThin_8x16",`url(${Xr})`]];return Promise.all(e.map(async t=>{console.log("load font",t[0],t[1]);const r=new FontFace(...t);return await r.load(),document.fonts.add(r),r}))},Go={[I.SIZE_5_7]:{fontFamily:"5x7-ISO8859-1",fontSize:7},[I.SIZE_6_12]:{fontFamily:"6x12-ISO8859-1",fontSize:12},[I.SIZE_7_14]:{fontFamily:"7x14-ISO8859-1",fontSize:14},[I.SIZE_8_16_THIN_1]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16},[I.SIZE_8_16_THIN_2]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16}};var me,Jr=new Uint8Array(16);function Qr(){if(!me&&(me=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!me))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return me(Jr)}var Kr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function en(e){return typeof e=="string"&&Kr.test(e)}var O=[];for(var Re=0;Re<256;++Re)O.push((Re+256).toString(16).substr(1));function tn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(O[e[t+0]]+O[e[t+1]]+O[e[t+2]]+O[e[t+3]]+"-"+O[e[t+4]]+O[e[t+5]]+"-"+O[e[t+6]]+O[e[t+7]]+"-"+O[e[t+8]]+O[e[t+9]]+"-"+O[e[t+10]]+O[e[t+11]]+O[e[t+12]]+O[e[t+13]]+O[e[t+14]]+O[e[t+15]]).toLowerCase();if(!en(r))throw TypeError("Stringified UUID is invalid");return r}function rn(e,t,r){e=e||{};var n=e.random||(e.rng||Qr)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return tn(n)}class ge{constructor(t){const{id:r,type:n,value:o,visible:i}=t||{};this.id=r||rn(),this.type=n,this.value=o,this.visible=i===void 0?!0:i}toJSON(){return{id:this.id,type:this.type,value:this.value,visible:this.visible}}}var nn=384,{createCanvas:oe,loadImage:Vo,Canvas:zo}=Vt,J=()=>({width:null,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}),V=(e,t)=>(t=d(d({},J()),t),t.rotate&&(e=cn(e)),e=an(e,t.width),(t.flipX||t.flipY)&&(e=ln(e,t.flipX,t.flipY)),t.invert&&(e=sn(e)),t.grayscale&&(e=un(e)),e=on(e),e),on=e=>{const t=e.getContext("2d"),r=t.getImageData(0,0,t.canvas.width,t.canvas.height),n=r.data;for(let o=0;o<n.length;o+=4)n[o+3]===0&&(n[o]=255,n[o+1]=255,n[o+2]=255,n[o+3]=255);return t.putImageData(r,0,0),e},sn=e=>{const t=e.getContext("2d"),r=t.getImageData(0,0,t.canvas.width,t.canvas.height),n=r.data;for(let o=0;o<n.length;o+=4)n[o]=255-n[o],n[o+1]=255-n[o+1],n[o+2]=255-n[o+2];return t.putImageData(r,0,0),e},an=(e,t)=>{t=Math.min(e.width,Math.min(t||e.width,nn));const r=t*(e.height/e.width),n=oe(t,r);return n.getContext("2d").drawImage(e,0,0,t,r),n},ln=(e,t,r)=>{const n=oe(e.width,e.height),o=n.getContext("2d");console.log(1-t*2,1-r*2);const i=1-t*2,s=1-r*2;return o.translate(t*e.width,r*e.height),o.scale(i,s),o.drawImage(e,0,0,e.width,e.height),n},cn=e=>{let t=e.getContext("2d");const r=oe(e.height,e.width);return t=r.getContext("2d"),t.translate(e.height,0),t.rotate(Math.PI/2),t.drawImage(e,0,0),r},un=e=>{const t=e.getContext("2d");return t.putImageData(Nt(t.getImageData(0,0,e.width,e.height)),0,0),e},fn=(e,t)=>{const r=oe();try{return Mt(r,e,t),r}catch(n){throw new Error(n)}};async function pn(e,t={}){t=d({margin:0},t);const r=oe(t.width||1,t.width||1);return new Promise(n=>{Gt.toCanvas(r,e,t,o=>{if(o)throw o;n(r)})})}var dn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("select",{attrs:{required:e.required},on:{change:function(n){return e.$emit("input",n.target.value)}}},[e._l(e.singleOptions,function(n){return r("option",{key:n.value,domProps:{value:n.value,selected:n.value===e.preparedValue}},[e._v(" "+e._s(n.title)+" ")])}),e._l(e.groupedOptions,function(n){return r("optgroup",{key:n.label,attrs:{label:n.label}},e._l(n.options,function(o){return r("option",{key:o.value,domProps:{value:o.value,selected:o.value===e.preparedValue}},[e._v(" "+e._s(o.title)+" ")])}),0)})],2)},vn=[];function j(e,t,r,n,o,i,s,a){var l=typeof e=="function"?e.options:e;t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId="data-v-"+i);var c;if(s?(c=function(u){u=u||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!u&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(u=__VUE_SSR_CONTEXT__),o&&o.call(this,u),u&&u._registeredComponents&&u._registeredComponents.add(s)},l._ssrRegister=c):o&&(c=a?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),c)if(l.functional){l._injectStyles=c;var f=l.render;l.render=function(m,h){return c.call(h),f(m,h)}}else{var g=l.beforeCreate;l.beforeCreate=g?[].concat(g,c):[c]}return{exports:e,options:l}}const hn={props:{options:{type:Array,default(){return[1,2,3,4]}},value:{type:[String,Number],default:null},required:{type:Boolean,default:!1}},computed:{preparedValue(){return this.value===null?"":String(this.value)},preparedOptions(){return this.options.map(e=>typeof e=="object"&&"title"in e?_e.create(e):_e.create({value:e}))},singleOptions(){return this.preparedOptions.filter(e=>!e.group)},groupedOptions(){return Object.entries(this.preparedOptions.reduce((e,t)=>(t.group&&(e[t.group]=(e[t.group]||[]).concat(t)),e),{})).map(([e,t])=>({label:e,options:t}))}}};var W,K,ee;class _e{constructor(t){ae(this,W,void 0);ae(this,K,void 0);ae(this,ee,void 0);t&&typeof t!="object"&&(t={value:t});const{value:r,title:n,group:o}=t||{value:""};le(this,W,r||""),le(this,K,n||D(this,W)),le(this,ee,o)}get value(){return D(this,W)}get title(){return D(this,K)}get group(){return D(this,ee)}toJSON(){return{value:D(this,W),title:D(this,K),group:D(this,ee)}}static create(...t){return new this(...t)}}W=new WeakMap,K=new WeakMap,ee=new WeakMap;const yt={};var mn=j(hn,dn,vn,!1,gn,null,null,null);function gn(e){for(let t in yt)this[t]=yt[t]}var Ho=function(){return mn.exports}();const _n=()=>[{native:!0,title:"Align (native)",value:"setAlign",group:"Layout"},{native:!0,title:"Margin (native)",value:"setMargin",group:"Layout"},{native:!0,title:"Font (native)",value:"setFont",group:"Layout"},{native:!0,title:"LineSpace (native)",value:"setLineSpace",group:"Layout"},{native:!0,title:"WordGap (native)",value:"setWordGap",group:"Layout"},{native:!1,title:"Spacer",value:"spacer",group:"Layout"},{native:!1,title:"Grid",value:"grid",group:"Layout"},{native:!1,title:"Image",value:"image",group:"Content"},{native:!1,title:"QRCode",value:"qrCode",group:"Content"},{native:!1,title:"Barcode",value:"barcode",group:"Content"},{native:!1,title:"Text",value:"text",group:"Content"},{native:!1,title:"Table",value:"table",group:"Content"},{native:!0,title:"Text (native)",value:"nativeText",group:"Content"},{native:!0,title:"Reset (native)",value:"reset",group:"General"},{native:!0,title:"Feed Pitch (native)",value:"feedPitch",group:"General"},{native:!0,title:"Cutline (native)",value:"cutLine",group:"General"},{native:!0,title:"Density (native)",value:"setDensity",group:"General"}],Wo=()=>[new _e({title:"Add new Action\u2026",value:""}),..._n().map(e=>new _e(e))],Bo=e=>{let t;switch(e){case"setLineSpace":t=0;break;case"setWordGap":t=0;break;case"setMargin":t=0;break;case"setDensity":t=1;break;case"setFont":t=I.SIZE_8_16_THIN_1;break;case"setAlign":t=L.LEFT;break;case"feedPitch":t={value:1,type:"font"};break;case"text":t=Le();break;case"table":t=On();break;case"nativeText":t="Text";break;case"grid":t=bn();break;case"image":t=Sn();break;case"qrCode":t=xn();break;case"barcode":t=En();break;case"spacer":t=In();break}return new ge({type:e,value:t})},Zo=e=>{const t=_t();return e.filter(r=>r.visible).map(r=>wn(r,t)).filter(Boolean)},yn=e=>Array(Br[e]).fill("").map((t,r)=>r%2==0?"=":"-").join(""),wn=(e,t)=>{switch(e.type){case"setMargin":t.margin=e.value;break;case"setAlign":t.align=e.value;break;case"setLineSpace":t.lineSpace=e.value;break;case"setWordGap":t.wordGap=e.value;break;case"setFont":t.font=Number(e.value);break;case"setDensity":t.density=Number(e.value);break;case"reset":Object.assign(t,_t());break;case"cutLine":return{id:e.id,component:()=>E(()=>import("./NativeText.b9a289a9.js"),["assets/NativeText.b9a289a9.js","assets/NativeText.1f1c7c51.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:B(d({},t),{margin:0,wordGap:0,lineSpace:0,density:gt}),props:{value:yn(t.font)}};case"spacer":return{id:e.id,component:()=>E(()=>import("./SpacerCanvas.aedb69f4.js"),["assets/SpacerCanvas.aedb69f4.js","assets/SpacerCanvas.52030cc2.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"grid":return{id:e.id,component:()=>E(()=>import("./GridCanvas.c8a98c63.js"),["assets/GridCanvas.c8a98c63.js","assets/GridCanvas.b667bdd0.css","assets/NativeText.b9a289a9.js","assets/NativeText.1f1c7c51.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"barcode":return{id:e.id,component:()=>E(()=>import("./BarcodeCanvas.582b67af.js"),["assets/BarcodeCanvas.582b67af.js","assets/BarcodeCanvas.c3e7a34f.css","assets/NativeText.b9a289a9.js","assets/NativeText.1f1c7c51.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"qrCode":return{id:e.id,component:()=>E(()=>import("./QrCodeCanvas.34bff1b9.js"),["assets/QrCodeCanvas.34bff1b9.js","assets/QrCodeCanvas.61d59f7a.css","assets/NativeText.b9a289a9.js","assets/NativeText.1f1c7c51.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"image":return{id:e.id,component:()=>E(()=>import("./ImageCanvas.ec67ff39.js"),["assets/ImageCanvas.ec67ff39.js","assets/ImageCanvas.2ca62634.css","assets/NativeText.b9a289a9.js","assets/NativeText.1f1c7c51.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"text":return{id:e.id,component:()=>E(()=>import("./TextCanvas.be8a0f6a.js"),["assets/TextCanvas.be8a0f6a.js","assets/TextCanvas.09b213aa.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"table":return{id:e.id,component:()=>E(()=>import("./TableCanvas.3bf5ea4a.js"),["assets/TableCanvas.3bf5ea4a.js","assets/TableCanvas.17b16592.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"nativeText":return{id:e.id,component:()=>E(()=>import("./NativeText.b9a289a9.js"),["assets/NativeText.b9a289a9.js","assets/NativeText.1f1c7c51.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e)};case"feedPitch":return{id:e.id,component:()=>E(()=>import("./FeedPitch.0a2e0f7e.js"),["assets/FeedPitch.0a2e0f7e.js","assets/FeedPitch.3fa7fa3d.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),options:d({},t),props:d({},e.value)}}return null},bn=()=>({widths:[1],data:[[]],options:{columnGutter:0,rowGutter:0},imageOptions:J()}),Le=()=>({text:"Sample",options:k(),imageOptions:J()}),Sn=()=>({file:null,imageOptions:J()}),xn=()=>({text:"Sample",options:{errorCorrectionLevel:"M",margin:0,scale:4,small:!1},imageOptions:J()}),En=()=>({text:"Sample",options:{format:"",height:100,font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,margin:10,displayValue:!0,flat:!1},imageOptions:J()}),In=()=>({value:0}),N=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right"}),k=()=>({fontSize:16,align:N.LEFT,lineSpace:0,wordGap:0,margin:0,fontFamily:"sans-serif",color:"#000",weight:400,italic:!1,underline:!1,justify:!1}),On=()=>({data:[[]],columns:[ye()],options:{columnGutter:0,rowGutter:0,headActive:!1,footActive:!1,useColumnStyles:!1,bodyOptions:ye(),headOptions:ye(),footOptions:ye()}}),ye=()=>({width:1,bodyOptions:k(),headOptions:k(),footOptions:k()});var Cn=[{type:"reset"},{id:"4374d709-ab96-4d35-84b9-b4f08f29e6de",type:"table",value:{data:[["test test test test test test test test test test test test test ",2,3],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],options:{columnGutter:0,rowGutter:0},headActive:!1,footActive:!1,columns:[{width:1,bodyOptions:{fontSize:16,align:N.LEFT,lineSpace:0,wordGap:0,margin:0,fontFamily:'"Arial"',color:"#000",weight:400,italic:!1,underline:!0},headOptions:k(),footOptions:k()},{width:1,bodyOptions:{fontSize:16,align:N.CENTER,lineSpace:0,wordGap:0,margin:0,fontFamily:'"Arial"',color:"#000",weight:400,italic:!1},headOptions:k(),footOptions:k()},{width:1,bodyOptions:{fontSize:16,align:N.RIGHT,lineSpace:0,wordGap:0,margin:0,fontFamily:'"Arial"',color:"#000",weight:400,italic:!1},headOptions:k(),footOptions:k()}]},visible:!0},{id:"6319ab91-5740-49c0-8265-1d05d97014a3",type:"grid",value:{widths:[1,1],data:[[{id:"7d4b8881-37d3-4b80-98e2-dbef273fd321",type:"spacer",value:{value:200},visible:!0},{id:"7d4b8881-37d3-4b80-98e2-dbef273fd320",type:"text",value:{text:`Item 1.
Item 2.
Item 3.
Item 4.`,options:{fontSize:"24",align:"left",lineSpace:"30",wordGap:0,margin:0,fontFamily:null,color:"#000",weight:400,italic:!1},imageOptions:{width:192,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0}],[{id:"cafb2f8d-add1-4c34-9c1e-6f19c63732ac",type:"text",value:{text:`0,00
0,00
0,00
0,00`,options:{fontSize:"24",align:N.LEFT,lineSpace:"30",wordGap:0,margin:0,fontFamily:null,color:"#000",weight:400,italic:!1},imageOptions:{width:192,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0}]],options:{columnGutter:0,rowGutter:0},imageOptions:{width:null,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0},{type:"feedPitch",value:{value:15,type:"font"}}],Tn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-menu"},[r("ul",[e._t("default")],2)])},$n=[];const kn={},wt={};var An=j(kn,Tn,$n,!1,Pn,"6a61d96c",null,null);function Pn(e){for(let t in wt)this[t]=wt[t]}var Rn=function(){return An.exports}(),Ln=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",e._g({staticClass:"base-generic-button"},e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)},Dn=[];const Fn={props:{text:{type:String,default:"Button Text"}}},bt={};var jn=j(Fn,Ln,Dn,!1,Nn,"0c7b8858",null,null);function Nn(e){for(let t in bt)this[t]=bt[t]}var Mn=function(){return jn.exports}(),Gn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-item",class:{selected:e.selected}},[r("base-generic-button",e._g(e._b({},"base-generic-button",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)],1)},Vn=[];const zn={components:{BaseGenericButton:Mn},inheritAttrs:!1,props:{selected:{type:Boolean,default:!1},text:{type:String,default:null}}},St={};var Hn=j(zn,Gn,Vn,!1,Wn,"1b42e491",null,null);function Wn(e){for(let t in St)this[t]=St[t]}var P=function(){return Hn.exports}(),Bn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",e._g(e._b({staticClass:"app-menu-text"},"li",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[r("span",{domProps:{innerHTML:e._s(e.text)}})]})],2)},Zn=[];const Un={inheritAttrs:!1,props:{text:{type:String,default:null}}},xt={};var qn=j(Un,Bn,Zn,!1,Xn,"72abcabd",null,null);function Xn(e){for(let t in xt)this[t]=xt[t]}var we=function(){return qn.exports}(),Yn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-spacer"},[e._t("default")],2)},Jn=[];const Qn={},Et={};var Kn=j(Qn,Yn,Jn,!1,eo,"d155e842",null,null);function eo(e){for(let t in Et)this[t]=Et[t]}var De=function(){return Kn.exports}(),to=function(){var e=this,t=e.$createElement;return e._self._c,e._m(0)},ro=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-divider"},[r("i")])}];const no={},It={};var oo=j(no,to,ro,!1,io,"53fd4f5e",null,null);function io(e){for(let t in It)this[t]=It[t]}var Q=function(){return oo.exports}(),so=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app",class:{ready:e.ready},style:e.style},[r("app-menu",{staticClass:"header"},e._l(e.headerItems,function(n,o){return r(n.component,e._g(e._b({key:o,tag:"component"},"component",n.props,!1),n.on))}),1),r("div",{staticClass:"app-content"},[!e.$client.connected&&e.ready?r("view-start",{on:{apply:e.onApplyViewStart}}):e.currentView===e.VIEWS.PRINTER?r("view-printer",{attrs:{colors:e.colors},model:{value:e.printerTemplate,callback:function(n){e.printerTemplate=n},expression:"printerTemplate"}}):e.currentView===e.VIEWS.INFO?r("view-info"):e._e()],1),r("app-menu",{staticClass:"footer"},e._l(e.footerItems,function(n,o){return r(n.component,e._g(e._b({key:o,tag:"component"},"component",n.props,!1),n.on))}),1),e._l(e.$errorList.errors,function(n,o){return r("dialog-error",e._b({key:o,attrs:{"init-open":""}},"dialog-error",n,!1))}),e._l(e.$dialog.prompts,function(n,o){return r("dialog-prompt",e._b({key:o,attrs:{"init-open":""}},"dialog-prompt",n,!1))}),e.ready?r("dialog-remote",{ref:"dialogRemote"}):e._e(),e.ready?r("dialog-server",{ref:"dialogServer"}):e._e(),e.ready?r("dialog-options",{ref:"dialogOptions"}):e._e(),e._m(0)],2)},ao=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"display-look"},[r("div",{staticClass:"scanlines"})])}];const z={NONE:null,INFO:"info",START:"start",PRINTER:"priner"},lo={amber:{primary:[255,204,0],secondary:[0,0,0],printer:{preview:{background:[255,204,0],foreground:[0,0,0]}}},green:{primary:[51,255,0],secondary:[0,0,0],printer:{preview:{background:[51,255,0],foreground:[0,0,0]}}},whiteBlack:{primary:[255,255,255],secondary:[0,0,0],printer:{preview:{background:[255,255,255],foreground:[0,0,0]}}},blackWhite:{primary:[0,0,0],secondary:[255,255,255],printer:{preview:{background:[0,0,0],foreground:[255,255,255]}}}};function co(){return Cn.map(e=>new ge(e))}const uo={components:{ViewPrinter:()=>E(()=>import("./Printer.2b87fa58.js").then(function(e){return e.P}),["assets/Printer.2b87fa58.js","assets/Printer.71e2f60f.css","assets/View.af53146a.js","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/DropDown.2c6980f4.js","assets/DropDown.a92b0b2c.css","assets/Dialog.4d61447b.js","assets/Dialog.5c008ae1.css"]),ViewStart:()=>E(()=>import("./Start.baf09790.js"),["assets/Start.baf09790.js","assets/Start.7b700386.css","assets/View.af53146a.js","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),ViewInfo:()=>E(()=>import("./Info.6b98723f.js"),["assets/Info.6b98723f.js","assets/Info.f09bbb3b.css","assets/View.af53146a.js","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),AppMenu:Rn,AppMenuItem:P,AppMenuText:we,AppMenuSpacer:De,AppMenuDivider:Q,DialogError:()=>E(()=>import("./Error.7e185381.js"),["assets/Error.7e185381.js","assets/Error.9832724b.css","assets/Dialog.4d61447b.js","assets/Dialog.5c008ae1.css","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),DialogRemote:()=>E(()=>import("./Remote.cd940269.js"),["assets/Remote.cd940269.js","assets/Remote.faa484f5.css","assets/Dialog.4d61447b.js","assets/Dialog.5c008ae1.css","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/DropDown.2c6980f4.js","assets/DropDown.a92b0b2c.css","assets/CheckBox.e990b87c.js","assets/CheckBox.12afbd75.css","assets/TextField.fb41c658.js","assets/TextField.d3378861.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),DialogServer:()=>E(()=>import("./Server.d10d814d.js"),["assets/Server.d10d814d.js","assets/Server.4f2589f0.css","assets/Dialog.4d61447b.js","assets/Dialog.5c008ae1.css","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/DropDown.2c6980f4.js","assets/DropDown.a92b0b2c.css","assets/Content.234717f0.js","assets/Content.182197b6.css","assets/TextField.fb41c658.js","assets/TextField.d3378861.css","assets/FileSelect.b59d0b5a.js","assets/FileSelect.8c5eefc3.css","assets/CheckBox.e990b87c.js","assets/CheckBox.12afbd75.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),DialogOptions:()=>E(()=>import("./Options.764f3b5e.js"),["assets/Options.764f3b5e.js","assets/Options.5466c3cb.css","assets/Dialog.4d61447b.js","assets/Dialog.5c008ae1.css","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/TextField.fb41c658.js","assets/TextField.d3378861.css","assets/DropDown.2c6980f4.js","assets/DropDown.a92b0b2c.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"]),DialogPrompt:()=>E(()=>import("./Prompt.1c93951f.js"),["assets/Prompt.1c93951f.js","assets/Prompt.ba8cf0c2.css","assets/Dialog.4d61447b.js","assets/Dialog.5c008ae1.css","assets/TextButton.18db395f.js","assets/TextButton.55961f21.css","assets/vendor.b1428349.js","assets/devterm.9e5b33a4.js","assets/buffer.4460b8ba.js","assets/canvas-text-wrapper.5613b40d.js"])},data(){return{VIEWS:z,currentView:z.PRINTER,ready:!1,fullscreen:!1,printerTemplate:co()}},computed:{headerItems(){const e=[{component:P,on:{click:this.onClickNew},props:{text:"New"}},{component:Q},{component:P,on:{click:this.onClickSave},props:{text:"Save"}},{component:P,title:"Load",on:{click:this.onClickLoad},props:{text:"Load"}},{component:Q}];return[...this.$client.connected&&[{component:P,on:{click:()=>this.currentView=z.INFO},props:{selected:this.currentView===z.INFO,text:"Info"}},{component:P,on:{click:()=>this.currentView=z.PRINTER},props:{selected:this.currentView===z.PRINTER,text:"Printer"}}]||[],{component:De},...this.$client.connected&&this.currentView===z.PRINTER&&e||[],{component:P,on:{click:this.onClickOptions},props:{text:"Options"}},$()&&[{component:Q},{component:P,on:{click:this.onClickClose},props:{text:"Close"}}]].flat().filter(Boolean)},footerItems(){return[$()&&[{component:P,on:{click:this.onClickMinimizeWindow},props:{text:"Minimize"}},{component:P,on:{click:this.onClickMaximizeWindow},props:{text:"Maximize"}}].flat(),{component:P,on:{click:this.onClickFullscreen},props:{selected:this.fullscreen,text:"Fullscreen"}},{component:De},this.hasServer&&[{component:we,on:{click:this.showServerDialog},props:{class:{connection:!0,connected:this.$server.options.active},text:`${this.$server.options.active?`Server (*:${this.$server.options.port}${this.$server.options.secure?"/SSL":""})`:"Server Offline"}`}},{component:Q}],{component:we,on:{click:this.showRemoteDialog},props:{class:{connection:!0,connected:this.clientConnected},text:`${this.clientConnected?`Online (${this.$client.host}:${this.$client.port}${this.$client.secure?"/SSL":""})`:"Offline"}`}},{component:Q},{component:we,on:{click:()=>{window.open("https://github.com/ThornWalli/devterm-toolbox/releases")}},props:{class:"info-version",text:this.version}}].flat().filter(Boolean)},hasServer(){return!this.$server.disabled},version(){return this.$config.version},colors(){return lo[this.$config.data.theme]},clientConnected(){return this.$client.connected},style(){return d(d({"--zoom":`${this.$config.data.zoom}`,"--color-primary":`rgb(${this.colors.primary.join(",")})`,"--color-secondary":`rgb(${this.colors.secondary.join(",")})`},Object.fromEntries(Array(10).fill("").map((e,t)=>[`--color-primary-${(t+1)*10}`,`rgb(${this.colors.primary.join(" ")} / ${(t+1)*10}%)`]))),Object.fromEntries(Array(10).fill("").map((e,t)=>[`--color-secondary-${(t+1)*10}`,`rgb(${this.colors.secondary.join(" ")} / ${(t+1)*10}%)`])))}},async mounted(){await Yr(),await this.$config.init(),await this.$server.init(),this.hasServer&&await this.$server.refresh(),await this.$config.load();const e=this.$config.get("profiles").find(({name:t})=>t===this.$config.get("profile"));if(e){const{port:t,host:r,ssl:n,secure:o}=e;if(this.$config.get("startType")&&t)try{this.$server&&this.$config.get("startType")==="local"&&!this.$server.options.active&&await this.$server.start(t,n),r&&await this.$client.connect(t,r,o)}catch{}}this.ready=!0,this.registerListeners()},methods:{registerListeners(){Gr(e=>{this.fullscreen=e}),Mr((e,t)=>{switch(e){case"open":switch(t){case"options":this.showOptionsDialog();break;case"remote":this.showRemoteDialog();break;case"server":this.showServerDialog();break}break}})},onClickMinimizeWindow(){return Rr()},onClickMaximizeWindow(){return Lr()},onClickFullscreen(){return Dr(!this.fullscreen)},onClickClose(){return Fr()},onClickNew(){this.printerTemplate=[]},onClickSave(){return jr(this.printerTemplate)},async onClickLoad(){try{const e=await Nr();e&&(this.printerTemplate=e)}catch(e){this.$errorList.add(e)}},onClickOptions(){this.showOptionsDialog()},async onApplyViewStart({type:e}){this.$config.set("startType",e);let t={};switch(e){case"local":t=await this.showServerDialog();break;case"remote":t=await this.showRemoteDialog();break}const{profile:r}=t||{};r&&(this.$config.set("profile",r),await this.$config.save())},showServerDialog(){return this.$refs.dialogServer.show()},showRemoteDialog(){return this.$refs.dialogRemote.show()},showOptionsDialog(){return this.$refs.dialogOptions.show()}}},Ot={};var fo=j(uo,so,ao,!1,po,"c348ec66",null,null);function po(e){for(let t in Ot)this[t]=Ot[t]}var Ct=function(){return fo.exports}();class vo{constructor(){this.errors=[]}add(t,r){typeof t=="object"&&(console.error(t),t.message?(t.type&&(r=t.type),t=t.message):t=JSON.stringify(t));const n={title:r,message:t},o=()=>{this.errors.slice(this.errors.indexOf(n),1)};n.callback=o,this.errors.push(n)}}const Tt=A.observable(new vo);Object.defineProperty(A.prototype,"$errorList",{get(){return Tt}});const Uo=512,be=()=>({theme:"amber",zoom:1,startType:null,ssl:{key:null,cert:null,pfx:null,passphrase:null},profiles:[]}),ho=()=>({name:null,port:3e3,host:null,secure:!1,ssl:{key:null,cert:null,pfx:null,passphrase:null}}),qo="localhost",mo="Profile Default";class go{constructor(){this.data=be(),this.version=null,this.fonts=[]}async init(){this.version=await Hr(),this.fonts=await Wr()}toJSON(){return Object.assign({},this.data,{version:this.version})}get(t){return this.data[t]}set(t,r){typeof t=="string"?this.data[t]=r:typeof t=="object"&&Object.entries(t).forEach(([n,o])=>this.set(n,o))}save(){return zr(this.toJSON())}reset(){return this.data=be(),this.save()}async load(){let t;try{t=await Vr()}catch{t=be()}return console.log(t),this.data=Object.assign(be(),t)}saveProfile(t){t.name=t.name||mo;const r=this.get("profiles");let n=this.get("profiles").find(({name:o})=>o===t.name);return n?(console.log("update profile",n.name,n),r[r.indexOf(n)]=d(d({},n),t)):(console.log("create profile",t.name,t),n=d(d({},ho()),t),r.push(n)),this.set("profiles",r),this.save()}deleteProfile(t){const r=this.get("profiles"),n=this.get("profiles").find(({name:o})=>o===t);return r.slice(r.indexOf(n),1),this.set("profiles",r),this.save()}}const _o=A.observable(new go);Object.defineProperty(A.prototype,"$config",{get(){return _o}});Object.defineProperty(A.prototype,"$server",{get(){return{init(){return Promise.resolve()},disabled:!0}}});var Fe=9224,$t=29,yo=function(e){const t=We.Buffer.alloc(e.byteLength),r=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=r[n];return t},kt=(e,t)=>{const r=e/8%256,n=e/8/256,o=t%256,i=t/256,s=(r+256*n)*(o+256*i);return{xL:r,xH:n,yL:o,yH:i,k:s}},wo=(e,t)=>{const{k:r}=kt(e,1),n=Fe/r;return Math.ceil(t/n)},bo=e=>{const t=e.getContext("2d"),r=wo(e.width,e.height),n=[];for(let o=0;o<r;o++)n.push(t.getImageData(0,e.height/r*o,e.width,e.height/r));return n};function So(e){const t=(n,o)=>{const i=(o*e.width+n)*4,s=e.data;return{r:s[i],g:s[i+1],b:s[i+2],a:s[i+3]}},r=[];for(let n=0;n<e.height;n++){r[n]=r[n]||[];for(let o=0;o<e.width;o++)r[n][o]=t(o,n)}return r}var xo=e=>{const t=[],{width:r,height:n}=e,o=So(e);for(let i=0;i<n;i++){t[i]=new Uint8Array(Math.round(r/8));for(let s=0;s<t[i].length;s++){t[i][s]=0;for(let a=0;a<8;a++){const{r:l,g:c,b:f,a:g}=o[i][s*8+a]||{r:255,g:255,b:255,a:255};((l+c+f)/3/255<.6||g<.6)&&(t[i][s]|=1<<7-a)}}}return t},Eo=(e,t)=>{const{xL:r,xH:n,yL:o,yH:i,k:s}=kt(e,t),a=[$t,118,48,0,r,n,o,i];if(a[0]===$t&&a[1]===118&&a[2]===48&&!(s<=Fe))throw new Error(`Image too large; ${s} > ${Fe}`);return a},Io=async e=>(await bo(e)).map(n=>{const o=xo(n);return[We.Buffer.from(Eo(o[0].length*8,n.height))].concat(o.map(i=>yo(i)))}).flat();const Xo=e=>{const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL("image/png",100)},Oo=(e,t,r)=>{if(t){if(e.width<=t)return e;r=t*(e.height/e.width)}else{if(e.height<=r)return e;t=r*(e.width/e.height)}const n=new OffscreenCanvas(t,r);return n.getContext("2d").drawImage(e,0,0,t,r),n},Co=async e=>{const t=new window.Image;await new Promise((o,i)=>{t.onload=()=>o(t),t.onerror=()=>i(new Error("image not found")),t.src=e,t.crossOrigin="anonymous"});const r=new OffscreenCanvas(t.naturalWidth,t.naturalHeight);return r.getContext("2d").drawImage(t,0,0),r},Yo=(e,t,r=1,n=!0)=>{e=Oo(e,G);const o=e.getContext("2d"),i=o.getImageData(0,0,o.canvas.width,o.canvas.height);return n&&To(i.data,[t.foreground,t.background],r),o.putImageData(i,0,0),e},To=(e,t,r)=>{for(let n=0;n<e.length;n+=4)(e[n]+e[n+1]+e[n+2])/3/255<.6?(e[n]=t[0][0],e[n+1]=t[0][1],e[n+2]=t[0][2],e[n+3]=parseInt(e[n+3]*r)):(e[n]=t[1][0],e[n+1]=t[1][1],e[n+2]=t[1][2],e[n+3]=parseInt(e[n+3]*r))},H=e=>Io(e),At=(e,t,r,n)=>{n=d({background:[255,255,255],foreground:[0,0,0]},n);const{fontSize:o,align:i,lineSpace:s,wordGap:a,margin:l,fontFamily:c,weight:f,italic:g,underline:u,justify:m}=d(d({},k()),t);e=String(e);const h=document.createElement("canvas");h.width=r,h.style.display="none",document.body.append(h);const p=h.getContext("2d");p.canvas.style.letterSpacing=`${a}px`;const _=1+s/o,v={font:`${g?"italic ":""}${f} ${o}px ${c}`,lineHeight:_,textAlign:i,verticalAlign:"top",paddingX:l,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:!0,allowNewLine:!0,justifyLines:m,renderHDPI:!0,textDecoration:u?"underline":"none"},b=He.exports.CanvasTextWrapper(h,e,v);return h.height=b.length*o*_,He.exports.CanvasTextWrapper(h,e,v),h.remove(),h},Jo=(e,t,r,n)=>{n=d({background:[255,255,255],foreground:[0,0,0]},n);const{fontSize:o,align:i,lineSpace:s,wordGap:a,margin:l,fontFamily:c,weight:f,italic:g}=d({fontSize:12,align:L.LEFT,wordGap:0,lineSpace:0,margin:0,fontFamily:"sans-serif",color:"#000",weight:400,italic:!1},t),u=[0,r*l,0,0];let m=0,h=r;switch(i){case L.RIGHT:m+=r,h-=u[1];break;case L.CENTER:m+=h/2;break;default:m+=u[1],h-=u[1];break}const p=`${g?"italic ":""}${f} ${o}px ${c}`,_=document.createElement("canvas");_.style.display="none",document.body.append(_);const v=_.getContext("2d");v.canvas.style.letterSpacing=`${a}px`,v.font=p;const b=Math.max(s,o)/o,y=e.split(`
`).map(x=>Pt(v,x,0,0,o,h)).flat(),w=y.length*o*b+u[0]+u[2];if(!r)switch(r=parseInt(e.split(`
`).reduce((x,C)=>Math.max(v.measureText(C).width,x),0)),m=0,i){case L.RIGHT:m+=r;break;case L.CENTER:m+=r/2;break}return _.width=r,v.font=p,_.height=w,v.fillStyle=`rgb(${n.background.join(" ")})`,v.fillRect(0,0,_.width,_.height),v.fillStyle=`rgb(${n.foreground.join(" ")})`,v.textBaseline="top",v.font=p,v.canvas.style.letterSpacing=`${a}px`,v.textAlign={[N.LEFT]:"left",[N.CENTER]:"center",[N.RIGHT]:"right"}[Number(i)],v.translate(0,u[0]),y.forEach((x,C)=>{v.fillText(x,m,C*b*o-(o-b*o)/2)}),_.remove(),_};function Pt(e,t,r,n,o,i,s=[]){if(i=i||0,i<=0)return[t];for(let a=1;a<=t.length;a++){const l=t.substr(0,a);if(e.measureText(l).width>i)return s.push(t.substr(0,a-1)),s=s.concat(Pt(e,t.substr(a-1),r,n+o,o,i)),s}return s.push(t),s}var ie={cutLine:{display:()=>({title:"Cut Line"})},grid:{display:e=>({title:"Grid",value:`Columns: ${e.data.length}`}),beforePrinterCommand:async(e,t=!0)=>{const{widths:r,data:n,options:o,imageOptions:i}=e.value,s=(i==null?void 0:i.width)||G,{columnGutter:a,rowGutter:l}=d({columnGutter:12,rowGutter:12},o);let c=r.filter(p=>p<1).reduce((p,_)=>p+(1-_),0);c/=r.filter(p=>p===1).length;const f=await Promise.all(n.map(async(p,_)=>{const v=n.length-1;return await Promise.all(p.filter(({visible:b})=>b).map(async b=>{let y=parseInt(s/n.length)*r[_];r[_]===1&&(y+=parseInt(s/n.length)*c),v>0&&(y=y-a*v/n.length);const{value:w}=b;(w.imageOptions=w.imageOptions||{}).width=y;try{return await ie[String(b.type)].beforePrinterCommand(d({},b),!1)}catch(x){return ie.text.beforePrinterCommand(new ge({visible:!0,value:B(d({},Le()),{text:x.message,imageOptions:w.imageOptions})}),!1)}}))})),g=f.reduce((p,_)=>{const v=_.length-1;return Math.max(_.filter(({visible:b})=>b).reduce((b,{value:y})=>b+y.height,v*l),p)},1);let u=new OffscreenCanvas(s,g);const m=u.getContext("2d");let h=0;return f.forEach((p,_)=>{let v=0;h+=p.filter(({visible:y})=>y).reduce((y,{value:w},x)=>(m.drawImage(w,h,v),v+=w.height+(x<p.length?l:0),Math.max(w.width,y)),0)+(_<f.length?a:0)}),u=V(u,i),e.value=t?await H(u):u,e}},barcode:{display:e=>({title:"Barcode",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value;let i=await fn(r||"empty",n||{});return i=V(i,o),e.value=t?await H(i):i,e}},qrCode:{display:e=>({title:"QR Code",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value,i=d({},n);i.width=n.width||o.width;let s=await pn(r||"empty",i);return s=V(s,o),e.value=t?await H(s):s,e}},image:{display:()=>({title:"Image"}),beforePrinterCommand:async(e,t=!0)=>{const{file:r,imageOptions:n}=e.value;let o=await Co(r);return o=V(o,n),e.value=t?await H(o):o,e}},spacer:{display:()=>({title:"Spacer"}),beforePrinterCommand:async(e,t=!0)=>{const{value:r,imageOptions:n}=e.value;let o=new OffscreenCanvas((n==null?void 0:n.width)||G,Math.max(r,1));return o=V(o,n),e.value=t?await H(o):o,e}},text:{display:e=>({title:"Text",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value;let i=await At(r||"empty",n||{},(o==null?void 0:o.rotate)?null:(o==null?void 0:o.width)||G);return i=V(i,o),e.value=t?await H(i):i,e}},table:{display:e=>{var t;return{title:"Table",value:`Rows: ${e.data.length}; Columns: ${(t=e.data[0])==null?void 0:t.length}; `}},beforePrinterCommand:async(e,t=!0)=>{const{data:r,columns:n,options:o,imageOptions:i}=e.value,s=(i==null?void 0:i.width)||G,a=(i==null?void 0:i.width)||G;try{const{columnGutter:l,rowGutter:c}=d({columnGutter:12,rowGutter:12},o);let f=r;if(f.length<1)throw new Error("Table empty!");const g=n.length,u=a/g-(g-1)*l/g;let m=n.filter(({width:y})=>y<1).reduce((y,{width:w})=>y+(1-w),0);m/=n.filter(({width:y})=>y===1).length;const h=[];f=await Promise.all(f.map((y,w)=>Promise.all(Array(n.length).fill({}).map(async(x,C)=>{x=y[C];let R;o.useColumnStyles?(R=n[C].bodyOptions||{},o.headActive&&w<1?R=n[C].headOptions:o.footActive&&f.length-1===w&&(R=n[C].footOptions)):(R=o.bodyOptions||{},o.headActive&&w<1?R=o.headOptions:o.footActive&&f.length-1===w&&(R=o.footOptions));let se=parseInt(u*n[C].width);return n[C].width===1&&(se+=parseInt(s/n.length*m)),x=await At(String(x===void 0?"":x),R,se),h[w]=Math.max(x.height,h[w]||0),x}))));const p=h.reduce((y,w)=>y+w,0)+(f.length-1)*c;let _=0,v=new OffscreenCanvas((i==null?void 0:i.width)||G,p);const b=v.getContext("2d");return n.forEach((y,w)=>{let x=0;_+=f.reduce((R,se,Ne)=>{const Me=se[w];return b.drawImage(Me,_,x),x+=h[Ne]+(Ne<f.length?c:0),Math.max(Me.width,R)},0)+(w<n.length?l:0)}),v=V(v,i),e.value=t?await H(v):v,e}catch(l){return await ie.text.beforePrinterCommand(new ge({visible:!0,value:B(d({},B(d({},Le()),{options:B(d({},k),{align:L.CENTER,weight:700,underline:!0})})),{text:l.message})}),t)}}},nativeText:{display:e=>({title:"Native Text",value:`${e.slice(0,16)}\u2026`})},feedPitch:{display:({type:e,value:t})=>({title:"Feed-Pitch",value:`${e} | ${t}`})},reset:{display:e=>({property:!0,title:"Reset"})},setAlign:{display:e=>({property:!0,title:"Align",value:`${Object.entries(L).find(t=>t[1]===e)[0]}`})},setFont:{display:e=>({property:!0,title:"Font",value:Object.entries(I).find(t=>Number(e)===t[1])[0]})},setLineSpace:{display:e=>({property:!0,title:"Line-Space",value:e})},setWordGap:{display:e=>({property:!0,title:"Word-Gap",value:e})},setMargin:{display:e=>({property:!0,title:"Margin",value:e})},setDensity:{display:e=>({property:!0,title:"Density",value:e})}};class $o extends zt{constructor(){super();this.socket=null,this.connected=!1}async connect(t=3e3,r="localhost",n=!1){const o=n?"wss":"ws";this.io=await this.ready();const i=this.io(`${o}://${r}:${t}`,{autoConnect:!1,reconnection:!1,secure:n,transports:["websocket"]});this.socket=await new Promise((s,a)=>{i.on("error",l=>{this.emit("error",l)}),i.on("connect_error",l=>{this.emit("error",l),a(l)}),i.on("connect",()=>{this.connected=i.connected,this.emit("connect"),s(i)}),i.on("disconnect",()=>{this.disconnect(),this.emit("disconnect")}),i.connect()})}async ready(){if(this.io)return this.io;const{io:t}=await E(()=>import("./index.c05fa7e4.js"),[]);return this.io=t,t}get host(){var t,r,n;return(n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.hostname}get port(){var t,r,n,o,i,s;return((n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.port)&&Number((s=(i=(o=this.socket)==null?void 0:o.io)==null?void 0:i.opts)==null?void 0:s.port)||void 0}get secure(){var t,r,n;return(n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.secure}promiseEmit(t,r){return new Promise(n=>{this.socket.emit(t,r,n)})}disconnect(){var t;(t=this.socket)==null||t.destroy(),this.socket=null,this.connected=!1}async getInfo(){const t=await this.promiseEmit("getInfo");return console.log("getInfo",t),t}async executeActions(t){t=await Promise.all(t.filter(({visible:n})=>n).map(async n=>"beforePrinterCommand"in ie[n.type]?await ie[n.type].beforePrinterCommand(Object.assign({},n)):n));const r=await this.promiseEmit("executeActions",t);console.log("executeActions",r)}}const je=A.observable(new $o);Pr(je);je.on("error",e=>{Tt.add(e)});Object.defineProperty(A.prototype,"$client",{get(){return je}});class ko{constructor(){this.prompts=[]}prompt(t,r){return new Promise(n=>{const o={title:r,message:t},i=s=>{this.prompts.slice(this.prompts.indexOf(o),1),n(s)};o.callback=i,this.prompts.push(o)})}}const Ao=A.observable(new ko);Object.defineProperty(A.prototype,"$dialog",{get(){return Ao}});A.component("App",Ct);new A({render:e=>e(Ct)}).$mount("#app");export{ie as A,Mn as B,k as C,mo as D,On as E,Go as F,ye as G,Sn as H,Co as I,Oo as J,Xo as K,V as L,No as M,Uo as N,re as O,I as P,E as _,Wo as a,ge as b,Bo as c,Ho as d,Zo as e,ne as f,_n as g,_e as h,ho as i,qo as j,jo as k,be as l,L as m,j as n,X as o,Jo as p,Yo as q,In as r,Ar as s,bn as t,En as u,xn as v,Le as w,Mo as x,J as y,N as z};
