var d=Object.defineProperty,f=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var s=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,i=(e,t)=>{for(var r in t||(t={}))h.call(t,r)&&s(e,r,t[r]);if(o)for(var r of o(t))_.call(t,r)&&s(e,r,t[r]);return e},n=(e,t)=>f(e,v(t));import{n as g,r as l,t as c,u as p,v as w,p as j,w as b}from"./index.cbacc299.js";import{A as D}from"./ActionDialog.5008affe.js";import{I as y}from"./FileSelect.cc1cbe87.js";import{C as I}from"./ImageOptions.97f6e16d.js";import{d as x}from"./Printer.87a47563.js";import{M as C}from"./Dialog.3730f2f3.js";import"./vendor.b1428349.js";import"./devterm.9c60640a.js";import"./buffer.89012e65.js";import"./TextButton.6313e2e7.js";import"./DropDown.f6499f4d.js";import"./CheckBox.7114c94c.js";import"./TextField.080a039c.js";import"./View.c59f2ceb.js";var F=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("action-dialog",e._g(e._b({staticClass:"action-dialog-image",attrs:{title:"Image",form:""},on:{submit:e.onSubmit},scopedSlots:e._u([{key:"default",fn:function(){return[e.previewDataUrl?r("div",{staticClass:"preview"},[r("img",{attrs:{src:e.previewDataUrl}})]):e._e(),r("input-file-select",{attrs:{label:"File"},on:{input:e.onInputFileSelect}}),r("hr"),r("controls-image-options",{model:{value:e.model.imageOptions,callback:function(a){e.$set(e.model,"imageOptions",a)},expression:"model.imageOptions"}})]},proxy:!0}])},"action-dialog",e.$attrs,!1),Object.assign({},e.$listeners,{input:[]})))},O=[];const U={components:{ActionDialog:D,InputFileSelect:y,ControlsImageOptions:I},mixins:[C],inheritAttrs:!1,props:{colors:{type:Object,default(){return{primary:[255,0,0],secondary:[0,255,0]}}},value:{type:Object,default(){return x()}}},data(){return{updateTimeout:null,previewDataUrl:null,model:i({},this.value)}},watch:{model:{handler(){window.clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout(()=>{this.render(),this.$emit("input",i({},this.model))},500)},deep:!0},colors(){this.render()}},mounted(){this.render()},methods:{onInput(e){this.$emit("input",e)},async onInputFileSelect(e){if(e){const t=await new Promise(r=>{const a=new FileReader;a.onload=u=>r(u.target.result),a.readAsDataURL(e)});this.updateCanvas(t)}else this.previewDataUrl=null},async updateCanvas(e){let t=await l(e);t=c(t,b),this.model=n(i({},this.model),{file:p(t)}),this.render()},async render(){let e=await l(this.model.file);e=w(e,this.model.imageOptions),e=j(e,{background:this.colors.printer.preview.background,foreground:this.colors.printer.preview.foreground}),e=c(e,null,100),this.previewDataUrl=p(e)},async loadFromUrl(){try{await this.updateCanvas(this.url)}catch(e){console.error(e)}},onSubmit(e){e.preventDefault(),this.close()}}},m={};var S=g(U,F,O,!1,T,"c21b4794",null,null);function T(e){for(let t in m)this[t]=m[t]}var q=function(){return S.exports}();export{q as default};
