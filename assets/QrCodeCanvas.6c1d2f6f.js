import{p as o,e as c,A as s}from"./devterm.23ce4049.js";import{n as h,p as l}from"./index.ea8592d1.js";import{a as d}from"./Printer.3defcc86.js";import p from"./TextCanvas.941c96db.js";import"./vendor.b1428349.js";import"./View.d0aa6925.js";import"./TextButton.1266465a.js";import"./DropDown.c5bf28cc.js";import"./InputLabel.6abe9ff9.js";import"./Dialog.63a7cd91.js";import"./TextField.b58da684.js";import"./CheckBox.69e0dcf6.js";var m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("preview-text-canvas",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):r("canvas",{ref:"canvas"})],1)},u=[];const v={components:{PreviewTextCanvas:p},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return d()}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$el.height=this.img.naturalHeight,t()},this.img.src=e})},getColor(e){return`rgb(${this.colors.primary.join(" ")} / ${e*100}%)`},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(async()=>{try{const t=o(await c(this.value.text||"empty",this.value.options||{}),this.value.imageOptions);e.canvas.width=this.width,e.canvas.height=t.height;const r=this.width,n=parseInt(this.options.margin*r);let a=0;switch(this.options.align){case s.RIGHT:a+=this.width-t.width;break;case s.CENTER:a+=(this.width-t.width)/2;break;default:a+=n;break}e.drawImage(t,a,0),l(e.canvas,this.colors)}catch(t){this.error=t}})})}}},i={};var f=h(v,m,u,!1,g,"49f579ec",null,null);function g(e){for(let t in i)this[t]=i[t]}var P=function(){return f.exports}();export{P as default};
