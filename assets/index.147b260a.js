var lt=Object.defineProperty;var Se=Object.getOwnPropertySymbols;var ut=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;var xe=(e,t,r)=>t in e?lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,x=(e,t)=>{for(var r in t||(t={}))ut.call(t,r)&&xe(e,r,t[r]);if(Se)for(var r of Se(t))ft.call(t,r)&&xe(e,r,t[r]);return e};import{V as O}from"./vendor.b1428349.js";import{b as dt,f as pt,J as ht,a as vt,E as mt}from"./devterm.956d6268.js";import{b as Ie}from"./buffer.89012e65.js";const yt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};yt();const _t="modulepreload",Ee={},gt="/",R=function(t,r){return!r||r.length===0?t():Promise.all(r.map(n=>{if(n=`${gt}${n}`,n in Ee)return;Ee[n]=!0;const o=n.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const s=document.createElement("link");if(s.rel=o?"stylesheet":_t,o||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),o)return new Promise((a,c)=>{s.addEventListener("load",a),s.addEventListener("error",c)})})).then(()=>t())};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ie=function(e,t){return ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},ie(e,t)};function U(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ie(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function wt(e,t,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(f){try{l(n.next(f))}catch(v){s(v)}}function c(f){try{l(n.throw(f))}catch(v){s(v)}}function l(f){f.done?i(f.value):o(f.value).then(a,c)}l((n=n.apply(e,t||[])).next())})}function Ce(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(f){l=[6,f],o=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function M(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function D(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function j(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function N(e){return this instanceof N?(this.v=e,this):new N(e)}function bt(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(u){n[u]&&(o[u]=function(h){return new Promise(function(y,d){i.push([u,h,y,d])>1||a(u,h)})})}function a(u,h){try{c(n[u](h))}catch(y){v(i[0][3],y)}}function c(u){u.value instanceof N?Promise.resolve(u.value.v).then(l,f):v(i[0][2],u)}function l(u){a("next",u)}function f(u){a("throw",u)}function v(u,h){u(h),i.shift(),i.length&&a(i[0][0],i[0][1])}}function St(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof M=="function"?M(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(s){return new Promise(function(a,c){s=e[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},s)}}function _(e){return typeof e=="function"}function $e(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var se=$e(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function ae(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var q=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return e.prototype.unsubscribe=function(){var t,r,n,o,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=M(s),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(d){t={error:d}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}else s.remove(this);var f=this.initialTeardown;if(_(f))try{f()}catch(d){i=d instanceof se?d.errors:[d]}var v=this._teardowns;if(v){this._teardowns=null;try{for(var u=M(v),h=u.next();!h.done;h=u.next()){var y=h.value;try{ke(y)}catch(d){i=i!=null?i:[],d instanceof se?i=j(j([],D(i)),D(d.errors)):i.push(d)}}}catch(d){n={error:d}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}if(i)throw new se(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)ke(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=(r=this._teardowns)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&ae(r,t)},e.prototype.remove=function(t){var r=this._teardowns;r&&ae(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Oe=q.EMPTY;function Te(e){return e instanceof q||e&&"closed"in e&&_(e.remove)&&_(e.add)&&_(e.unsubscribe)}function ke(e){_(e)?e():e.unsubscribe()}var Y={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},J={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=J.delegate;return((r==null?void 0:r.setTimeout)||setTimeout).apply(void 0,j([],D(e)))},clearTimeout:function(e){var t=J.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Re(e){J.setTimeout(function(){throw e})}function Q(){}var xt=function(){return ce("C",void 0,void 0)}();function It(e){return ce("E",void 0,e)}function Et(e){return ce("N",e,void 0)}function ce(e,t,r){return{kind:e,value:t,error:r}}var K=null;function ee(e){if(Y.useDeprecatedSynchronousErrorHandling){var t=!K;if(t&&(K={errorThrown:!1,error:null}),e(),t){var r=K,n=r.errorThrown,o=r.error;if(K=null,n)throw o}}else e()}var le=function(e){U(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,Te(r)&&r.add(n)):n.destination=Ct,n}return t.create=function(r,n,o){return new te(r,n,o)},t.prototype.next=function(r){this.isStopped?fe(Et(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?fe(It(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?fe(xt,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(q),te=function(e){U(t,e);function t(r,n,o){var i=e.call(this)||this,s;if(_(r))s=r;else if(r){s=r.next,n=r.error,o=r.complete;var a;i&&Y.useDeprecatedNextContext?(a=Object.create(r),a.unsubscribe=function(){return i.unsubscribe()}):a=r,s=s==null?void 0:s.bind(a),n=n==null?void 0:n.bind(a),o=o==null?void 0:o.bind(a)}return i.destination={next:s?ue(s):Q,error:ue(n!=null?n:Pe),complete:o?ue(o):Q},i}return t}(le);function ue(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{e.apply(void 0,j([],D(r)))}catch(o){Re(o)}}}function Pe(e){throw e}function fe(e,t){var r=Y.onStoppedNotification;r&&J.setTimeout(function(){return r(e,t)})}var Ct={closed:!0,next:Q,error:Pe,complete:Q},de=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function $t(e){return e}function Ot(e){return e.length===0?$t:e.length===1?e[0]:function(r){return e.reduce(function(n,o){return o(n)},r)}}var I=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var o=this,i=kt(t)?t:new te(t,r,n);return ee(function(){var s=o,a=s.operator,c=s.source;i.add(a?a.call(i,c):c?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=Ae(r),new r(function(o,i){var s=new te({next:function(a){try{t(a)}catch(c){i(c),s.unsubscribe()}},error:i,complete:o});n.subscribe(s)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[de]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Ot(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=Ae(t),new t(function(n,o){var i;r.subscribe(function(s){return i=s},function(s){return o(s)},function(){return n(i)})})},e.create=function(t){return new e(t)},e}();function Ae(e){var t;return(t=e!=null?e:Y.Promise)!==null&&t!==void 0?t:Promise}function Tt(e){return e&&_(e.next)&&_(e.error)&&_(e.complete)}function kt(e){return e&&e instanceof le||Tt(e)&&Te(e)}function Rt(e){return _(e==null?void 0:e.lift)}function V(e){return function(t){if(Rt(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Z=function(e){U(t,e);function t(r,n,o,i,s){var a=e.call(this,r)||this;return a.onFinalize=s,a._next=n?function(c){try{n(c)}catch(l){r.error(l)}}:e.prototype._next,a._error=i?function(c){try{i(c)}catch(l){r.error(l)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=o?function(){try{o()}catch(c){r.error(c)}finally{this.unsubscribe()}}:e.prototype._complete,a}return t.prototype.unsubscribe=function(){var r,n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))},t}(le),Pt=$e(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),De=function(e){U(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new Le(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new Pt},t.prototype.next=function(r){var n=this;ee(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){var s=n.observers.slice();try{for(var a=M(s),c=a.next();!c.done;c=a.next()){var l=c.value;l.next(r)}}catch(f){o={error:f}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}})},t.prototype.error=function(r){var n=this;ee(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var o=n.observers;o.length;)o.shift().error(r)}})},t.prototype.complete=function(){var r=this;ee(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,o=n.hasError,i=n.isStopped,s=n.observers;return o||i?Oe:(s.push(r),new q(function(){return ae(s,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,o=n.hasError,i=n.thrownError,s=n.isStopped;o?r.error(i):s&&r.complete()},t.prototype.asObservable=function(){var r=new I;return r.source=this,r},t.create=function(r,n){return new Le(r,n)},t}(I),Le=function(e){U(t,e);function t(r,n){var o=e.call(this)||this;return o.destination=r,o.source=n,o}return t.prototype.next=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,r)},t.prototype.error=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&o!==void 0?o:Oe},t}(De),At=new I(function(e){return e.complete()}),pe=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Fe(e){return _(e==null?void 0:e.then)}function Me(e){return _(e[de])}function je(e){return Symbol.asyncIterator&&_(e==null?void 0:e[Symbol.asyncIterator])}function Ne(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Dt(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ve=Dt();function Ge(e){return _(e==null?void 0:e[Ve])}function He(e){return bt(this,arguments,function(){var r,n,o,i;return Ce(this,function(s){switch(s.label){case 0:r=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,N(r.read())];case 3:return n=s.sent(),o=n.value,i=n.done,i?[4,N(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,N(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function ze(e){return _(e==null?void 0:e.getReader)}function G(e){if(e instanceof I)return e;if(e!=null){if(Me(e))return Lt(e);if(pe(e))return Ft(e);if(Fe(e))return Mt(e);if(je(e))return Ue(e);if(Ge(e))return jt(e);if(ze(e))return Nt(e)}throw Ne(e)}function Lt(e){return new I(function(t){var r=e[de]();if(_(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ft(e){return new I(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function Mt(e){return new I(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,Re)})}function jt(e){return new I(function(t){var r,n;try{for(var o=M(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(t.next(s),t.closed)return}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}t.complete()})}function Ue(e){return new I(function(t){Vt(e,t).catch(function(r){return t.error(r)})})}function Nt(e){return Ue(He(e))}function Vt(e,t){var r,n,o,i;return wt(this,void 0,void 0,function(){var s,a;return Ce(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=St(e),c.label=1;case 1:return[4,r.next()];case 2:if(n=c.sent(),!!n.done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),o={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),n&&!n.done&&(i=r.return)?[4,i.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function A(e,t,r,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=t.schedule(function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(i),!o)return i}function Ze(e,t){return t===void 0&&(t=0),V(function(r,n){r.subscribe(new Z(n,function(o){return A(n,e,function(){return n.next(o)},t)},function(){return A(n,e,function(){return n.complete()},t)},function(o){return A(n,e,function(){return n.error(o)},t)}))})}function We(e,t){return t===void 0&&(t=0),V(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function Gt(e,t){return G(e).pipe(We(t),Ze(t))}function Ht(e,t){return G(e).pipe(We(t),Ze(t))}function zt(e,t){return new I(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function Ut(e,t){return new I(function(r){var n;return A(r,t,function(){n=e[Ve](),A(r,t,function(){var o,i,s;try{o=n.next(),i=o.value,s=o.done}catch(a){r.error(a);return}s?r.complete():r.next(i)},0,!0)}),function(){return _(n==null?void 0:n.return)&&n.return()}})}function Be(e,t){if(!e)throw new Error("Iterable cannot be null");return new I(function(r){A(r,t,function(){var n=e[Symbol.asyncIterator]();A(r,t,function(){n.next().then(function(o){o.done?r.complete():r.next(o.value)})},0,!0)})})}function Zt(e,t){return Be(He(e),t)}function Wt(e,t){if(e!=null){if(Me(e))return Gt(e,t);if(pe(e))return zt(e,t);if(Fe(e))return Ht(e,t);if(je(e))return Be(e,t);if(Ge(e))return Ut(e,t);if(ze(e))return Zt(e,t)}throw Ne(e)}function Bt(e,t){return t?Wt(e,t):G(e)}function Xe(e,t){return V(function(r,n){var o=0;r.subscribe(new Z(n,function(i){n.next(e.call(t,i,o++))}))})}var Xt=Array.isArray;function qt(e,t){return Xt(t)?e.apply(void 0,j([],D(t))):e(t)}function Yt(e){return Xe(function(t){return qt(e,t)})}function Jt(e,t,r,n,o,i,s,a){var c=[],l=0,f=0,v=!1,u=function(){v&&!c.length&&!l&&t.complete()},h=function(d){return l<n?y(d):c.push(d)},y=function(d){i&&t.next(d),l++;var m=!1;G(r(d,f++)).subscribe(new Z(t,function(p){o==null||o(p),i?h(p):t.next(p)},function(){m=!0},void 0,function(){if(m)try{l--;for(var p=function(){var w=c.shift();s?A(t,s,function(){return y(w)}):y(w)};c.length&&l<n;)p();u()}catch(w){t.error(w)}}))};return e.subscribe(new Z(t,h,function(){v=!0,u()})),function(){a==null||a()}}function qe(e,t,r){return r===void 0&&(r=1/0),_(t)?qe(function(n,o){return Xe(function(i,s){return t(n,i,o,s)})(G(e(n,o)))},r):(typeof t=="number"&&(r=t),V(function(n,o){return Jt(n,o,e,r)}))}var Qt=["addListener","removeListener"],Kt=["addEventListener","removeEventListener"],er=["on","off"];function W(e,t,r,n){if(_(r)&&(n=r,r=void 0),n)return W(e,t,r).pipe(Yt(n));var o=D(nr(e)?Kt.map(function(a){return function(c){return e[a](t,c,r)}}):tr(e)?Qt.map(Ye(e,t)):rr(e)?er.map(Ye(e,t)):[],2),i=o[0],s=o[1];if(!i&&pe(e))return qe(function(a){return W(a,t,r)})(G(e));if(!i)throw new TypeError("Invalid event target");return new I(function(a){var c=function(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];return a.next(1<l.length?l:l[0])};return i(c),function(){return s(c)}})}function Ye(e,t){return function(r){return function(n){return e[r](t,n)}}}function tr(e){return _(e.addListener)&&_(e.removeListener)}function rr(e){return _(e.on)&&_(e.off)}function nr(e){return _(e.addEventListener)&&_(e.removeEventListener)}function or(e){return e<=0?function(){return At}:V(function(t,r){var n=0;t.subscribe(new Z(r,function(o){++n<=e&&(r.next(o),e<=n&&r.complete())}))})}function he(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new De}:t,n=e.resetOnError,o=n===void 0?!0:n,i=e.resetOnComplete,s=i===void 0?!0:i,a=e.resetOnRefCountZero,c=a===void 0?!0:a;return function(l){var f=null,v=null,u=null,h=0,y=!1,d=!1,m=function(){v==null||v.unsubscribe(),v=null},p=function(){m(),f=u=null,y=d=!1},w=function(){var g=f;p(),g==null||g.unsubscribe()};return V(function(g,E){h++,!d&&!y&&m();var C=u=u!=null?u:r();E.add(function(){h--,h===0&&!d&&!y&&(v=ve(w,c))}),C.subscribe(E),f||(f=new te({next:function(P){return C.next(P)},error:function(P){d=!0,m(),v=ve(p,o,P),C.error(P)},complete:function(){y=!0,m(),v=ve(p,s),C.complete()}}),Bt(g).subscribe(f))})(l)}}function ve(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return t===!0?(e(),null):t===!1?null:t.apply(void 0,j([],D(r))).pipe(or(1)).subscribe(function(){return e()})}W(window,"resize").pipe(he({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1}));W(window,"keypress").pipe(he({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1}));const Qn=W(window,"keyup").pipe(he({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1})),ir=e=>new Promise(t=>{const r=document.createElement("input");r.type="file",r.accept=(e||[]).join(","),r.click(),r.addEventListener("change",n=>{const o=(n.dataTransfer||n.target).files;r.remove(),t(o)})}),sr=e=>{$()&&(e.on("connect",()=>{window.electron.ipcRenderer.invoke("client","connect",!0)}),e.on("disconnect",()=>{window.electron.ipcRenderer.invoke("client","connect",!1)}))},ar=()=>{window.electron.ipcRenderer.invoke("window","minimize")},cr=()=>{window.electron.ipcRenderer.invoke("window","maximize")},lr=e=>{if($())window.electron.ipcRenderer.invoke("window","fullscreen",e);else return e?document.body.requestFullscreen():document.exitFullscreen()},ur=()=>{window.electron.ipcRenderer.invoke("close")},$=()=>"electron"in window,fr=e=>{if($())return window.electron.ipcRenderer.invoke("save",e);{const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","scene.json"),r.click()}},dr=async()=>{if($())return window.electron.ipcRenderer.invoke("load");{const e=await ir("text");return new Promise((t,r)=>{if(e.length){const n=new FileReader;n.addEventListener("load",()=>{try{t(JSON.parse(n.result))}catch(o){r(o)}}),n.readAsText(e[0])}else t()})}},pr=e=>{$()&&window.electron.ipcRendererReceive("dialog",e)},hr=e=>{$()?window.electron.ipcRendererReceive("window",(t,r)=>{switch(t){case"fullscreen":e(r);break}}):window.addEventListener("fullscreenchange",()=>{e(document.fullscreenEnabled)})},vr=()=>$()?window.electron.ipcRenderer.invoke("loadConfig"):JSON.parse(window.localStorage.getItem("config")),mr=e=>$()?window.electron.ipcRenderer.invoke("saveConfig",e):window.localStorage.setItem("config",JSON.stringify(e)),yr=()=>$()?window.electron.ipcRenderer.invoke("getCurrentVersion"):"1.0.0-beta.33",_r=async()=>{const t=(()=>{const n=[],o=[!1,!0],i=[400,500,600,700,800,900];for(let s=0;s<o.length;s++)for(let a=0;a<i.length;a++)n.push({weight:i[a],italic:o[s]});return n})(),r=[{group:"DevTerm",value:'"5x7-ISO8859-1"',name:"5x7-ISO8859-1",variants:[]},{group:"DevTerm",value:'"6x12-ISO8859-1"',name:"6x12-ISO8859-1",variants:[]},{group:"DevTerm",value:'"7x14-ISO8859-1"',name:"7x14-ISO8859-1",variants:[]},{group:"DevTerm",value:'"Px437_CompaqThin_8x16"',name:"Px437_CompaqThin_8x16",variants:[]},{group:"Web",value:"sans-serif",name:"Sans-serif",monospace:!1,variants:t},{group:"Web",value:"serif",name:"Serif",monospace:!1,variants:t},{group:"Web",value:"monospace",name:"Monospace",monospace:!0,variants:t},{group:"Web",value:"fantasy",name:"Fantasy",monospace:!1,variants:t},{group:"Web",value:"cursive",name:"Cursive",monospace:!1,variants:t}];return $()?r.concat(await window.electron.ipcRenderer.invoke("getFonts")):[...r,{group:"System",value:'"Arial"',name:"Arial",monospace:!1,variants:t},{group:"System",value:'"Verdana"',name:"Verdana",monospace:!1,variants:t},{group:"System",value:'"Helvetica"',name:"Helvetica",monospace:!1,variants:t},{group:"System",value:'"Tahoma"',name:"Tahoma",monospace:!1,variants:t},{group:"System",value:'"Trebuchet MS"',name:"Trebuchet MS",monospace:!1,variants:t},{group:"System",value:'"Times New Roman"',name:"Times New Roman",monospace:!1,variants:t},{group:"System",value:'"Georgia"',name:"Georgia",monospace:!1,variants:t},{group:"System",value:'"Garamond"',name:"Garamond",monospace:!1,variants:t},{group:"System",value:'"Courier New"',name:"Courier New",monospace:!0,variants:t},{group:"System",value:'"Brush Script MT"',name:"Brush Script MT",monospace:!1,variants:t}]};var gr=6,Kn=16,me=384,b={SIZE_8_16_THIN_1:0,SIZE_8_16_THIN_2:4,SIZE_5_7:1,SIZE_6_12:2,SIZE_7_14:3},eo={[b.SIZE_5_7]:76,[b.SIZE_6_12]:63,[b.SIZE_7_14]:54,[b.SIZE_8_16_THIN_1]:47,[b.SIZE_8_16_THIN_2]:47},to={[b.SIZE_8_16_THIN_1]:[8,16],[b.SIZE_8_16_THIN_2]:[8,16],[b.SIZE_7_14]:[7,14],[b.SIZE_6_12]:[6,12],[b.SIZE_5_7]:[5,7]},k={LEFT:0,CENTER:1,RIGHT:2},ro=()=>({align:k.LEFT,font:b.SIZE_8_16_THIN_1,margin:0,underline:0,lineSpace:0,density:gr,underLine:0,wordGap:0}),wr="/assets/5x7-ISO8859-1.1e468e9f.ttf",br="/assets/6x12-ISO8859-1.4c4c24d1.ttf",Sr="/assets/7x14-ISO8859-1.b8471bdd.ttf",xr="/assets/Px437_CompaqThin_8x16.ccffc04f.ttf";const Ir=()=>{const e=[["5x7-ISO8859-1",`url(${wr})`],["6x12-ISO8859-1",`url(${br})`],["7x14-ISO8859-1",`url(${Sr})`],["Px437_CompaqThin_8x16",`url(${xr})`]];return Promise.all(e.map(async t=>{console.log("load font",t[0],t[1]);const r=new FontFace(...t);return await r.load(),document.fonts.add(r),r}))},no={[b.SIZE_5_7]:{fontFamily:"5x7-ISO8859-1",fontSize:7},[b.SIZE_6_12]:{fontFamily:"6x12-ISO8859-1",fontSize:12},[b.SIZE_7_14]:{fontFamily:"7x14-ISO8859-1",fontSize:14},[b.SIZE_8_16_THIN_1]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16},[b.SIZE_8_16_THIN_2]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16}};var re,Er=new Uint8Array(16);function Cr(){if(!re&&(re=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!re))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return re(Er)}var $r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Or(e){return typeof e=="string"&&$r.test(e)}var S=[];for(var ye=0;ye<256;++ye)S.push((ye+256).toString(16).substr(1));function Tr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(S[e[t+0]]+S[e[t+1]]+S[e[t+2]]+S[e[t+3]]+"-"+S[e[t+4]]+S[e[t+5]]+"-"+S[e[t+6]]+S[e[t+7]]+"-"+S[e[t+8]]+S[e[t+9]]+"-"+S[e[t+10]]+S[e[t+11]]+S[e[t+12]]+S[e[t+13]]+S[e[t+14]]+S[e[t+15]]).toLowerCase();if(!Or(r))throw TypeError("Stringified UUID is invalid");return r}function kr(e,t,r){e=e||{};var n=e.random||(e.rng||Cr)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return Tr(n)}class Rr{constructor(t){console.log(t);const{id:r,type:n,value:o}=t||{};this.id=r||kr(),this.type=n,this.value=o,this.visible=!0}toJSON(){return{id:this.id,type:this.type,value:this.value,visible:!0}}}var Pr=[{type:"reset"},{id:"6319ab91-5740-49c0-8265-1d05d97014a3",type:"grid",value:{widths:[1,1],data:[[{id:"7d4b8881-37d3-4b80-98e2-dbef273fd320",type:"text",value:{text:`Item 1.
Item 2.
Item 3.
Item 4.`,options:{fontSize:"24",align:"left",lineSpace:"30",wordGap:0,margin:0,fontFamily:null,color:"#000",weight:400,italic:!1},imageOptions:{width:192,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0}],[{id:"cafb2f8d-add1-4c34-9c1e-6f19c63732ac",type:"text",value:{text:`0,00
0,00
0,00
0,00`,options:{fontSize:"24",align:2,lineSpace:"30",wordGap:0,margin:0,fontFamily:null,color:"#000",weight:400,italic:!1},imageOptions:{width:192,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0}]],options:{columnGutter:0,rowGutter:0},imageOptions:{width:null,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0},{type:"feedPitch",value:{value:15,type:"font"}}],Ar=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-menu"},[r("ul",[e._t("default")],2)])},Dr=[];function L(e,t,r,n,o,i,s,a){var c=typeof e=="function"?e.options:e;t&&(c.render=t,c.staticRenderFns=r,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId="data-v-"+i);var l;if(s?(l=function(u){u=u||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!u&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(u=__VUE_SSR_CONTEXT__),o&&o.call(this,u),u&&u._registeredComponents&&u._registeredComponents.add(s)},c._ssrRegister=l):o&&(l=a?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var f=c.render;c.render=function(h,y){return l.call(y),f(h,y)}}else{var v=c.beforeCreate;c.beforeCreate=v?[].concat(v,l):[l]}return{exports:e,options:c}}const Lr={},Je={};var Fr=L(Lr,Ar,Dr,!1,Mr,"760fea24",null,null);function Mr(e){for(let t in Je)this[t]=Je[t]}var jr=function(){return Fr.exports}(),Nr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",e._g({staticClass:"base-generic-button"},e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)},Vr=[];const Gr={props:{text:{type:String,default:"Button Text"}}},Qe={};var Hr=L(Gr,Nr,Vr,!1,zr,"0c7b8858",null,null);function zr(e){for(let t in Qe)this[t]=Qe[t]}var Ur=function(){return Hr.exports}(),Zr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-item",class:{selected:e.selected}},[r("base-generic-button",e._g(e._b({},"base-generic-button",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)],1)},Wr=[];const Br={components:{BaseGenericButton:Ur},inheritAttrs:!1,props:{selected:{type:Boolean,default:!1},text:{type:String,default:null}}},Ke={};var Xr=L(Br,Zr,Wr,!1,qr,"c610198c",null,null);function qr(e){for(let t in Ke)this[t]=Ke[t]}var T=function(){return Xr.exports}(),Yr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",e._g(e._b({staticClass:"app-menu-text"},"li",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[r("span",{domProps:{innerHTML:e._s(e.text)}})]})],2)},Jr=[];const Qr={inheritAttrs:!1,props:{text:{type:String,default:null}}},et={};var Kr=L(Qr,Yr,Jr,!1,en,"da220506",null,null);function en(e){for(let t in et)this[t]=et[t]}var ne=function(){return Kr.exports}(),tn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-spacer"},[e._t("default")],2)},rn=[];const nn={},tt={};var on=L(nn,tn,rn,!1,sn,"d155e842",null,null);function sn(e){for(let t in tt)this[t]=tt[t]}var _e=function(){return on.exports}(),an=function(){var e=this,t=e.$createElement;return e._self._c,e._m(0)},cn=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-divider"},[r("i")])}];const ln={},rt={};var un=L(ln,an,cn,!1,fn,"734250ae",null,null);function fn(e){for(let t in rt)this[t]=rt[t]}var H=function(){return un.exports}(),dn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app",class:{ready:e.ready},style:e.style},[r("app-menu",{staticClass:"header"},e._l(e.headerItems,function(n,o){return r(n.component,e._g(e._b({key:o,tag:"component"},"component",n.props,!1),n.on))}),1),r("div",{staticClass:"app-content"},[!e.$client.connected&&e.ready?r("view-start",{on:{apply:e.onApplyViewStart}}):e.currentView===e.VIEWS.PRINTER?r("view-printer",{attrs:{colors:e.colors},model:{value:e.printerTemplate,callback:function(n){e.printerTemplate=n},expression:"printerTemplate"}}):e.currentView===e.VIEWS.INFO?r("view-info"):e._e()],1),r("app-menu",{staticClass:"footer"},e._l(e.footerItems,function(n,o){return r(n.component,e._g(e._b({key:o,tag:"component"},"component",n.props,!1),n.on))}),1),e._l(e.$errorList.errors,function(n,o){return r("dialog-error",e._b({key:o,attrs:{"init-open":""}},"dialog-error",n,!1))}),e._l(e.$dialog.prompts,function(n,o){return r("dialog-prompt",e._b({key:o,attrs:{"init-open":""}},"dialog-prompt",n,!1))}),e.ready?r("dialog-remote",{ref:"dialogRemote"}):e._e(),e.ready?r("dialog-server",{ref:"dialogServer"}):e._e(),e.ready?r("dialog-options",{ref:"dialogOptions"}):e._e(),e._m(0)],2)},pn=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"display-look"},[r("div",{staticClass:"scanlines"})])}];const F={NONE:null,INFO:"info",START:"start",PRINTER:"priner"},hn={amber:{primary:[255,204,0],secondary:[0,0,0],printer:{preview:{background:[255,204,0],foreground:[0,0,0]}}},green:{primary:[51,255,0],secondary:[0,0,0],printer:{preview:{background:[51,255,0],foreground:[0,0,0]}}},whiteBlack:{primary:[255,255,255],secondary:[0,0,0],printer:{preview:{background:[255,255,255],foreground:[0,0,0]}}},blackWhite:{primary:[0,0,0],secondary:[255,255,255],printer:{preview:{background:[0,0,0],foreground:[255,255,255]}}}};function vn(){return Pr.map(e=>new Rr(e))}const mn={components:{ViewPrinter:()=>R(()=>import("./Printer.3a569ba2.js").then(function(e){return e.P}),["assets/Printer.3a569ba2.js","assets/Printer.97db6c5a.css","assets/View.b8bc9a50.js","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/DropDown.295423ad.js","assets/DropDown.0c5a495a.css","assets/Dialog.d97b64e0.js","assets/Dialog.4ceb527d.css"]),ViewStart:()=>R(()=>import("./Start.c0d635d0.js"),["assets/Start.c0d635d0.js","assets/Start.160e195d.css","assets/View.b8bc9a50.js","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"]),ViewInfo:()=>R(()=>import("./Info.fb0dab70.js"),["assets/Info.fb0dab70.js","assets/Info.e9b5a58c.css","assets/View.b8bc9a50.js","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"]),AppMenu:jr,AppMenuItem:T,AppMenuText:ne,AppMenuSpacer:_e,AppMenuDivider:H,DialogError:()=>R(()=>import("./Error.df93ebf0.js"),["assets/Error.df93ebf0.js","assets/Error.410ad6c5.css","assets/Dialog.d97b64e0.js","assets/Dialog.4ceb527d.css","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"]),DialogRemote:()=>R(()=>import("./Remote.6130e600.js"),["assets/Remote.6130e600.js","assets/Remote.8bf60210.css","assets/DropDown.295423ad.js","assets/DropDown.0c5a495a.css","assets/Dialog.d97b64e0.js","assets/Dialog.4ceb527d.css","assets/CheckBox.53e5e3db.js","assets/CheckBox.7cd14a69.css","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/TextField.86393a8e.js","assets/TextField.70d959fc.css","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"]),DialogServer:()=>R(()=>import("./Server.13d00797.js"),["assets/Server.13d00797.js","assets/Server.9f4b0649.css","assets/DropDown.295423ad.js","assets/DropDown.0c5a495a.css","assets/Dialog.d97b64e0.js","assets/Dialog.4ceb527d.css","assets/Content.0f2dbe74.js","assets/Content.c9d1a7d8.css","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/TextField.86393a8e.js","assets/TextField.70d959fc.css","assets/FileSelect.a58bc28f.js","assets/FileSelect.c1dc4320.css","assets/CheckBox.53e5e3db.js","assets/CheckBox.7cd14a69.css","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"]),DialogOptions:()=>R(()=>import("./Options.f3cff930.js"),["assets/Options.f3cff930.js","assets/Options.a51b9648.css","assets/DropDown.295423ad.js","assets/DropDown.0c5a495a.css","assets/Dialog.d97b64e0.js","assets/Dialog.4ceb527d.css","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/TextField.86393a8e.js","assets/TextField.70d959fc.css","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"]),DialogPrompt:()=>R(()=>import("./Prompt.5add77ad.js"),["assets/Prompt.5add77ad.js","assets/Prompt.ab067b15.css","assets/Dialog.d97b64e0.js","assets/Dialog.4ceb527d.css","assets/TextButton.9479af49.js","assets/TextButton.eb761bd1.css","assets/vendor.b1428349.js","assets/devterm.956d6268.js","assets/buffer.89012e65.js"])},data(){return{VIEWS:F,currentView:F.PRINTER,ready:!1,fullscreen:!1,printerTemplate:vn()}},computed:{headerItems(){const e=[{component:T,on:{click:this.onClickNew},props:{text:"New"}},{component:H},{component:T,on:{click:this.onClickSave},props:{text:"Save"}},{component:T,title:"Load",on:{click:this.onClickLoad},props:{text:"Load"}},{component:H}];return[...this.$client.connected&&[{component:T,on:{click:()=>this.currentView=F.INFO},props:{selected:this.currentView===F.INFO,text:"Info"}},{component:T,on:{click:()=>this.currentView=F.PRINTER},props:{selected:this.currentView===F.PRINTER,text:"Printer"}}]||[],{component:_e},...this.$client.connected&&this.currentView===F.PRINTER&&e||[],{component:T,on:{click:this.onClickOptions},props:{text:"Options"}},$()&&[{component:H},{component:T,on:{click:this.onClickClose},props:{text:"Close"}}]].flat().filter(Boolean)},footerItems(){return[$()&&[{component:T,on:{click:this.onClickMinimizeWindow},props:{text:"Minimize"}},{component:T,on:{click:this.onClickMaximizeWindow},props:{text:"Maximize"}}].flat(),{component:T,on:{click:this.onClickFullscreen},props:{selected:this.fullscreen,text:"Fullscreen"}},{component:_e},this.hasServer&&[{component:ne,on:{click:this.showServerDialog},props:{class:{connection:!0,connected:this.$server.options.active},text:`${this.$server.options.active?`Server (*:${this.$server.options.port}${this.$server.options.secure?"/SSL":""})`:"Server Offline"}`}},{component:H}],{component:ne,on:{click:this.showRemoteDialog},props:{class:{connection:!0,connected:this.clientConnected},text:`${this.clientConnected?`Online (${this.$client.host}:${this.$client.port}${this.$client.secure?"/SSL":""})`:"Offline"}`}},{component:H},{component:ne,on:{click:()=>{window.open("https://github.com/ThornWalli/devterm-toolbox/releases")}},props:{class:"info-version",text:this.version}}].flat().filter(Boolean)},hasServer(){return!this.$server.disabled},version(){return this.$config.version},colors(){return hn[this.$config.data.theme]},clientConnected(){return this.$client.connected},style(){return x(x({"--color-primary":`rgb(${this.colors.primary.join(",")})`,"--color-secondary":`rgb(${this.colors.secondary.join(",")})`},Object.fromEntries(Array(10).fill("").map((e,t)=>[`--color-primary-${(t+1)*10}`,`rgb(${this.colors.primary.join(" ")} / ${(t+1)*10}%)`]))),Object.fromEntries(Array(10).fill("").map((e,t)=>[`--color-secondary-${(t+1)*10}`,`rgb(${this.colors.secondary.join(" ")} / ${(t+1)*10}%)`])))}},async mounted(){await Ir(),await this.$config.init(),await this.$server.init(),this.hasServer&&await this.$server.refresh(),await this.$config.load();const e=this.$config.get("profiles").find(({name:t})=>t===this.$config.get("profile"));if(e){const{port:t,host:r,ssl:n,secure:o}=e;if(this.$config.get("startType")&&t)try{this.$server&&this.$config.get("startType")==="local"&&!this.$server.options.active&&await this.$server.start(t,n),r&&await this.$client.connect(t,r,o)}catch{}}this.ready=!0,this.registerListeners()},methods:{registerListeners(){hr(e=>{this.fullscreen=e}),pr((e,t)=>{switch(e){case"open":switch(t){case"options":this.showOptionsDialog();break;case"remote":this.showRemoteDialog();break;case"server":this.showServerDialog();break}break}})},onClickMinimizeWindow(){return ar()},onClickMaximizeWindow(){return cr()},onClickFullscreen(){return lr(!this.fullscreen)},onClickClose(){return ur()},onClickNew(){this.printerTemplate=[]},onClickSave(){return fr(this.printerTemplate)},async onClickLoad(){try{const e=await dr();e&&(this.printerTemplate=e)}catch(e){this.$errorList.add(e)}},onClickOptions(){this.showOptionsDialog()},async onApplyViewStart({type:e}){this.$config.set("startType",e);let t={};switch(e){case"local":t=await this.showServerDialog();break;case"remote":t=await this.showRemoteDialog();break}const{profile:r}=t||{};r&&(this.$config.set("profile",r),await this.$config.save())},showServerDialog(){return this.$refs.dialogServer.show()},showRemoteDialog(){return this.$refs.dialogRemote.show()},showOptionsDialog(){return this.$refs.dialogOptions.show()}}},nt={};var yn=L(mn,dn,pn,!1,_n,"1608c634",null,null);function _n(e){for(let t in nt)this[t]=nt[t]}var ot=function(){return yn.exports}();class gn{constructor(){this.errors=[]}add(t,r){typeof t=="object"&&(console.error(t),t.message?(t.type&&(r=t.type),t=t.message):t=JSON.stringify(t));const n={title:r,message:t},o=()=>{this.errors.slice(this.errors.indexOf(n),1)};n.callback=o,this.errors.push(n)}}const it=O.observable(new gn);Object.defineProperty(O.prototype,"$errorList",{get(){return it}});const oo=512,oe=()=>({theme:"amber",startType:null,ssl:{key:null,cert:null,pfx:null,passphrase:null},profiles:[]}),wn=()=>({name:null,port:3e3,host:null,secure:!1,ssl:{key:null,cert:null,pfx:null,passphrase:null}}),io="localhost",bn="Profile Default";class Sn{constructor(){this.data=oe(),this.version=null,this.fonts=[]}async init(){this.version=await yr(),this.fonts=await _r()}toJSON(){return Object.assign({},this.data,{version:this.version})}get(t){return this.data[t]}set(t,r){typeof t=="string"?this.data[t]=r:typeof t=="object"&&Object.entries(t).forEach(([n,o])=>this.set(n,o))}save(){return mr(this.toJSON())}reset(){return this.data=oe(),this.save()}async load(){let t;try{t=await vr()}catch{t=oe()}return console.log(t),this.data=Object.assign(oe(),t)}saveProfile(t){t.name=t.name||bn;const r=this.get("profiles");let n=this.get("profiles").find(({name:o})=>o===t.name);return n?(console.log("update profile",n.name,n),r[r.indexOf(n)]=x(x({},n),t)):(console.log("create profile",t.name,t),n=x(x({},wn()),t),r.push(n)),this.set("profiles",r),this.save()}deleteProfile(t){const r=this.get("profiles"),n=this.get("profiles").find(({name:o})=>o===t);return r.slice(r.indexOf(n),1),this.set("profiles",r),this.save()}}const xn=O.observable(new Sn);Object.defineProperty(O.prototype,"$config",{get(){return xn}});Object.defineProperty(O.prototype,"$server",{get(){return{init(){return Promise.resolve()},disabled:!0}}});var In=384,{createCanvas:z,loadImage:so,Canvas:ao}=dt,En=()=>({width:null,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}),B=(e,t)=>(t=x(x({},En()),t),t.rotate&&(e=kn(e)),e=On(e,t.width),(t.flipX||t.flipY)&&(e=Tn(e,t.flipX,t.flipY)),t.invert&&(e=$n(e)),t.grayscale&&(e=Rn(e)),e=Cn(e),e),Cn=e=>{const t=e.getContext("2d"),r=t.getImageData(0,0,t.canvas.width,t.canvas.height),n=r.data;for(let o=0;o<n.length;o+=4)n[o+3]===0&&(n[o]=255,n[o+1]=255,n[o+2]=255,n[o+3]=255);return t.putImageData(r,0,0),e},$n=e=>{const t=e.getContext("2d"),r=t.getImageData(0,0,t.canvas.width,t.canvas.height),n=r.data;for(let o=0;o<n.length;o+=4)n[o]=255-n[o],n[o+1]=255-n[o+1],n[o+2]=255-n[o+2];return t.putImageData(r,0,0),e},On=(e,t)=>{t=Math.min(e.width,Math.min(t||e.width,In));const r=t*(e.height/e.width),n=z(t,r);return n.getContext("2d").drawImage(e,0,0,t,r),n},Tn=(e,t,r)=>{const n=z(e.width,e.height),o=n.getContext("2d");console.log(1-t*2,1-r*2);const i=1-t*2,s=1-r*2;return o.translate(t*e.width,r*e.height),o.scale(i,s),o.drawImage(e,0,0,e.width,e.height),n},kn=e=>{let t=e.getContext("2d");const r=z(e.height,e.width);return t=r.getContext("2d"),t.translate(e.height,0),t.rotate(Math.PI/2),t.drawImage(e,0,0),r},Rn=e=>{const t=e.getContext("2d");return t.putImageData(pt(t.getImageData(0,0,e.width,e.height)),0,0),e},Pn=(e,t)=>{const r=z();try{return ht(r,e,t),r}catch(n){throw new Error(n)}};async function An(e,t={}){t=x({margin:0},t);const r=z(t.width||1,t.width||1);return new Promise(n=>{vt.toCanvas(r,e,t,o=>{if(o)throw o;n(r)})})}var ge=9224,st=29,Dn=function(e){const t=Ie.Buffer.alloc(e.byteLength),r=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=r[n];return t},at=(e,t)=>{const r=e/8%256,n=e/8/256,o=t%256,i=t/256,s=(r+256*n)*(o+256*i);return{xL:r,xH:n,yL:o,yH:i,k:s}},Ln=(e,t)=>{const{k:r}=at(e,1),n=ge/r;return Math.ceil(t/n)},Fn=e=>{const t=e.getContext("2d"),r=Ln(e.width,e.height),n=[];for(let o=0;o<r;o++)n.push(t.getImageData(0,e.height/r*o,e.width,e.height/r));return n};function Mn(e){const t=(n,o)=>{const i=(o*e.width+n)*4,s=e.data;return{r:s[i],g:s[i+1],b:s[i+2],a:s[i+3]}},r=[];for(let n=0;n<e.height;n++){r[n]=r[n]||[];for(let o=0;o<e.width;o++)r[n][o]=t(o,n)}return r}var jn=e=>{const t=[],{width:r,height:n}=e,o=Mn(e);for(let i=0;i<n;i++){t[i]=new Uint8Array(Math.round(r/8));for(let s=0;s<t[i].length;s++){t[i][s]=0;for(let a=0;a<8;a++){const{r:c,g:l,b:f,a:v}=o[i][s*8+a]||{r:255,g:255,b:255,a:255};((c+l+f)/3/255<.6||v<.6)&&(t[i][s]|=1<<7-a)}}}return t},Nn=(e,t)=>{const{xL:r,xH:n,yL:o,yH:i,k:s}=at(e,t),a=[st,118,48,0,r,n,o,i];if(a[0]===st&&a[1]===118&&a[2]===48&&!(s<=ge))throw new Error(`Image too large; ${s} > ${ge}`);return a},Vn=async e=>(await Fn(e)).map(n=>{const o=jn(n);return[Ie.Buffer.from(Nn(o[0].length*8,n.height))].concat(o.map(i=>Dn(i)))}).flat();const co=e=>{const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL("image/png",100)},Gn=(e,t,r)=>{if(t){if(e.width<=t)return e;r=t*(e.height/e.width)}else{if(e.height<=r)return e;t=r*(e.width/e.height)}const n=new OffscreenCanvas(t,r);return n.getContext("2d").drawImage(e,0,0,t,r),n},Hn=async e=>{const t=new window.Image;await new Promise(o=>{t.onload=()=>o(t),t.src=e,t.crossOrigin="anonymous"});const r=new OffscreenCanvas(t.naturalWidth,t.naturalHeight);return r.getContext("2d").drawImage(t,0,0),r},lo=(e,t,r=1,n=!0)=>{e=Gn(e,me);const o=e.getContext("2d"),i=o.getImageData(0,0,o.canvas.width,o.canvas.height);return n&&zn(i.data,[t.foreground,t.background],r),o.putImageData(i,0,0),e},zn=(e,t,r)=>{for(let n=0;n<e.length;n+=4)(e[n]+e[n+1]+e[n+2])/3/255<.6?(e[n]=t[0][0],e[n+1]=t[0][1],e[n+2]=t[0][2],e[n+3]=parseInt(e[n+3]*r)):(e[n]=t[1][0],e[n+1]=t[1][1],e[n+2]=t[1][2],e[n+3]=parseInt(e[n+3]*r))},X=e=>Vn(e),Un=(e,t,r,n)=>{console.log("drawText",e,t,r,n),n=x({background:[255,255,255],foreground:[0,0,0]},n);const{fontSize:o,align:i,lineSpace:s,wordGap:a,margin:c,fontFamily:l,weight:f,italic:v}=x({fontSize:12,align:k.LEFT,wordGap:0,lineSpace:0,margin:0,fontFamily:"sans-serif",color:"#000",weight:400,italic:!1},t),u=[0,r*c,0,0];let h=0,y=r;switch(i){case k.RIGHT:h+=r,y-=u[1];break;case k.CENTER:h+=y/2;break;default:h+=u[1],y-=u[1];break}const d=`${v?"italic ":""}${f} ${o}px ${l}`,m=document.createElement("canvas");m.style.display="none",document.body.append(m);const p=m.getContext("2d");p.canvas.style.letterSpacing=`${a}px`,p.font=d;const w=Math.max(s,o)/o,g=e.split(`
`).map(C=>ct(p,C,0,0,o,y)).flat(),E=g.length*o*w+u[0]+u[2];if(!r)switch(r=parseInt(e.split(`
`).reduce((C,P)=>Math.max(p.measureText(P).width,C),0)),h=0,i){case k.RIGHT:h+=r;break;case k.CENTER:h+=r/2;break}return m.width=r,p.font=d,m.height=E,p.fillStyle=`rgb(${n.background.join(" ")})`,p.fillRect(0,0,m.width,m.height),p.fillStyle=`rgb(${n.foreground.join(" ")})`,p.textBaseline="top",p.font=d,p.canvas.style.letterSpacing=`${a}px`,p.textAlign={[k.LEFT]:"left",[k.CENTER]:"center",[k.RIGHT]:"right"}[Number(i)],p.translate(0,u[0]),g.forEach((C,P)=>{p.fillText(C,h,P*w*o-(o-w*o)/2)}),m.remove(),m};function ct(e,t,r,n,o,i,s=[]){if(i=i||0,i<=0)return[t];for(let a=1;a<=t.length;a++){const c=t.substr(0,a);if(e.measureText(c).width>i)return s.push(t.substr(0,a-1)),s=s.concat(ct(e,t.substr(a-1),r,n+o,o,i)),s}return s.push(t),s}var we={cutLine:{display:()=>({title:"Cut Line"})},grid:{display:e=>({title:"Grid",value:e.text}),beforePrinterCommand:async(e,t=!0)=>{const{widths:r,data:n,options:o,imageOptions:i}=e.value,s=(i==null?void 0:i.width)||me,{columnGutter:a,rowGutter:c}=x({columnGutter:12,rowGutter:12},o);let l=r.filter(d=>d<1).reduce((d,m)=>d+(1-m),0);l/=r.filter(d=>d===1).length;const f=await Promise.all(n.map(async(d,m)=>{const p=n.length-1;return await Promise.all(d.map(w=>{let g=parseInt(s/n.length)*r[m];r[m]===1&&(g+=parseInt(s/n.length)*l),p>0&&(g=g-a*p/n.length);const{value:E}=w;return console.log("columnWidth",g,E.imageOptions),(E.imageOptions=E.imageOptions||{}).width=g,we[String(w.type)].beforePrinterCommand(x({},w),!1)}))})),v=f.reduce((d,m)=>{const p=m.length-1;return Math.max(m.reduce((w,{value:g})=>w+g.height,p*c),d)},1);let u=z(s,v);const h=u.getContext("2d");let y=0;return f.forEach((d,m)=>{let p=0;y+=d.reduce((g,{value:E},C)=>(h.drawImage(E,y,p),p+=E.height+(C<d.length?c:0),Math.max(E.width,g)),0)+(m<f.length?a:0)}),u=B(u,i),e.value=t?await X(u):u,e}},barcode:{display:e=>({title:"Barcode",value:e.text}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value;let i=await Pn(r||"empty",n||{});return i=B(i,o),e.value=t?await X(i):i,e}},qrCode:{display:e=>({title:"QR Code",value:e.text}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value,i=x({},n);i.width=n.width||o.width;let s=await An(r||"empty",i);return s=B(s,o),e.value=t?await X(s):s,e}},image:{display:()=>({title:"Image"}),beforePrinterCommand:async(e,t=!0)=>{const{file:r,imageOptions:n}=e.value;let o=await Hn(r);return o=B(o,n),e.value=t?await X(o):o,e}},text:{display:e=>({title:"Text",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value;let i=await Un(r||"empty",n||{},(o==null?void 0:o.rotate)?null:(o==null?void 0:o.width)||me);return i=B(i,o),e.value=t?await X(i):i,e}},nativeText:{display:e=>({title:"Native Text",value:`${e.slice(0,16)}\u2026`})},feedPitch:{display:({type:e,value:t})=>({title:"Feed-Pitch",value:`${e} | ${t}`})},reset:{display:e=>({property:!0,title:"Reset"})},setAlign:{display:e=>({property:!0,title:"Align",value:`${Object.entries(k).find(t=>t[1]===e)[0]}`})},setFont:{display:e=>({property:!0,title:"Font",value:Object.entries(b).find(t=>Number(e)===t[1])[0]})},setLineSpace:{display:e=>({property:!0,title:"Line-Space",value:e})},setWordGap:{display:e=>({property:!0,title:"Word-Gap",value:e})},setMargin:{display:e=>({property:!0,title:"Margin",value:e})},setDensity:{display:e=>({property:!0,title:"Density",value:e})}};class Zn extends mt{constructor(){super();this.socket=null,this.connected=!1}async connect(t=3e3,r="localhost",n=!1){const o=n?"wss":"ws";this.io=await this.ready();const i=this.io(`${o}://${r}:${t}`,{autoConnect:!1,reconnection:!1,secure:n,transports:["websocket"]});this.socket=await new Promise((s,a)=>{i.on("error",c=>{this.emit("error",c)}),i.on("connect_error",c=>{this.emit("error",c),a(c)}),i.on("connect",()=>{this.connected=i.connected,this.emit("connect"),s(i)}),i.on("disconnect",()=>{this.disconnect(),this.emit("disconnect")}),i.connect()})}async ready(){if(this.io)return this.io;const{io:t}=await R(()=>import("./index.c05fa7e4.js"),[]);return this.io=t,t}get host(){var t,r,n;return(n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.hostname}get port(){var t,r,n,o,i,s;return((n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.port)&&Number((s=(i=(o=this.socket)==null?void 0:o.io)==null?void 0:i.opts)==null?void 0:s.port)||void 0}get secure(){var t,r,n;return(n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.secure}promiseEmit(t,r){return new Promise(n=>{this.socket.emit(t,r,n)})}disconnect(){var t;(t=this.socket)==null||t.destroy(),this.socket=null,this.connected=!1}async getInfo(){const t=await this.promiseEmit("getInfo");return console.log("getInfo",t),t}async executeActions(t){t=await Promise.all(t.filter(n=>n.visible).map(async n=>"beforePrinterCommand"in we[n.type]?await we[n.type].beforePrinterCommand(Object.assign({},n)):n));const r=await this.promiseEmit("executeActions",t);console.log("executeActions",r)}}const be=O.observable(new Zn);sr(be);be.on("error",e=>{it.add(e)});Object.defineProperty(O.prototype,"$client",{get(){return be}});class Wn{constructor(){this.prompts=[]}prompt(t,r){return new Promise(n=>{const o={title:r,message:t},i=s=>{this.prompts.slice(this.prompts.indexOf(o),1),n(s)};o.callback=i,this.prompts.push(o)})}}const Bn=O.observable(new Wn);Object.defineProperty(O.prototype,"$dialog",{get(){return Bn}});O.component("App",ot);new O({render:e=>e(ot)}).$mount("#app");export{Rr as A,Ur as B,gr as D,b as F,eo as M,Z as O,R as _,En as a,k as b,bn as c,we as d,wn as e,W as f,ro as g,io as h,oe as i,no as j,Qn as k,Un as l,Kn as m,L as n,V as o,lo as p,to as q,Hn as r,ir as s,Gn as t,co as u,B as v,oo as w};
