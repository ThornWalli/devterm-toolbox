var f=Object.defineProperty;var i=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;var a=(t,s,e)=>s in t?f(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,n=(t,s)=>{for(var e in s||(s={}))h.call(s,e)&&a(t,e,s[e]);if(i)for(var e of i(s))d.call(s,e)&&a(t,e,s[e]);return t};import{n as m,D as v,h as l}from"./index.3ebecd76.js";import{A as b,M as x}from"./Dialog.e975e9c0.js";import{B as _,I as y}from"./DropDown.2e9a6a89.js";import{A as g,B as I}from"./Content.ae14dae4.js";import{I as k}from"./TextButton.8513f5f2.js";import{I as C}from"./TextField.4915792e.js";import{I as S}from"./FileSelect.d9b7a49e.js";import{I as P}from"./CheckBox.3b0ee6ff.js";import"./vendor.b1428349.js";import"./devterm.9e5b33a4.js";import"./buffer.4460b8ba.js";var D=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("app-dialog",t._g(t._b({ref:"dialog",staticClass:"dialog-server",attrs:{title:"Server",form:""},on:{submit:t.onSubmit},scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"profile-select"},[e("input-drop-down",{attrs:{"baseline-label":"",label:"Profile",options:t.profileOptions},model:{value:t.selectedProfile,callback:function(o){t.selectedProfile=o},expression:"selectedProfile"}}),e("input-text-button",{attrs:{color:"primary",disabled:!t.selectedProfile,text:"Delete"},on:{click:t.onClickDeleteProfile}})],1),e("input-text-field",{attrs:{label:"Profile Name"},model:{value:t.profileName,callback:function(o){t.profileName=o},expression:"profileName"}}),e("hr"),e("app-tab-container",{staticClass:"tab-container",scopedSlots:t._u([{key:"general",fn:function(o){return[e("base-tab-container-content",t._b({attrs:{title:"General"}},"base-tab-container-content",o,!1),[e("base-input-label",{attrs:{text:"Status"}},[e("span",{staticClass:"status",class:{active:t.active}},[t._v(t._s(t.active?"listening on *:"+t.$server.options.port:"Offline"))])]),e("base-input-label",{attrs:{text:"Active Sessions"}},[e("span",[t._v(t._s(t.$server.options.activeSessions))])]),e("input-drop-down",{attrs:{"baseline-label":"",size:"5",label:"For SSL, select valid host",options:t.hostsOptions},model:{value:t.host,callback:function(r){t.host=r},expression:"host"}}),e("input-text-field",{attrs:{type:"Number",label:"Port",min:"1024",step:"1",value:t.port},on:{input:function(r){t.port=parseInt(r)}}}),t.active?t._e():e("input-check-box",{attrs:{label:"Auto connect"},model:{value:t.autoConnect,callback:function(r){t.autoConnect=r},expression:"autoConnect"}})],1)]}},{key:"ssl",fn:function(o){return[e("base-tab-container-content",t._b({attrs:{title:"SSL"}},"base-tab-container-content",o,!1),[e("input-file-select",{attrs:{label:"Key",accept:[".key",".pem"],value:t.ssl.key},on:{input:function(r){t.ssl.key=r?r.path:null}}}),e("input-file-select",{attrs:{label:"Cert",accept:[".cert",".crt",".pem"],value:t.ssl.cert},on:{input:function(r){t.ssl.cert=r?r.path:null}}}),e("input-file-select",{attrs:{label:"PFX",accept:[".pfx"],value:t.ssl.pfx},on:{input:function(r){t.ssl.pfx=r?r.path:null}}}),e("input-text-field",{attrs:{placeholder:"Passphrase",label:"Passphrase"},model:{value:t.ssl.passphrase,callback:function(r){t.$set(t.ssl,"passphrase",r)},expression:"ssl.passphrase"}})],1)]}}])})]},proxy:!0},{key:"buttons",fn:function(){return[t.active?e("input-text-button",{attrs:{color:"primary",text:"Stop"},on:{click:t.onClickStop}}):e("input-text-button",{attrs:{type:"submit",color:"primary",text:"Start"}}),e("input-text-button",{attrs:{color:"secondary",text:"Close"},on:{click:function(o){return t.close()}}})]},proxy:!0}])},"app-dialog",t.$attrs,!1),t.$listeners))},$=[];const w={components:{AppDialog:b,BaseInputLabel:_,AppTabContainer:g,BaseTabContainerContent:I,InputTextButton:k,InputTextField:C,InputDropDown:y,InputCheckBox:P,InputFileSelect:S},mixins:[x],inheritAttrs:!1,data(){return{host:null,port:3e3,refreshIntervalDuration:3e3,refreshInterval:null,autoConnect:!0,ssl:{key:null,cert:null,pfx:null,passphrase:null},selectedProfile:this.$config.get("profile"),profileName:v}},computed:{active(){return this.$server.options.active},profileOptions(){return[{title:"Select Profile\u2026",value:""},...this.$config.get("profiles")].map(t=>new l(t.name||t))},hostsOptions(){return this.$server.options.hosts.map(t=>new l(t))}},watch:{selectedProfile:{handler(t,s){if(t&&t!==s){const{name:e,port:o,host:r,ssl:p}=this.$config.get("profiles").find(({name:u})=>u===t);this.profileName=e,this.port=o,this.host=r,this.ssl=n({},p)}},immediate:!0},open(t){this.toggleRefreshInterval(t)}},destroy(){this.toggleRefreshInterval(!1)},methods:{toggleRefreshInterval(t){t?(this.$server.refresh(),this.refreshInterval=window.setInterval(()=>{this.$server.refresh()},this.refreshIntervalDuration)):window.clearInterval(this.refreshInterval)},async onSubmit(t){t.preventDefault();try{await this.$server.start(this.port,this.ssl);const s=Object.values(this.ssl).find(Boolean);return this.autoConnect&&await this.$client.connect(this.port,this.host||this.$server.options.hosts[0],s),await this.$config.saveProfile({name:this.profileName,port:this.port,host:this.host,secure:s,ssl:n({},this.ssl)}),this.close({profile:this.profileName})}catch(s){this.$errorList.add(s)}},async onClickStop(){try{await this.$server.stop()}catch(t){this.$errorList.add(t)}},async onClickDeleteProfile(){await this.$config.deleteProfile(this.selectedProfile),this.selectedProfile=null}}},c={};var j=m(w,D,$,!1,B,"93218f26",null,null);function B(t){for(let s in c)this[s]=c[s]}var U=function(){return j.exports}();export{U as default};
