var m=Object.defineProperty,v=Object.defineProperties;var g=Object.getOwnPropertyDescriptors;var n=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var o=(e,t,a)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,h=(e,t)=>{for(var a in t||(t={}))f.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))_.call(t,a)&&o(e,a,t[a]);return e},c=(e,t)=>v(e,g(t));import{n as w,p as b,v as x,A as l,a as j}from"./index.a368ccdb.js";import{a as C}from"./Printer.65619e84.js";import y from"./TextCanvas.1d157ae6.js";import"./vendor.b1428349.js";import"./devterm.a10f71a8.js";import"./View.ffaeb85b.js";import"./TextButton.3d91a0e8.js";import"./TextField.8dd3b75b.js";import"./Dialog.3e6e57b7.js";import"./CheckBox.48ef8714.js";import"./FileSelect.2e073e96.js";var I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.error?a("preview-text-canvas",{attrs:{value:e.error.message,colors:e.colors,options:e.options}}):a("canvas",{ref:"canvas"})],1)},T=[];const O={components:{PreviewTextCanvas:y},props:{colors:{type:Object,default(){return{base:[255,0,0]}}},value:{type:Object,default(){return C()}},width:{type:Number,default:384},options:{type:Object,default(){return{}}}},data(){return{error:null,ctx:null}},watch:{async value(){this.value.file&&await this.changeImage(this.value.file),this.render()}},async mounted(){this.value.file&&await this.changeImage(this.value.file),this.render()},methods:{changeImage(e){return new Promise(t=>{this.img=document.createElement("img"),this.img.onload=()=>{this.$el.height=this.img.naturalHeight,t()},this.img.src=e})},getColor(e){return`rgb(${this.colors.primary.join(" ")} / ${e*100}%)`},render(){this.error=null,this.$nextTick(()=>{const e=this.$refs.canvas.getContext("2d");window.requestAnimationFrame(async()=>{var t,a;try{const s=((t=this.value.options)==null?void 0:t.width)||((a=this.value.imageOptions)==null?void 0:a.width),r=b(await x(this.value.text||"empty",c(h({},this.value.options||{}),{width:s})),this.value.imageOptions);e.canvas.width=this.width,e.canvas.height=r.height;const u=this.width,p=parseInt(this.options.margin*u);let i=0;switch(this.options.align){case l.RIGHT:i+=this.width-r.width;break;case l.CENTER:i+=(this.width-r.width)/2;break;default:i+=p;break}e.drawImage(r,i,0),j(e.canvas,this.colors)}catch(s){this.error=s}})})}}},d={};var $=w(O,I,T,!1,k,"b2e02fd6",null,null);function k(e){for(let t in d)this[t]=d[t]}var S=function(){return $.exports}();export{S as default};
