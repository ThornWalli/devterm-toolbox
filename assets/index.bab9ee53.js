var Et=Object.defineProperty,It=Object.defineProperties;var Ct=Object.getOwnPropertyDescriptors;var Re=Object.getOwnPropertySymbols;var Ot=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable;var Ae=(e,t,r)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))Ot.call(t,r)&&Ae(e,r,t[r]);if(Re)for(var r of Re(t))Tt.call(t,r)&&Ae(e,r,t[r]);return e},he=(e,t)=>It(e,Ct(t));var Le=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var A=(e,t,r)=>(Le(e,t,"read from private field"),r?r.call(e):t.get(e)),ee=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},te=(e,t,r,n)=>(Le(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{V as $}from"./vendor.b1428349.js";import{f as $t,J as kt,b as Pt,a as Rt,E as At}from"./devterm.9c60640a.js";import{b as De}from"./buffer.89012e65.js";const Lt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};Lt();const Dt="modulepreload",Fe={},Ft="/",S=function(t,r){return!r||r.length===0?t():Promise.all(r.map(n=>{if(n=`${Ft}${n}`,n in Fe)return;Fe[n]=!0;const o=n.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const s=document.createElement("link");if(s.rel=o?"stylesheet":Dt,o||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),o)return new Promise((a,l)=>{s.addEventListener("load",a),s.addEventListener("error",l)})})).then(()=>t())};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var me=function(e,t){return me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},me(e,t)};function Y(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");me(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function jt(e,t,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(f){try{c(n.next(f))}catch(m){s(m)}}function l(f){try{c(n.throw(f))}catch(m){s(m)}}function c(f){f.done?i(f.value):o(f.value).then(a,l)}c((n=n.apply(e,t||[])).next())})}function je(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(f){return l([c,f])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(f){c=[6,f],o=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function N(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function F(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function V(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function G(e){return this instanceof G?(this.v=e,this):new G(e)}function Mt(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(u){n[u]&&(o[u]=function(h){return new Promise(function(g,p){i.push([u,h,g,p])>1||a(u,h)})})}function a(u,h){try{l(n[u](h))}catch(g){m(i[0][3],g)}}function l(u){u.value instanceof G?Promise.resolve(u.value.v).then(c,f):m(i[0][2],u)}function c(u){a("next",u)}function f(u){a("throw",u)}function m(u,h){u(h),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Nt(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof N=="function"?N(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(s){return new Promise(function(a,l){s=e[i](s),o(a,l,s.done,s.value)})}}function o(i,s,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},s)}}function y(e){return typeof e=="function"}function Me(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var _e=Me(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function ge(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var re=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return e.prototype.unsubscribe=function(){var t,r,n,o,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=N(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(p){t={error:p}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}else s.remove(this);var f=this.initialTeardown;if(y(f))try{f()}catch(p){i=p instanceof _e?p.errors:[p]}var m=this._teardowns;if(m){this._teardowns=null;try{for(var u=N(m),h=u.next();!h.done;h=u.next()){var g=h.value;try{Ge(g)}catch(p){i=i!=null?i:[],p instanceof _e?i=V(V([],F(i)),F(p.errors)):i.push(p)}}}catch(p){n={error:p}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}if(i)throw new _e(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Ge(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=(r=this._teardowns)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&ge(r,t)},e.prototype.remove=function(t){var r=this._teardowns;r&&ge(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Ne=re.EMPTY;function Ve(e){return e instanceof re||e&&"closed"in e&&y(e.remove)&&y(e.add)&&y(e.unsubscribe)}function Ge(e){y(e)?e():e.unsubscribe()}var ne={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},oe={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=oe.delegate;return((r==null?void 0:r.setTimeout)||setTimeout).apply(void 0,V([],F(e)))},clearTimeout:function(e){var t=oe.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function ze(e){oe.setTimeout(function(){throw e})}function ie(){}var Vt=function(){return ye("C",void 0,void 0)}();function Gt(e){return ye("E",void 0,e)}function zt(e){return ye("N",e,void 0)}function ye(e,t,r){return{kind:e,value:t,error:r}}var se=null;function ae(e){if(ne.useDeprecatedSynchronousErrorHandling){var t=!se;if(t&&(se={errorThrown:!1,error:null}),e(),t){var r=se,n=r.errorThrown,o=r.error;if(se=null,n)throw o}}else e()}var we=function(e){Y(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,Ve(r)&&r.add(n)):n.destination=Ht,n}return t.create=function(r,n,o){return new le(r,n,o)},t.prototype.next=function(r){this.isStopped?Se(zt(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?Se(Gt(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?Se(Vt,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(re),le=function(e){Y(t,e);function t(r,n,o){var i=e.call(this)||this,s;if(y(r))s=r;else if(r){s=r.next,n=r.error,o=r.complete;var a;i&&ne.useDeprecatedNextContext?(a=Object.create(r),a.unsubscribe=function(){return i.unsubscribe()}):a=r,s=s==null?void 0:s.bind(a),n=n==null?void 0:n.bind(a),o=o==null?void 0:o.bind(a)}return i.destination={next:s?be(s):ie,error:be(n!=null?n:He),complete:o?be(o):ie},i}return t}(we);function be(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{e.apply(void 0,V([],F(r)))}catch(o){ze(o)}}}function He(e){throw e}function Se(e,t){var r=ne.onStoppedNotification;r&&oe.setTimeout(function(){return r(e,t)})}var Ht={closed:!0,next:ie,error:He,complete:ie},xe=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Bt(e){return e}function Wt(e){return e.length===0?Bt:e.length===1?e[0]:function(r){return e.reduce(function(n,o){return o(n)},r)}}var O=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var o=this,i=Ut(t)?t:new le(t,r,n);return ae(function(){var s=o,a=s.operator,l=s.source;i.add(a?a.call(i,l):l?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=Be(r),new r(function(o,i){var s=new le({next:function(a){try{t(a)}catch(l){i(l),s.unsubscribe()}},error:i,complete:o});n.subscribe(s)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[xe]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Wt(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=Be(t),new t(function(n,o){var i;r.subscribe(function(s){return i=s},function(s){return o(s)},function(){return n(i)})})},e.create=function(t){return new e(t)},e}();function Be(e){var t;return(t=e!=null?e:ne.Promise)!==null&&t!==void 0?t:Promise}function Zt(e){return e&&y(e.next)&&y(e.error)&&y(e.complete)}function Ut(e){return e&&e instanceof we||Zt(e)&&Ve(e)}function qt(e){return y(e==null?void 0:e.lift)}function z(e){return function(t){if(qt(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var J=function(e){Y(t,e);function t(r,n,o,i,s){var a=e.call(this,r)||this;return a.onFinalize=s,a._next=n?function(l){try{n(l)}catch(c){r.error(c)}}:e.prototype._next,a._error=i?function(l){try{i(l)}catch(c){r.error(c)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=o?function(){try{o()}catch(l){r.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,a}return t.prototype.unsubscribe=function(){var r,n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))},t}(we),Xt=Me(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),We=function(e){Y(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new Ze(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new Xt},t.prototype.next=function(r){var n=this;ae(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){var s=n.observers.slice();try{for(var a=N(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.next(r)}}catch(f){o={error:f}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}})},t.prototype.error=function(r){var n=this;ae(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var o=n.observers;o.length;)o.shift().error(r)}})},t.prototype.complete=function(){var r=this;ae(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,o=n.hasError,i=n.isStopped,s=n.observers;return o||i?Ne:(s.push(r),new re(function(){return ge(s,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,o=n.hasError,i=n.thrownError,s=n.isStopped;o?r.error(i):s&&r.complete()},t.prototype.asObservable=function(){var r=new O;return r.source=this,r},t.create=function(r,n){return new Ze(r,n)},t}(O),Ze=function(e){Y(t,e);function t(r,n){var o=e.call(this)||this;return o.destination=r,o.source=n,o}return t.prototype.next=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,r)},t.prototype.error=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&o!==void 0?o:Ne},t}(We),Yt=new O(function(e){return e.complete()}),Ee=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Ue(e){return y(e==null?void 0:e.then)}function qe(e){return y(e[xe])}function Xe(e){return Symbol.asyncIterator&&y(e==null?void 0:e[Symbol.asyncIterator])}function Ye(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Jt(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Je=Jt();function Qe(e){return y(e==null?void 0:e[Je])}function Ke(e){return Mt(this,arguments,function(){var r,n,o,i;return je(this,function(s){switch(s.label){case 0:r=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,G(r.read())];case 3:return n=s.sent(),o=n.value,i=n.done,i?[4,G(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,G(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function et(e){return y(e==null?void 0:e.getReader)}function H(e){if(e instanceof O)return e;if(e!=null){if(qe(e))return Qt(e);if(Ee(e))return Kt(e);if(Ue(e))return er(e);if(Xe(e))return tt(e);if(Qe(e))return tr(e);if(et(e))return rr(e)}throw Ye(e)}function Qt(e){return new O(function(t){var r=e[xe]();if(y(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Kt(e){return new O(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function er(e){return new O(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,ze)})}function tr(e){return new O(function(t){var r,n;try{for(var o=N(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(t.next(s),t.closed)return}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}t.complete()})}function tt(e){return new O(function(t){nr(e,t).catch(function(r){return t.error(r)})})}function rr(e){return tt(Ke(e))}function nr(e,t){var r,n,o,i;return jt(this,void 0,void 0,function(){var s,a;return je(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=Nt(e),l.label=1;case 1:return[4,r.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),o={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(i=r.return)?[4,i.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function L(e,t,r,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=t.schedule(function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(i),!o)return i}function rt(e,t){return t===void 0&&(t=0),z(function(r,n){r.subscribe(new J(n,function(o){return L(n,e,function(){return n.next(o)},t)},function(){return L(n,e,function(){return n.complete()},t)},function(o){return L(n,e,function(){return n.error(o)},t)}))})}function nt(e,t){return t===void 0&&(t=0),z(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function or(e,t){return H(e).pipe(nt(t),rt(t))}function ir(e,t){return H(e).pipe(nt(t),rt(t))}function sr(e,t){return new O(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function ar(e,t){return new O(function(r){var n;return L(r,t,function(){n=e[Je](),L(r,t,function(){var o,i,s;try{o=n.next(),i=o.value,s=o.done}catch(a){r.error(a);return}s?r.complete():r.next(i)},0,!0)}),function(){return y(n==null?void 0:n.return)&&n.return()}})}function ot(e,t){if(!e)throw new Error("Iterable cannot be null");return new O(function(r){L(r,t,function(){var n=e[Symbol.asyncIterator]();L(r,t,function(){n.next().then(function(o){o.done?r.complete():r.next(o.value)})},0,!0)})})}function lr(e,t){return ot(Ke(e),t)}function cr(e,t){if(e!=null){if(qe(e))return or(e,t);if(Ee(e))return sr(e,t);if(Ue(e))return ir(e,t);if(Xe(e))return ot(e,t);if(Qe(e))return ar(e,t);if(et(e))return lr(e,t)}throw Ye(e)}function ur(e,t){return t?cr(e,t):H(e)}function it(e,t){return z(function(r,n){var o=0;r.subscribe(new J(n,function(i){n.next(e.call(t,i,o++))}))})}var fr=Array.isArray;function pr(e,t){return fr(t)?e.apply(void 0,V([],F(t))):e(t)}function dr(e){return it(function(t){return pr(e,t)})}function vr(e,t,r,n,o,i,s,a){var l=[],c=0,f=0,m=!1,u=function(){m&&!l.length&&!c&&t.complete()},h=function(p){return c<n?g(p):l.push(p)},g=function(p){i&&t.next(p),c++;var _=!1;H(r(p,f++)).subscribe(new J(t,function(v){o==null||o(v),i?h(v):t.next(v)},function(){_=!0},void 0,function(){if(_)try{c--;for(var v=function(){var w=l.shift();s?L(t,s,function(){return g(w)}):g(w)};l.length&&c<n;)v();u()}catch(w){t.error(w)}}))};return e.subscribe(new J(t,h,function(){m=!0,u()})),function(){a==null||a()}}function st(e,t,r){return r===void 0&&(r=1/0),y(t)?st(function(n,o){return it(function(i,s){return t(n,i,o,s)})(H(e(n,o)))},r):(typeof t=="number"&&(r=t),z(function(n,o){return vr(n,o,e,r)}))}var hr=["addListener","removeListener"],mr=["addEventListener","removeEventListener"],_r=["on","off"];function Q(e,t,r,n){if(y(r)&&(n=r,r=void 0),n)return Q(e,t,r).pipe(dr(n));var o=F(wr(e)?mr.map(function(a){return function(l){return e[a](t,l,r)}}):gr(e)?hr.map(at(e,t)):yr(e)?_r.map(at(e,t)):[],2),i=o[0],s=o[1];if(!i&&Ee(e))return st(function(a){return Q(a,t,r)})(H(e));if(!i)throw new TypeError("Invalid event target");return new O(function(a){var l=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];return a.next(1<c.length?c:c[0])};return i(l),function(){return s(l)}})}function at(e,t){return function(r){return function(n){return e[r](t,n)}}}function gr(e){return y(e.addListener)&&y(e.removeListener)}function yr(e){return y(e.on)&&y(e.off)}function wr(e){return y(e.addEventListener)&&y(e.removeEventListener)}function br(e){return e<=0?function(){return Yt}:z(function(t,r){var n=0;t.subscribe(new J(r,function(o){++n<=e&&(r.next(o),e<=n&&r.complete())}))})}function Ie(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new We}:t,n=e.resetOnError,o=n===void 0?!0:n,i=e.resetOnComplete,s=i===void 0?!0:i,a=e.resetOnRefCountZero,l=a===void 0?!0:a;return function(c){var f=null,m=null,u=null,h=0,g=!1,p=!1,_=function(){m==null||m.unsubscribe(),m=null},v=function(){_(),f=u=null,g=p=!1},w=function(){var b=f;v(),b==null||b.unsubscribe()};return z(function(b,I){h++,!p&&!g&&_();var C=u=u!=null?u:r();I.add(function(){h--,h===0&&!p&&!g&&(m=Ce(w,l))}),C.subscribe(I),f||(f=new le({next:function(R){return C.next(R)},error:function(R){p=!0,_(),m=Ce(v,o,R),C.error(R)},complete:function(){g=!0,_(),m=Ce(v,s),C.complete()}}),ur(b).subscribe(f))})(c)}}function Ce(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return t===!0?(e(),null):t===!1?null:t.apply(void 0,V([],F(r))).pipe(br(1)).subscribe(function(){return e()})}Q(window,"resize").pipe(Ie({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1}));Q(window,"keypress").pipe(Ie({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1}));const Oo=Q(window,"keyup").pipe(Ie({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!1})),Sr=e=>new Promise(t=>{const r=document.createElement("input");r.type="file",r.accept=(e||[]).join(","),r.click(),r.addEventListener("change",n=>{const o=(n.dataTransfer||n.target).files;r.remove(),t(o)})}),xr=e=>{T()&&(e.on("connect",()=>{window.electron.ipcRenderer.invoke("client","connect",!0)}),e.on("disconnect",()=>{window.electron.ipcRenderer.invoke("client","connect",!1)}))},Er=()=>{window.electron.ipcRenderer.invoke("window","minimize")},Ir=()=>{window.electron.ipcRenderer.invoke("window","maximize")},Cr=e=>{if(T())window.electron.ipcRenderer.invoke("window","fullscreen",e);else return e?document.body.requestFullscreen():document.exitFullscreen()},Or=()=>{window.electron.ipcRenderer.invoke("close")},T=()=>"electron"in window,Tr=e=>{if(T())return window.electron.ipcRenderer.invoke("save",e);{const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","scene.json"),r.click()}},$r=async()=>{if(T())return window.electron.ipcRenderer.invoke("load");{const e=await Sr("text");return new Promise((t,r)=>{if(e.length){const n=new FileReader;n.addEventListener("load",()=>{try{t(JSON.parse(n.result))}catch(o){r(o)}}),n.readAsText(e[0])}else t()})}},kr=e=>{T()&&window.electron.ipcRendererReceive("dialog",e)},Pr=e=>{T()?window.electron.ipcRendererReceive("window",(t,r)=>{switch(t){case"fullscreen":e(r);break}}):window.addEventListener("fullscreenchange",()=>{e(document.fullscreenEnabled)})},Rr=()=>T()?window.electron.ipcRenderer.invoke("loadConfig"):JSON.parse(window.localStorage.getItem("config")),Ar=e=>T()?window.electron.ipcRenderer.invoke("saveConfig",e):window.localStorage.setItem("config",JSON.stringify(e)),Lr=()=>T()?window.electron.ipcRenderer.invoke("getCurrentVersion"):"1.0.0-beta.37",Dr=async()=>{const t=(()=>{const n=[],o=[!1,!0],i=[400,500,600,700,800,900];for(let s=0;s<o.length;s++)for(let a=0;a<i.length;a++)n.push({weight:i[a],italic:o[s]});return n})(),r=[{group:"DevTerm",value:'"5x7-ISO8859-1"',name:"5x7-ISO8859-1",variants:[]},{group:"DevTerm",value:'"6x12-ISO8859-1"',name:"6x12-ISO8859-1",variants:[]},{group:"DevTerm",value:'"7x14-ISO8859-1"',name:"7x14-ISO8859-1",variants:[]},{group:"DevTerm",value:'"Px437_CompaqThin_8x16"',name:"Px437_CompaqThin_8x16",variants:[]},{group:"Web",value:"sans-serif",name:"Sans-serif",monospace:!1,variants:t},{group:"Web",value:"serif",name:"Serif",monospace:!1,variants:t},{group:"Web",value:"monospace",name:"Monospace",monospace:!0,variants:t},{group:"Web",value:"fantasy",name:"Fantasy",monospace:!1,variants:t},{group:"Web",value:"cursive",name:"Cursive",monospace:!1,variants:t}];return T()?r.concat(await window.electron.ipcRenderer.invoke("getFonts")):[...r,{group:"System",value:'"Arial"',name:"Arial",monospace:!1,variants:t},{group:"System",value:'"Verdana"',name:"Verdana",monospace:!1,variants:t},{group:"System",value:'"Helvetica"',name:"Helvetica",monospace:!1,variants:t},{group:"System",value:'"Tahoma"',name:"Tahoma",monospace:!1,variants:t},{group:"System",value:'"Trebuchet MS"',name:"Trebuchet MS",monospace:!1,variants:t},{group:"System",value:'"Times New Roman"',name:"Times New Roman",monospace:!1,variants:t},{group:"System",value:'"Georgia"',name:"Georgia",monospace:!1,variants:t},{group:"System",value:'"Garamond"',name:"Garamond",monospace:!1,variants:t},{group:"System",value:'"Courier New"',name:"Courier New",monospace:!0,variants:t},{group:"System",value:'"Brush Script MT"',name:"Brush Script MT",monospace:!1,variants:t}]};var lt=6,To=16,ce=384,x={SIZE_8_16_THIN_1:0,SIZE_8_16_THIN_2:4,SIZE_5_7:1,SIZE_6_12:2,SIZE_7_14:3},Fr={[x.SIZE_5_7]:76,[x.SIZE_6_12]:63,[x.SIZE_7_14]:54,[x.SIZE_8_16_THIN_1]:47,[x.SIZE_8_16_THIN_2]:47},$o={[x.SIZE_8_16_THIN_1]:[8,16],[x.SIZE_8_16_THIN_2]:[8,16],[x.SIZE_7_14]:[7,14],[x.SIZE_6_12]:[6,12],[x.SIZE_5_7]:[5,7]},k={LEFT:0,CENTER:1,RIGHT:2},ct=()=>({align:k.LEFT,font:x.SIZE_8_16_THIN_1,margin:0,underline:0,lineSpace:0,density:lt,underLine:0,wordGap:0}),jr="/assets/5x7-ISO8859-1.1e468e9f.ttf",Mr="/assets/6x12-ISO8859-1.4c4c24d1.ttf",Nr="/assets/7x14-ISO8859-1.b8471bdd.ttf",Vr="/assets/Px437_CompaqThin_8x16.ccffc04f.ttf";const Gr=()=>{const e=[["5x7-ISO8859-1",`url(${jr})`],["6x12-ISO8859-1",`url(${Mr})`],["7x14-ISO8859-1",`url(${Nr})`],["Px437_CompaqThin_8x16",`url(${Vr})`]];return Promise.all(e.map(async t=>{console.log("load font",t[0],t[1]);const r=new FontFace(...t);return await r.load(),document.fonts.add(r),r}))},ko={[x.SIZE_5_7]:{fontFamily:"5x7-ISO8859-1",fontSize:7},[x.SIZE_6_12]:{fontFamily:"6x12-ISO8859-1",fontSize:12},[x.SIZE_7_14]:{fontFamily:"7x14-ISO8859-1",fontSize:14},[x.SIZE_8_16_THIN_1]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16},[x.SIZE_8_16_THIN_2]:{fontFamily:"Px437_CompaqThin_8x16",fontSize:16}};var ue,zr=new Uint8Array(16);function Hr(){if(!ue&&(ue=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ue))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ue(zr)}var Br=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Wr(e){return typeof e=="string"&&Br.test(e)}var E=[];for(var Oe=0;Oe<256;++Oe)E.push((Oe+256).toString(16).substr(1));function Zr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(E[e[t+0]]+E[e[t+1]]+E[e[t+2]]+E[e[t+3]]+"-"+E[e[t+4]]+E[e[t+5]]+"-"+E[e[t+6]]+E[e[t+7]]+"-"+E[e[t+8]]+E[e[t+9]]+"-"+E[e[t+10]]+E[e[t+11]]+E[e[t+12]]+E[e[t+13]]+E[e[t+14]]+E[e[t+15]]).toLowerCase();if(!Wr(r))throw TypeError("Stringified UUID is invalid");return r}function Ur(e,t,r){e=e||{};var n=e.random||(e.rng||Hr)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return Zr(n)}class Te{constructor(t){console.log(t);const{id:r,type:n,value:o,visible:i}=t||{};this.id=r||Ur(),this.type=n,this.value=o,this.visible=i===void 0?!0:i}toJSON(){return{id:this.id,type:this.type,value:this.value,visible:this.visible}}}var qr=[{type:"reset"},{id:"6319ab91-5740-49c0-8265-1d05d97014a3",type:"grid",value:{widths:[1,1],data:[[{id:"7d4b8881-37d3-4b80-98e2-dbef273fd321",type:"spacer",value:{value:200},visible:!0},{id:"7d4b8881-37d3-4b80-98e2-dbef273fd320",type:"text",value:{text:`Item 1.
Item 2.
Item 3.
Item 4.`,options:{fontSize:"24",align:"left",lineSpace:"30",wordGap:0,margin:0,fontFamily:null,color:"#000",weight:400,italic:!1},imageOptions:{width:192,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0}],[{id:"cafb2f8d-add1-4c34-9c1e-6f19c63732ac",type:"text",value:{text:`0,00
0,00
0,00
0,00`,options:{fontSize:"24",align:2,lineSpace:"30",wordGap:0,margin:0,fontFamily:null,color:"#000",weight:400,italic:!1},imageOptions:{width:192,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0}]],options:{columnGutter:0,rowGutter:0},imageOptions:{width:null,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}},visible:!0},{type:"feedPitch",value:{value:15,type:"font"}}],Xr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-menu"},[r("ul",[e._t("default")],2)])},Yr=[];function D(e,t,r,n,o,i,s,a){var l=typeof e=="function"?e.options:e;t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId="data-v-"+i);var c;if(s?(c=function(u){u=u||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!u&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(u=__VUE_SSR_CONTEXT__),o&&o.call(this,u),u&&u._registeredComponents&&u._registeredComponents.add(s)},l._ssrRegister=c):o&&(c=a?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),c)if(l.functional){l._injectStyles=c;var f=l.render;l.render=function(h,g){return c.call(g),f(h,g)}}else{var m=l.beforeCreate;l.beforeCreate=m?[].concat(m,c):[c]}return{exports:e,options:l}}const Jr={},ut={};var Qr=D(Jr,Xr,Yr,!1,Kr,"6a61d96c",null,null);function Kr(e){for(let t in ut)this[t]=ut[t]}var en=function(){return Qr.exports}(),tn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",e._g({staticClass:"base-generic-button"},e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)},rn=[];const nn={props:{text:{type:String,default:"Button Text"}}},ft={};var on=D(nn,tn,rn,!1,sn,"0c7b8858",null,null);function sn(e){for(let t in ft)this[t]=ft[t]}var an=function(){return on.exports}(),ln=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-item",class:{selected:e.selected}},[r("base-generic-button",e._g(e._b({},"base-generic-button",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[e._v(e._s(e.text))]})],2)],1)},cn=[];const un={components:{BaseGenericButton:an},inheritAttrs:!1,props:{selected:{type:Boolean,default:!1},text:{type:String,default:null}}},pt={};var fn=D(un,ln,cn,!1,pn,"5b663e72",null,null);function pn(e){for(let t in pt)this[t]=pt[t]}var P=function(){return fn.exports}(),dn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",e._g(e._b({staticClass:"app-menu-text"},"li",e.$attrs,!1),e.$listeners),[e._t("default",function(){return[r("span",{domProps:{innerHTML:e._s(e.text)}})]})],2)},vn=[];const hn={inheritAttrs:!1,props:{text:{type:String,default:null}}},dt={};var mn=D(hn,dn,vn,!1,_n,"72abcabd",null,null);function _n(e){for(let t in dt)this[t]=dt[t]}var fe=function(){return mn.exports}(),gn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-spacer"},[e._t("default")],2)},yn=[];const wn={},vt={};var bn=D(wn,gn,yn,!1,Sn,"d155e842",null,null);function Sn(e){for(let t in vt)this[t]=vt[t]}var $e=function(){return bn.exports}(),xn=function(){var e=this,t=e.$createElement;return e._self._c,e._m(0)},En=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"app-menu-divider"},[r("i")])}];const In={},ht={};var Cn=D(In,xn,En,!1,On,"53fd4f5e",null,null);function On(e){for(let t in ht)this[t]=ht[t]}var B=function(){return Cn.exports}(),Tn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app",class:{ready:e.ready},style:e.style},[r("app-menu",{staticClass:"header"},e._l(e.headerItems,function(n,o){return r(n.component,e._g(e._b({key:o,tag:"component"},"component",n.props,!1),n.on))}),1),r("div",{staticClass:"app-content"},[!e.$client.connected&&e.ready?r("view-start",{on:{apply:e.onApplyViewStart}}):e.currentView===e.VIEWS.PRINTER?r("view-printer",{attrs:{colors:e.colors},model:{value:e.printerTemplate,callback:function(n){e.printerTemplate=n},expression:"printerTemplate"}}):e.currentView===e.VIEWS.INFO?r("view-info"):e._e()],1),r("app-menu",{staticClass:"footer"},e._l(e.footerItems,function(n,o){return r(n.component,e._g(e._b({key:o,tag:"component"},"component",n.props,!1),n.on))}),1),e._l(e.$errorList.errors,function(n,o){return r("dialog-error",e._b({key:o,attrs:{"init-open":""}},"dialog-error",n,!1))}),e._l(e.$dialog.prompts,function(n,o){return r("dialog-prompt",e._b({key:o,attrs:{"init-open":""}},"dialog-prompt",n,!1))}),e.ready?r("dialog-remote",{ref:"dialogRemote"}):e._e(),e.ready?r("dialog-server",{ref:"dialogServer"}):e._e(),e.ready?r("dialog-options",{ref:"dialogOptions"}):e._e(),e._m(0)],2)},$n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"display-look"},[r("div",{staticClass:"scanlines"})])}];const j={NONE:null,INFO:"info",START:"start",PRINTER:"priner"},kn={amber:{primary:[255,204,0],secondary:[0,0,0],printer:{preview:{background:[255,204,0],foreground:[0,0,0]}}},green:{primary:[51,255,0],secondary:[0,0,0],printer:{preview:{background:[51,255,0],foreground:[0,0,0]}}},whiteBlack:{primary:[255,255,255],secondary:[0,0,0],printer:{preview:{background:[255,255,255],foreground:[0,0,0]}}},blackWhite:{primary:[0,0,0],secondary:[255,255,255],printer:{preview:{background:[0,0,0],foreground:[255,255,255]}}}};function Pn(){return qr.map(e=>new Te(e))}const Rn={components:{ViewPrinter:()=>S(()=>import("./Printer.38f70d42.js").then(function(e){return e.P}),["assets/Printer.38f70d42.js","assets/Printer.84bb9e1b.css","assets/View.44587490.js","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/DropDown.a9412aaf.js","assets/DropDown.4b7d9790.css","assets/Dialog.ec3343da.js","assets/Dialog.30fbfc42.css"]),ViewStart:()=>S(()=>import("./Start.9143150a.js"),["assets/Start.9143150a.js","assets/Start.7b700386.css","assets/View.44587490.js","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),ViewInfo:()=>S(()=>import("./Info.629da43d.js"),["assets/Info.629da43d.js","assets/Info.f09bbb3b.css","assets/View.44587490.js","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),AppMenu:en,AppMenuItem:P,AppMenuText:fe,AppMenuSpacer:$e,AppMenuDivider:B,DialogError:()=>S(()=>import("./Error.fd1b137f.js"),["assets/Error.fd1b137f.js","assets/Error.9832724b.css","assets/Dialog.ec3343da.js","assets/Dialog.30fbfc42.css","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),DialogRemote:()=>S(()=>import("./Remote.338def8f.js"),["assets/Remote.338def8f.js","assets/Remote.faa484f5.css","assets/Dialog.ec3343da.js","assets/Dialog.30fbfc42.css","assets/DropDown.a9412aaf.js","assets/DropDown.4b7d9790.css","assets/CheckBox.dc1b9740.js","assets/CheckBox.12afbd75.css","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/TextField.0ac45ea9.js","assets/TextField.8c427f2c.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),DialogServer:()=>S(()=>import("./Server.56152ff2.js"),["assets/Server.56152ff2.js","assets/Server.2bd65bf6.css","assets/Dialog.ec3343da.js","assets/Dialog.30fbfc42.css","assets/DropDown.a9412aaf.js","assets/DropDown.4b7d9790.css","assets/Content.054782c3.js","assets/Content.1ab9f320.css","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/TextField.0ac45ea9.js","assets/TextField.8c427f2c.css","assets/FileSelect.2497cc4f.js","assets/FileSelect.aa36643f.css","assets/CheckBox.dc1b9740.js","assets/CheckBox.12afbd75.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),DialogOptions:()=>S(()=>import("./Options.35e32863.js"),["assets/Options.35e32863.js","assets/Options.5466c3cb.css","assets/Dialog.ec3343da.js","assets/Dialog.30fbfc42.css","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/TextField.0ac45ea9.js","assets/TextField.8c427f2c.css","assets/DropDown.a9412aaf.js","assets/DropDown.4b7d9790.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),DialogPrompt:()=>S(()=>import("./Prompt.2647388b.js"),["assets/Prompt.2647388b.js","assets/Prompt.ba8cf0c2.css","assets/Dialog.ec3343da.js","assets/Dialog.30fbfc42.css","assets/TextButton.7f1048d8.js","assets/TextButton.0a2406b2.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"])},data(){return{VIEWS:j,currentView:j.PRINTER,ready:!1,fullscreen:!1,printerTemplate:Pn()}},computed:{headerItems(){const e=[{component:P,on:{click:this.onClickNew},props:{text:"New"}},{component:B},{component:P,on:{click:this.onClickSave},props:{text:"Save"}},{component:P,title:"Load",on:{click:this.onClickLoad},props:{text:"Load"}},{component:B}];return[...this.$client.connected&&[{component:P,on:{click:()=>this.currentView=j.INFO},props:{selected:this.currentView===j.INFO,text:"Info"}},{component:P,on:{click:()=>this.currentView=j.PRINTER},props:{selected:this.currentView===j.PRINTER,text:"Printer"}}]||[],{component:$e},...this.$client.connected&&this.currentView===j.PRINTER&&e||[],{component:P,on:{click:this.onClickOptions},props:{text:"Options"}},T()&&[{component:B},{component:P,on:{click:this.onClickClose},props:{text:"Close"}}]].flat().filter(Boolean)},footerItems(){return[T()&&[{component:P,on:{click:this.onClickMinimizeWindow},props:{text:"Minimize"}},{component:P,on:{click:this.onClickMaximizeWindow},props:{text:"Maximize"}}].flat(),{component:P,on:{click:this.onClickFullscreen},props:{selected:this.fullscreen,text:"Fullscreen"}},{component:$e},this.hasServer&&[{component:fe,on:{click:this.showServerDialog},props:{class:{connection:!0,connected:this.$server.options.active},text:`${this.$server.options.active?`Server (*:${this.$server.options.port}${this.$server.options.secure?"/SSL":""})`:"Server Offline"}`}},{component:B}],{component:fe,on:{click:this.showRemoteDialog},props:{class:{connection:!0,connected:this.clientConnected},text:`${this.clientConnected?`Online (${this.$client.host}:${this.$client.port}${this.$client.secure?"/SSL":""})`:"Offline"}`}},{component:B},{component:fe,on:{click:()=>{window.open("https://github.com/ThornWalli/devterm-toolbox/releases")}},props:{class:"info-version",text:this.version}}].flat().filter(Boolean)},hasServer(){return!this.$server.disabled},version(){return this.$config.version},colors(){return kn[this.$config.data.theme]},clientConnected(){return this.$client.connected},style(){return d(d({"--zoom":`${this.$config.data.zoom}`,"--color-primary":`rgb(${this.colors.primary.join(",")})`,"--color-secondary":`rgb(${this.colors.secondary.join(",")})`},Object.fromEntries(Array(10).fill("").map((e,t)=>[`--color-primary-${(t+1)*10}`,`rgb(${this.colors.primary.join(" ")} / ${(t+1)*10}%)`]))),Object.fromEntries(Array(10).fill("").map((e,t)=>[`--color-secondary-${(t+1)*10}`,`rgb(${this.colors.secondary.join(" ")} / ${(t+1)*10}%)`])))}},async mounted(){await Gr(),await this.$config.init(),await this.$server.init(),this.hasServer&&await this.$server.refresh(),await this.$config.load();const e=this.$config.get("profiles").find(({name:t})=>t===this.$config.get("profile"));if(e){const{port:t,host:r,ssl:n,secure:o}=e;if(this.$config.get("startType")&&t)try{this.$server&&this.$config.get("startType")==="local"&&!this.$server.options.active&&await this.$server.start(t,n),r&&await this.$client.connect(t,r,o)}catch{}}this.ready=!0,this.registerListeners()},methods:{registerListeners(){Pr(e=>{this.fullscreen=e}),kr((e,t)=>{switch(e){case"open":switch(t){case"options":this.showOptionsDialog();break;case"remote":this.showRemoteDialog();break;case"server":this.showServerDialog();break}break}})},onClickMinimizeWindow(){return Er()},onClickMaximizeWindow(){return Ir()},onClickFullscreen(){return Cr(!this.fullscreen)},onClickClose(){return Or()},onClickNew(){this.printerTemplate=[]},onClickSave(){return Tr(this.printerTemplate)},async onClickLoad(){try{const e=await $r();e&&(this.printerTemplate=e)}catch(e){this.$errorList.add(e)}},onClickOptions(){this.showOptionsDialog()},async onApplyViewStart({type:e}){this.$config.set("startType",e);let t={};switch(e){case"local":t=await this.showServerDialog();break;case"remote":t=await this.showRemoteDialog();break}const{profile:r}=t||{};r&&(this.$config.set("profile",r),await this.$config.save())},showServerDialog(){return this.$refs.dialogServer.show()},showRemoteDialog(){return this.$refs.dialogRemote.show()},showOptionsDialog(){return this.$refs.dialogOptions.show()}}},mt={};var An=D(Rn,Tn,$n,!1,Ln,"42bc2a75",null,null);function Ln(e){for(let t in mt)this[t]=mt[t]}var _t=function(){return An.exports}();class Dn{constructor(){this.errors=[]}add(t,r){typeof t=="object"&&(console.error(t),t.message?(t.type&&(r=t.type),t=t.message):t=JSON.stringify(t));const n={title:r,message:t},o=()=>{this.errors.slice(this.errors.indexOf(n),1)};n.callback=o,this.errors.push(n)}}const gt=$.observable(new Dn);Object.defineProperty($.prototype,"$errorList",{get(){return gt}});const Po=512,pe=()=>({theme:"amber",zoom:1,startType:null,ssl:{key:null,cert:null,pfx:null,passphrase:null},profiles:[]}),Fn=()=>({name:null,port:3e3,host:null,secure:!1,ssl:{key:null,cert:null,pfx:null,passphrase:null}}),Ro="localhost",jn="Profile Default";class Mn{constructor(){this.data=pe(),this.version=null,this.fonts=[]}async init(){this.version=await Lr(),this.fonts=await Dr()}toJSON(){return Object.assign({},this.data,{version:this.version})}get(t){return this.data[t]}set(t,r){typeof t=="string"?this.data[t]=r:typeof t=="object"&&Object.entries(t).forEach(([n,o])=>this.set(n,o))}save(){return Ar(this.toJSON())}reset(){return this.data=pe(),this.save()}async load(){let t;try{t=await Rr()}catch{t=pe()}return console.log(t),this.data=Object.assign(pe(),t)}saveProfile(t){t.name=t.name||jn;const r=this.get("profiles");let n=this.get("profiles").find(({name:o})=>o===t.name);return n?(console.log("update profile",n.name,n),r[r.indexOf(n)]=d(d({},n),t)):(console.log("create profile",t.name,t),n=d(d({},Fn()),t),r.push(n)),this.set("profiles",r),this.save()}deleteProfile(t){const r=this.get("profiles"),n=this.get("profiles").find(({name:o})=>o===t);return r.slice(r.indexOf(n),1),this.set("profiles",r),this.save()}}const Nn=$.observable(new Mn);Object.defineProperty($.prototype,"$config",{get(){return Nn}});Object.defineProperty($.prototype,"$server",{get(){return{init(){return Promise.resolve()},disabled:!0}}});var Vn=384,{createCanvas:K,loadImage:Ao,Canvas:Lo}=Rt,W=()=>({width:null,rotate:!1,flipX:!1,flipY:!1,invert:!1,grayscale:!1}),Z=(e,t)=>(t=d(d({},W()),t),t.rotate&&(e=Wn(e)),e=Hn(e,t.width),(t.flipX||t.flipY)&&(e=Bn(e,t.flipX,t.flipY)),t.invert&&(e=zn(e)),t.grayscale&&(e=Zn(e)),e=Gn(e),e),Gn=e=>{const t=e.getContext("2d"),r=t.getImageData(0,0,t.canvas.width,t.canvas.height),n=r.data;for(let o=0;o<n.length;o+=4)n[o+3]===0&&(n[o]=255,n[o+1]=255,n[o+2]=255,n[o+3]=255);return t.putImageData(r,0,0),e},zn=e=>{const t=e.getContext("2d"),r=t.getImageData(0,0,t.canvas.width,t.canvas.height),n=r.data;for(let o=0;o<n.length;o+=4)n[o]=255-n[o],n[o+1]=255-n[o+1],n[o+2]=255-n[o+2];return t.putImageData(r,0,0),e},Hn=(e,t)=>{t=Math.min(e.width,Math.min(t||e.width,Vn));const r=t*(e.height/e.width),n=K(t,r);return n.getContext("2d").drawImage(e,0,0,t,r),n},Bn=(e,t,r)=>{const n=K(e.width,e.height),o=n.getContext("2d");console.log(1-t*2,1-r*2);const i=1-t*2,s=1-r*2;return o.translate(t*e.width,r*e.height),o.scale(i,s),o.drawImage(e,0,0,e.width,e.height),n},Wn=e=>{let t=e.getContext("2d");const r=K(e.height,e.width);return t=r.getContext("2d"),t.translate(e.height,0),t.rotate(Math.PI/2),t.drawImage(e,0,0),r},Zn=e=>{const t=e.getContext("2d");return t.putImageData($t(t.getImageData(0,0,e.width,e.height)),0,0),e},Un=(e,t)=>{const r=K();try{return kt(r,e,t),r}catch(n){throw new Error(n)}};async function qn(e,t={}){t=d({margin:0},t);const r=K(t.width||1,t.width||1);return new Promise(n=>{Pt.toCanvas(r,e,t,o=>{if(o)throw o;n(r)})})}var Xn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("select",{attrs:{required:e.required},on:{change:function(n){return e.$emit("input",n.target.value)}}},[e._l(e.singleOptions,function(n){return r("option",{key:n.value,domProps:{value:n.value,selected:n.value===e.preparedValue}},[e._v(" "+e._s(n.title)+" ")])}),e._l(e.groupedOptions,function(n){return r("optgroup",{key:n.label,attrs:{label:n.label}},e._l(n.options,function(o){return r("option",{key:o.value,domProps:{value:o.value,selected:o.value===e.preparedValue}},[e._v(" "+e._s(o.title)+" ")])}),0)})],2)},Yn=[];const Jn={props:{options:{type:Array,default(){return[1,2,3,4]}},value:{type:[String,Number],default:null},required:{type:Boolean,default:!1}},computed:{preparedValue(){return this.value===null?"":String(this.value)},preparedOptions(){return this.options.map(e=>typeof e=="object"&&"title"in e?de.create(e):de.create({value:e}))},singleOptions(){return this.preparedOptions.filter(e=>!e.group)},groupedOptions(){return Object.entries(this.preparedOptions.reduce((e,t)=>(t.group&&(e[t.group]=(e[t.group]||[]).concat(t)),e),{})).map(([e,t])=>({label:e,options:t}))}}};var M,q,X;class de{constructor(t){ee(this,M,void 0);ee(this,q,void 0);ee(this,X,void 0);t&&typeof t!="object"&&(t={value:t});const{value:r,title:n,group:o}=t||{value:""};te(this,M,r||""),te(this,q,n||A(this,M)),te(this,X,o)}get value(){return A(this,M)}get title(){return A(this,q)}get group(){return A(this,X)}toJSON(){return{value:A(this,M),title:A(this,q),group:A(this,X)}}static create(...t){return new this(...t)}}M=new WeakMap,q=new WeakMap,X=new WeakMap;const yt={};var Qn=D(Jn,Xn,Yn,!1,Kn,null,null,null);function Kn(e){for(let t in yt)this[t]=yt[t]}var Do=function(){return Qn.exports}();const eo=()=>[{native:!0,title:"Align (native)",value:"setAlign",group:"Layout"},{native:!0,title:"Margin (native)",value:"setMargin",group:"Layout"},{native:!0,title:"Font (native)",value:"setFont",group:"Layout"},{native:!0,title:"LineSpace (native)",value:"setLineSpace",group:"Layout"},{native:!0,title:"WordGap (native)",value:"setWordGap",group:"Layout"},{native:!1,title:"Spacer",value:"spacer",group:"Layout"},{native:!1,title:"Grid",value:"grid",group:"Layout"},{native:!1,title:"Image",value:"image",group:"Content"},{native:!1,title:"QRCode",value:"qrCode",group:"Content"},{native:!1,title:"Barcode",value:"barcode",group:"Content"},{native:!1,title:"Text",value:"text",group:"Content"},{native:!0,title:"Text (native)",value:"nativeText",group:"Content"},{native:!0,title:"Reset (native)",value:"reset",group:"General"},{native:!0,title:"Feed Pitch (native)",value:"feedPitch",group:"General"},{native:!0,title:"Cutline (native)",value:"cutLine",group:"General"},{native:!0,title:"Density (native)",value:"setDensity",group:"General"}],Fo=()=>[new de({title:"Add new Action\u2026",value:""}),...eo().map(e=>new de(e))],jo=e=>{let t;switch(e){case"setLineSpace":t=0;break;case"setWordGap":t=0;break;case"setMargin":t=0;break;case"setDensity":t=1;break;case"setFont":t=x.SIZE_8_16_THIN_1;break;case"setAlign":t=k.LEFT;break;case"feedPitch":t={value:1,type:"font"};break;case"text":t=wt();break;case"nativeText":t="Text";break;case"grid":t=no();break;case"image":t=oo();break;case"qrCode":t=io();break;case"barcode":t=so();break;case"spacer":t=ao();break}return new Te({type:e,value:t})},Mo=e=>{const t=ct();return e.filter(r=>r.visible).map(r=>ro(r,t)).filter(Boolean)},to=e=>Array(Fr[e]).fill("").map((t,r)=>r%2==0?"=":"-").join(""),ro=(e,t)=>{switch(e.type){case"setMargin":t.margin=e.value;break;case"setAlign":t.align=e.value;break;case"setLineSpace":t.lineSpace=e.value;break;case"setWordGap":t.wordGap=e.value;break;case"setFont":t.font=Number(e.value);break;case"setDensity":t.density=Number(e.value);break;case"reset":Object.assign(t,ct());break;case"cutLine":return{id:e.id,component:()=>S(()=>import("./NativeText.d81a80bb.js"),["assets/NativeText.d81a80bb.js","assets/NativeText.160177ab.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:he(d({},t),{margin:0,wordGap:0,lineSpace:0,density:lt}),props:{value:to(t.font)}};case"spacer":return{id:e.id,component:()=>S(()=>import("./SpacerCanvas.2e2a9276.js"),["assets/SpacerCanvas.2e2a9276.js","assets/SpacerCanvas.86c170b6.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"grid":return{id:e.id,component:()=>S(()=>import("./GridCanvas.c193ea9b.js"),["assets/GridCanvas.c193ea9b.js","assets/GridCanvas.b667bdd0.css","assets/NativeText.d81a80bb.js","assets/NativeText.160177ab.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"barcode":return{id:e.id,component:()=>S(()=>import("./BarcodeCanvas.16bc6375.js"),["assets/BarcodeCanvas.16bc6375.js","assets/BarcodeCanvas.c3e7a34f.css","assets/NativeText.d81a80bb.js","assets/NativeText.160177ab.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"qrCode":return{id:e.id,component:()=>S(()=>import("./QrCodeCanvas.5faf2ea9.js"),["assets/QrCodeCanvas.5faf2ea9.js","assets/QrCodeCanvas.61d59f7a.css","assets/NativeText.d81a80bb.js","assets/NativeText.160177ab.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"image":return{id:e.id,component:()=>S(()=>import("./ImageCanvas.095a4157.js"),["assets/ImageCanvas.095a4157.js","assets/ImageCanvas.2ca62634.css","assets/NativeText.d81a80bb.js","assets/NativeText.160177ab.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"text":return{id:e.id,component:()=>S(()=>import("./TextCanvas.eb9c8571.js"),["assets/TextCanvas.eb9c8571.js","assets/TextCanvas.195204e8.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"nativeText":return{id:e.id,component:()=>S(()=>import("./NativeText.d81a80bb.js"),["assets/NativeText.d81a80bb.js","assets/NativeText.160177ab.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e)};case"feedPitch":return{id:e.id,component:()=>S(()=>import("./FeedPitch.b8127e07.js"),["assets/FeedPitch.b8127e07.js","assets/FeedPitch.3fa7fa3d.css","assets/vendor.b1428349.js","assets/devterm.9c60640a.js","assets/buffer.89012e65.js"]),options:d({},t),props:d({},e.value)}}return null},no=()=>({widths:[1],data:[[]],options:{columnGutter:0,rowGutter:0},imageOptions:W()}),wt=()=>({text:"Sample",options:{fontSize:16,align:"left",lineSpace:0,wordGap:0,margin:0,fontFamily:"sans-serif",color:"#000",weight:400,italic:!1},imageOptions:W()}),oo=()=>({file:null,imageOptions:W()}),io=()=>({text:"Sample",options:{errorCorrectionLevel:"M",margin:0,scale:4,small:!1},imageOptions:W()}),so=()=>({text:"Sample",options:{format:"",height:100,font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,margin:10,displayValue:!0,flat:!1},imageOptions:W()}),ao=()=>({value:0});var ke=9224,bt=29,lo=function(e){const t=De.Buffer.alloc(e.byteLength),r=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=r[n];return t},St=(e,t)=>{const r=e/8%256,n=e/8/256,o=t%256,i=t/256,s=(r+256*n)*(o+256*i);return{xL:r,xH:n,yL:o,yH:i,k:s}},co=(e,t)=>{const{k:r}=St(e,1),n=ke/r;return Math.ceil(t/n)},uo=e=>{const t=e.getContext("2d"),r=co(e.width,e.height),n=[];for(let o=0;o<r;o++)n.push(t.getImageData(0,e.height/r*o,e.width,e.height/r));return n};function fo(e){const t=(n,o)=>{const i=(o*e.width+n)*4,s=e.data;return{r:s[i],g:s[i+1],b:s[i+2],a:s[i+3]}},r=[];for(let n=0;n<e.height;n++){r[n]=r[n]||[];for(let o=0;o<e.width;o++)r[n][o]=t(o,n)}return r}var po=e=>{const t=[],{width:r,height:n}=e,o=fo(e);for(let i=0;i<n;i++){t[i]=new Uint8Array(Math.round(r/8));for(let s=0;s<t[i].length;s++){t[i][s]=0;for(let a=0;a<8;a++){const{r:l,g:c,b:f,a:m}=o[i][s*8+a]||{r:255,g:255,b:255,a:255};((l+c+f)/3/255<.6||m<.6)&&(t[i][s]|=1<<7-a)}}}return t},vo=(e,t)=>{const{xL:r,xH:n,yL:o,yH:i,k:s}=St(e,t),a=[bt,118,48,0,r,n,o,i];if(a[0]===bt&&a[1]===118&&a[2]===48&&!(s<=ke))throw new Error(`Image too large; ${s} > ${ke}`);return a},ho=async e=>(await uo(e)).map(n=>{const o=po(n);return[De.Buffer.from(vo(o[0].length*8,n.height))].concat(o.map(i=>lo(i)))}).flat();const No=e=>{const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL("image/png",100)},mo=(e,t,r)=>{if(t){if(e.width<=t)return e;r=t*(e.height/e.width)}else{if(e.height<=r)return e;t=r*(e.width/e.height)}const n=new OffscreenCanvas(t,r);return n.getContext("2d").drawImage(e,0,0,t,r),n},_o=async e=>{const t=new window.Image;await new Promise((o,i)=>{t.onload=()=>o(t),t.onerror=()=>i(new Error("image not found")),t.src=e,t.crossOrigin="anonymous"});const r=new OffscreenCanvas(t.naturalWidth,t.naturalHeight);return r.getContext("2d").drawImage(t,0,0),r},Vo=(e,t,r=1,n=!0)=>{e=mo(e,ce);const o=e.getContext("2d"),i=o.getImageData(0,0,o.canvas.width,o.canvas.height);return n&&go(i.data,[t.foreground,t.background],r),o.putImageData(i,0,0),e},go=(e,t,r)=>{for(let n=0;n<e.length;n+=4)(e[n]+e[n+1]+e[n+2])/3/255<.6?(e[n]=t[0][0],e[n+1]=t[0][1],e[n+2]=t[0][2],e[n+3]=parseInt(e[n+3]*r)):(e[n]=t[1][0],e[n+1]=t[1][1],e[n+2]=t[1][2],e[n+3]=parseInt(e[n+3]*r))},U=e=>ho(e),yo=(e,t,r,n)=>{console.log("drawText",e,t,r,n),n=d({background:[255,255,255],foreground:[0,0,0]},n);const{fontSize:o,align:i,lineSpace:s,wordGap:a,margin:l,fontFamily:c,weight:f,italic:m}=d({fontSize:12,align:k.LEFT,wordGap:0,lineSpace:0,margin:0,fontFamily:"sans-serif",color:"#000",weight:400,italic:!1},t),u=[0,r*l,0,0];let h=0,g=r;switch(i){case k.RIGHT:h+=r,g-=u[1];break;case k.CENTER:h+=g/2;break;default:h+=u[1],g-=u[1];break}const p=`${m?"italic ":""}${f} ${o}px ${c}`,_=document.createElement("canvas");_.style.display="none",document.body.append(_);const v=_.getContext("2d");v.canvas.style.letterSpacing=`${a}px`,v.font=p;const w=Math.max(s,o)/o,b=e.split(`
`).map(C=>xt(v,C,0,0,o,g)).flat(),I=b.length*o*w+u[0]+u[2];if(!r)switch(r=parseInt(e.split(`
`).reduce((C,R)=>Math.max(v.measureText(R).width,C),0)),h=0,i){case k.RIGHT:h+=r;break;case k.CENTER:h+=r/2;break}return _.width=r,v.font=p,_.height=I,v.fillStyle=`rgb(${n.background.join(" ")})`,v.fillRect(0,0,_.width,_.height),v.fillStyle=`rgb(${n.foreground.join(" ")})`,v.textBaseline="top",v.font=p,v.canvas.style.letterSpacing=`${a}px`,v.textAlign={[k.LEFT]:"left",[k.CENTER]:"center",[k.RIGHT]:"right"}[Number(i)],v.translate(0,u[0]),b.forEach((C,R)=>{v.fillText(C,h,R*w*o-(o-w*o)/2)}),_.remove(),_};function xt(e,t,r,n,o,i,s=[]){if(i=i||0,i<=0)return[t];for(let a=1;a<=t.length;a++){const l=t.substr(0,a);if(e.measureText(l).width>i)return s.push(t.substr(0,a-1)),s=s.concat(xt(e,t.substr(a-1),r,n+o,o,i)),s}return s.push(t),s}var ve={cutLine:{display:()=>({title:"Cut Line"})},grid:{display:e=>({title:"Grid",value:`Columns: ${e.data.length}`}),beforePrinterCommand:async(e,t=!0)=>{const{widths:r,data:n,options:o,imageOptions:i}=e.value,s=(i==null?void 0:i.width)||ce,{columnGutter:a,rowGutter:l}=d({columnGutter:12,rowGutter:12},o);let c=r.filter(p=>p<1).reduce((p,_)=>p+(1-_),0);c/=r.filter(p=>p===1).length;const f=await Promise.all(n.map(async(p,_)=>{const v=n.length-1;return await Promise.all(p.filter(({visible:w})=>w).map(async w=>{let b=parseInt(s/n.length)*r[_];r[_]===1&&(b+=parseInt(s/n.length)*c),v>0&&(b=b-a*v/n.length);const{value:I}=w;console.log("columnWidth",b,I.imageOptions),(I.imageOptions=I.imageOptions||{}).width=b;try{return await ve[String(w.type)].beforePrinterCommand(d({},w),!1)}catch(C){return ve.text.beforePrinterCommand(new Te({visible:!0,value:he(d({},wt()),{text:C.message,imageOptions:I.imageOptions})}),!1)}}))})),m=f.reduce((p,_)=>{const v=_.length-1;return Math.max(_.filter(({visible:w})=>w).reduce((w,{value:b})=>w+b.height,v*l),p)},1);let u=new OffscreenCanvas(s,m);const h=u.getContext("2d");let g=0;return f.forEach((p,_)=>{let v=0;g+=p.filter(({visible:b})=>b).reduce((b,{value:I},C)=>(console.log(I,I.width,I.height),h.drawImage(I,g,v),v+=I.height+(C<p.length?l:0),Math.max(I.width,b)),0)+(_<f.length?a:0)}),u=Z(u,i),e.value=t?await U(u):u,e}},barcode:{display:e=>({title:"Barcode",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value;let i=await Un(r||"empty",n||{});return i=Z(i,o),e.value=t?await U(i):i,e}},qrCode:{display:e=>({title:"QR Code",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value,i=d({},n);i.width=n.width||o.width;let s=await qn(r||"empty",i);return s=Z(s,o),e.value=t?await U(s):s,e}},image:{display:()=>({title:"Image"}),beforePrinterCommand:async(e,t=!0)=>{const{file:r,imageOptions:n}=e.value;let o=await _o(r);return o=Z(o,n),e.value=t?await U(o):o,e}},spacer:{display:()=>({title:"Spacer"}),beforePrinterCommand:async(e,t=!0)=>{const{value:r,imageOptions:n}=e.value;let o=new OffscreenCanvas((n==null?void 0:n.width)||ce,r);return o=Z(o,n),e.value=t?await U(o):o,e}},text:{display:e=>({title:"Text",value:`${e.text.slice(0,16)}\u2026`}),beforePrinterCommand:async(e,t=!0)=>{const{text:r,options:n,imageOptions:o}=e.value;let i=await yo(r||"empty",n||{},(o==null?void 0:o.rotate)?null:(o==null?void 0:o.width)||ce);return i=Z(i,o),e.value=t?await U(i):i,e}},nativeText:{display:e=>({title:"Native Text",value:`${e.slice(0,16)}\u2026`})},feedPitch:{display:({type:e,value:t})=>({title:"Feed-Pitch",value:`${e} | ${t}`})},reset:{display:e=>({property:!0,title:"Reset"})},setAlign:{display:e=>({property:!0,title:"Align",value:`${Object.entries(k).find(t=>t[1]===e)[0]}`})},setFont:{display:e=>({property:!0,title:"Font",value:Object.entries(x).find(t=>Number(e)===t[1])[0]})},setLineSpace:{display:e=>({property:!0,title:"Line-Space",value:e})},setWordGap:{display:e=>({property:!0,title:"Word-Gap",value:e})},setMargin:{display:e=>({property:!0,title:"Margin",value:e})},setDensity:{display:e=>({property:!0,title:"Density",value:e})}};class wo extends At{constructor(){super();this.socket=null,this.connected=!1}async connect(t=3e3,r="localhost",n=!1){const o=n?"wss":"ws";this.io=await this.ready();const i=this.io(`${o}://${r}:${t}`,{autoConnect:!1,reconnection:!1,secure:n,transports:["websocket"]});this.socket=await new Promise((s,a)=>{i.on("error",l=>{this.emit("error",l)}),i.on("connect_error",l=>{this.emit("error",l),a(l)}),i.on("connect",()=>{this.connected=i.connected,this.emit("connect"),s(i)}),i.on("disconnect",()=>{this.disconnect(),this.emit("disconnect")}),i.connect()})}async ready(){if(this.io)return this.io;const{io:t}=await S(()=>import("./index.c05fa7e4.js"),[]);return this.io=t,t}get host(){var t,r,n;return(n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.hostname}get port(){var t,r,n,o,i,s;return((n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.port)&&Number((s=(i=(o=this.socket)==null?void 0:o.io)==null?void 0:i.opts)==null?void 0:s.port)||void 0}get secure(){var t,r,n;return(n=(r=(t=this.socket)==null?void 0:t.io)==null?void 0:r.opts)==null?void 0:n.secure}promiseEmit(t,r){return new Promise(n=>{this.socket.emit(t,r,n)})}disconnect(){var t;(t=this.socket)==null||t.destroy(),this.socket=null,this.connected=!1}async getInfo(){const t=await this.promiseEmit("getInfo");return console.log("getInfo",t),t}async executeActions(t){t=await Promise.all(t.filter(({visible:n})=>n).map(async n=>"beforePrinterCommand"in ve[n.type]?await ve[n.type].beforePrinterCommand(Object.assign({},n)):n));const r=await this.promiseEmit("executeActions",t);console.log("executeActions",r)}}const Pe=$.observable(new wo);xr(Pe);Pe.on("error",e=>{gt.add(e)});Object.defineProperty($.prototype,"$client",{get(){return Pe}});class bo{constructor(){this.prompts=[]}prompt(t,r){return new Promise(n=>{const o={title:r,message:t},i=s=>{this.prompts.slice(this.prompts.indexOf(o),1),n(s)};o.callback=i,this.prompts.push(o)})}}const So=$.observable(new bo);Object.defineProperty($.prototype,"$dialog",{get(){return So}});$.component("App",_t);new $({render:e=>e(_t)}).$mount("#app");export{Te as A,an as B,_o as C,jn as D,mo as E,ko as F,No as G,Z as H,Po as I,x as J,To as M,J as O,S as _,Fo as a,Do as b,jo as c,ve as d,Mo as e,Q as f,eo as g,de as h,Fn as i,Ro as j,Oo as k,pe as l,k as m,D as n,z as o,yo as p,Vo as q,ao as r,Sr as s,no as t,so as u,io as v,wt as w,$o as x,W as y,oo as z};
